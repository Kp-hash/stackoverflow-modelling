2022-01-20 08:19:25.135593 (MainThread): Running with dbt=0.21.1
2022-01-20 08:19:25.801443 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-20 08:19:25.810289 (MainThread): Tracking: tracking
2022-01-20 08:19:25.838590 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff12ee17e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11aad3c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11aad3bb0>]}
2022-01-20 08:19:25.852199 (MainThread): Partial parsing not enabled
2022-01-20 08:19:25.872913 (MainThread): Parsing macros/adapters.sql
2022-01-20 08:19:25.903419 (MainThread): Parsing macros/catalog.sql
2022-01-20 08:19:25.910409 (MainThread): Parsing macros/etc.sql
2022-01-20 08:19:25.913227 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-20 08:19:25.916955 (MainThread): Parsing macros/materializations/seed.sql
2022-01-20 08:19:25.921873 (MainThread): Parsing macros/materializations/copy.sql
2022-01-20 08:19:25.925100 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-20 08:19:25.945438 (MainThread): Parsing macros/materializations/view.sql
2022-01-20 08:19:25.948319 (MainThread): Parsing macros/materializations/table.sql
2022-01-20 08:19:25.958520 (MainThread): Parsing macros/core.sql
2022-01-20 08:19:25.963580 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-20 08:19:25.966902 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-20 08:19:25.969366 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-20 08:19:25.971051 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-20 08:19:25.972573 (MainThread): Parsing macros/etc/query.sql
2022-01-20 08:19:25.973698 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-20 08:19:25.975487 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-20 08:19:25.977480 (MainThread): Parsing macros/etc/datetime.sql
2022-01-20 08:19:25.986743 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-20 08:19:25.990395 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-20 08:19:25.992410 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-20 08:19:25.994493 (MainThread): Parsing macros/adapters/common.sql
2022-01-20 08:19:26.112275 (MainThread): Parsing macros/materializations/test.sql
2022-01-20 08:19:26.122793 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-20 08:19:26.136988 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-20 08:19:26.146295 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-20 08:19:26.148325 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-20 08:19:26.186692 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-20 08:19:26.207932 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-20 08:19:26.223783 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-20 08:19:26.225613 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-20 08:19:26.238337 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-20 08:19:26.260761 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-20 08:19:26.266792 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-20 08:19:26.275634 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-20 08:19:26.582099 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.my_first_dbt_model".
2022-01-20 08:19:26.611648 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.my_second_dbt_model".
2022-01-20 08:19:26.677359 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 08:19:26.681494 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 08:19:26.685759 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 08:19:26.689782 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 08:19:26.711910 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-01-20 08:19:26.721994 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f9caf70-917c-4f22-a523-5dfbbb6cc6b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11aa77310>]}
2022-01-20 08:19:26.735471 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-20 08:19:26.736290 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f9caf70-917c-4f22-a523-5dfbbb6cc6b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11ab29640>]}
2022-01-20 08:19:26.736981 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-01-20 08:19:26.741110 (MainThread): 
2022-01-20 08:19:26.741960 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 08:19:26.743485 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-20 08:19:26.744006 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-20 08:19:29.964857 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_future-enigma-338718_dbt_stackoverflow".
2022-01-20 08:19:29.966903 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_future-enigma-338718_dbt_stackoverflow".
2022-01-20 08:19:29.974286 (ThreadPoolExecutor-0_0): Creating schema "future-enigma-338718.dbt_stackoverflow".
2022-01-20 08:19:29.975547 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2022-01-20 08:19:30.007928 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-20 08:19:33.382036 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-20 08:19:33.384234 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-20 08:19:33.422211 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-20 08:19:39.405444 (MainThread): 08:19:39 | Concurrency: 1 threads (target='dev')
2022-01-20 08:19:39.407047 (MainThread): 08:19:39 | 
2022-01-20 08:19:39.433190 (Thread-1): Began running node model.stackoverflow_post.my_first_dbt_model
2022-01-20 08:19:39.435646 (Thread-1): 08:19:39 | 1 of 2 START table model dbt_stackoverflow.my_first_dbt_model........ [RUN]
2022-01-20 08:19:39.438152 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.my_first_dbt_model".
2022-01-20 08:19:39.439527 (Thread-1): Compiling model.stackoverflow_post.my_first_dbt_model
2022-01-20 08:19:39.457692 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.my_first_dbt_model"
2022-01-20 08:19:39.463081 (Thread-1): finished collecting timing info
2022-01-20 08:19:39.534371 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.my_first_dbt_model"
2022-01-20 08:19:39.534944 (Thread-1): Opening a new connection, currently in state closed
2022-01-20 08:19:39.539793 (Thread-1): On model.stackoverflow_post.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.my_first_dbt_model"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2022-01-20 08:19:47.852862 (Thread-1): finished collecting timing info
2022-01-20 08:19:47.858966 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f9caf70-917c-4f22-a523-5dfbbb6cc6b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11a0e1f10>]}
2022-01-20 08:19:47.863187 (Thread-1): 08:19:47 | 1 of 2 OK created table model dbt_stackoverflow.my_first_dbt_model... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 8.42s]
2022-01-20 08:19:47.868463 (Thread-1): Finished running node model.stackoverflow_post.my_first_dbt_model
2022-01-20 08:19:47.872704 (Thread-1): Began running node model.stackoverflow_post.my_second_dbt_model
2022-01-20 08:19:47.875571 (Thread-1): 08:19:47 | 2 of 2 START view model dbt_stackoverflow.my_second_dbt_model........ [RUN]
2022-01-20 08:19:47.879099 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.my_second_dbt_model".
2022-01-20 08:19:47.882982 (Thread-1): unclosed <ssl.SSLSocket fd=14, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:b440:7363:43bc:22ba', 38974, 0, 0), raddr=('2a00:1450:4009:821::200a', 443, 0, 0)>
2022-01-20 08:19:47.886337 (Thread-1): unclosed <ssl.SSLSocket fd=15, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:b440:7363:43bc:22ba', 38976, 0, 0), raddr=('2a00:1450:4009:821::200a', 443, 0, 0)>
2022-01-20 08:19:47.881266 (Thread-1): Compiling model.stackoverflow_post.my_second_dbt_model
2022-01-20 08:19:47.902321 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.my_second_dbt_model"
2022-01-20 08:19:47.903439 (Thread-1): finished collecting timing info
2022-01-20 08:19:47.907188 (Thread-1): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:b440:7363:43bc:22ba', 38962, 0, 0), raddr=('2a00:1450:4009:821::200a', 443, 0, 0)>
2022-01-20 08:19:47.908523 (Thread-1): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:b440:7363:43bc:22ba', 38964, 0, 0), raddr=('2a00:1450:4009:821::200a', 443, 0, 0)>
2022-01-20 08:19:47.909420 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:b440:7363:43bc:22ba', 38966, 0, 0), raddr=('2a00:1450:4009:821::200a', 443, 0, 0)>
2022-01-20 08:19:47.910105 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:b440:7363:43bc:22ba', 38968, 0, 0), raddr=('2a00:1450:4009:821::200a', 443, 0, 0)>
2022-01-20 08:19:47.910624 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:b440:7363:43bc:22ba', 38970, 0, 0), raddr=('2a00:1450:4009:821::200a', 443, 0, 0)>
2022-01-20 08:19:47.911121 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:b440:7363:43bc:22ba', 38972, 0, 0), raddr=('2a00:1450:4009:821::200a', 443, 0, 0)>
2022-01-20 08:19:47.953141 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.my_second_dbt_model"
2022-01-20 08:19:47.953641 (Thread-1): Opening a new connection, currently in state closed
2022-01-20 08:19:47.958919 (Thread-1): On model.stackoverflow_post.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.my_second_dbt_model"} */


  create or replace view `future-enigma-338718`.`dbt_stackoverflow`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `future-enigma-338718`.`dbt_stackoverflow`.`my_first_dbt_model`
where id = 1;


2022-01-20 08:19:52.447964 (Thread-1): finished collecting timing info
2022-01-20 08:19:52.450817 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f9caf70-917c-4f22-a523-5dfbbb6cc6b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11a0e7460>]}
2022-01-20 08:19:52.453611 (Thread-1): 08:19:52 | 2 of 2 OK created view model dbt_stackoverflow.my_second_dbt_model... [OK in 4.57s]
2022-01-20 08:19:52.455052 (Thread-1): Finished running node model.stackoverflow_post.my_second_dbt_model
2022-01-20 08:19:52.461627 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 08:19:52.464823 (MainThread): 08:19:52 | 
2022-01-20 08:19:52.467399 (MainThread): 08:19:52 | Finished running 1 table model, 1 view model in 25.72s.
2022-01-20 08:19:52.469691 (MainThread): Connection 'master' was properly closed.
2022-01-20 08:19:52.471895 (MainThread): Connection 'model.stackoverflow_post.my_second_dbt_model' was properly closed.
2022-01-20 08:19:52.481789 (MainThread): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:b440:7363:43bc:22ba', 38978, 0, 0), raddr=('2a00:1450:4009:821::200a', 443, 0, 0)>
2022-01-20 08:19:52.484539 (MainThread): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:b440:7363:43bc:22ba', 38982, 0, 0), raddr=('2a00:1450:4009:821::200a', 443, 0, 0)>
2022-01-20 08:19:52.517256 (MainThread): 
2022-01-20 08:19:52.517865 (MainThread): Completed successfully
2022-01-20 08:19:52.518597 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-01-20 08:19:52.519225 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11aad3c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11a0d7400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11a941640>]}
2022-01-20 08:19:52.519887 (MainThread): Flushing usage events
2022-01-20 08:25:30.659317 (MainThread): Running with dbt=0.21.1
2022-01-20 08:25:31.282173 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-20 08:25:31.283116 (MainThread): Tracking: tracking
2022-01-20 08:25:31.309423 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776f133fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77833f8d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776f156070>]}
2022-01-20 08:25:31.321610 (MainThread): Partial parsing not enabled
2022-01-20 08:25:31.329838 (MainThread): Parsing macros/adapters.sql
2022-01-20 08:25:31.356820 (MainThread): Parsing macros/catalog.sql
2022-01-20 08:25:31.363173 (MainThread): Parsing macros/etc.sql
2022-01-20 08:25:31.365208 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-20 08:25:31.366976 (MainThread): Parsing macros/materializations/seed.sql
2022-01-20 08:25:31.370008 (MainThread): Parsing macros/materializations/copy.sql
2022-01-20 08:25:31.373412 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-20 08:25:31.390197 (MainThread): Parsing macros/materializations/view.sql
2022-01-20 08:25:31.393344 (MainThread): Parsing macros/materializations/table.sql
2022-01-20 08:25:31.404845 (MainThread): Parsing macros/core.sql
2022-01-20 08:25:31.409296 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-20 08:25:31.412300 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-20 08:25:31.414147 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-20 08:25:31.415558 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-20 08:25:31.416949 (MainThread): Parsing macros/etc/query.sql
2022-01-20 08:25:31.418135 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-20 08:25:31.419863 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-20 08:25:31.421593 (MainThread): Parsing macros/etc/datetime.sql
2022-01-20 08:25:31.430881 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-20 08:25:31.433599 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-20 08:25:31.436346 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-20 08:25:31.438414 (MainThread): Parsing macros/adapters/common.sql
2022-01-20 08:25:31.553615 (MainThread): Parsing macros/materializations/test.sql
2022-01-20 08:25:31.563877 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-20 08:25:31.577584 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-20 08:25:31.586900 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-20 08:25:31.589006 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-20 08:25:31.624160 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-20 08:25:31.643212 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-20 08:25:31.658138 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-20 08:25:31.661285 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-20 08:25:31.672726 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-20 08:25:31.694257 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-20 08:25:31.698421 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-20 08:25:31.706262 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-20 08:25:31.976234 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-20 08:25:32.013923 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 08:25:32.015945 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 08:25:32.031272 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b88a84f-3934-4d48-ac5f-335bade78cf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776f1131c0>]}
2022-01-20 08:25:32.036089 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-20 08:25:32.036508 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b88a84f-3934-4d48-ac5f-335bade78cf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776f113ca0>]}
2022-01-20 08:25:32.036819 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-01-20 08:25:32.037967 (MainThread): 
2022-01-20 08:25:32.038463 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 08:25:32.039476 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-20 08:25:32.039928 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-20 08:25:34.950724 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-20 08:25:34.951332 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-20 08:25:34.962818 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-20 08:25:39.775413 (MainThread): 08:25:39 | Concurrency: 1 threads (target='dev')
2022-01-20 08:25:39.775962 (MainThread): 08:25:39 | 
2022-01-20 08:25:39.780623 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-20 08:25:39.781229 (Thread-1): 08:25:39 | 1 of 1 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-20 08:25:39.781892 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-20 08:25:39.782256 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-20 08:25:39.784889 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-20 08:25:39.785480 (Thread-1): finished collecting timing info
2022-01-20 08:25:39.860545 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-20 08:25:39.861611 (Thread-1): Opening a new connection, currently in state init
2022-01-20 08:25:39.870704 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         creation_date,
         last_activity_date,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-20 08:25:43.237348 (Thread-1): finished collecting timing info
2022-01-20 08:25:43.238694 (Thread-1): Database Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
  Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.
  compiled SQL at target/run/stackoverflow_post/models/stack_models/TrendingTopics.sql
Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1447, in result
    do_get_result()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    return retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1437, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/base.py", line 727, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.

(job ID: aa2db1fe-4b02-40f1-9328-84b69470b011)

                                                                  -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */
   2:
   3:
   4:  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    With temp as 
  10:(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
  11:        id,
  12:         title,
  13:         favorite_count,
  14:         accepted_answer_id,
  15:         answer_count,
  16:         creation_date,
  17:         last_activity_date,
  18:         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
  19:         view_count,
  20:         tags,
  21:         score
  22:FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`
  23:WHERE    answer_count = 0
  24:AND      accepted_answer_id IS NULL
  25:AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
  26:ORDER BY view_count DESC)
  27:
  28:SELECT * FROM temp WHERE  days_diff >= 60
  29:  );
  30:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 171, in exception_handler
    self.handle_error(e, message)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
  Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.
  compiled SQL at target/run/stackoverflow_post/models/stack_models/TrendingTopics.sql
2022-01-20 08:25:43.257690 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b88a84f-3934-4d48-ac5f-335bade78cf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776f0dbdf0>]}
2022-01-20 08:25:43.258932 (Thread-1): 08:25:43 | 1 of 1 ERROR creating table model dbt_stackoverflow.TrendingTopics... [ERROR in 3.48s]
2022-01-20 08:25:43.259518 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-20 08:25:43.261464 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 08:25:43.263128 (MainThread): 08:25:43 | 
2022-01-20 08:25:43.263780 (MainThread): 08:25:43 | Finished running 1 table model in 11.22s.
2022-01-20 08:25:43.264419 (MainThread): Connection 'master' was properly closed.
2022-01-20 08:25:43.265049 (MainThread): Connection 'list_future-enigma-338718_dbt_stackoverflow' was properly closed.
2022-01-20 08:25:43.265726 (MainThread): Connection 'model.stackoverflow_post.TrendingTopics' was properly closed.
2022-01-20 08:25:43.278225 (MainThread): 
2022-01-20 08:25:43.278650 (MainThread): Completed with 1 error and 0 warnings:
2022-01-20 08:25:43.279071 (MainThread): 
2022-01-20 08:25:43.279765 (MainThread): Database Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
2022-01-20 08:25:43.280340 (MainThread):   Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.
2022-01-20 08:25:43.280874 (MainThread):   compiled SQL at target/run/stackoverflow_post/models/stack_models/TrendingTopics.sql
2022-01-20 08:25:43.281165 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-01-20 08:25:43.281524 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776f0a12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77833edc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776f113670>]}
2022-01-20 08:25:43.281885 (MainThread): Flushing usage events
2022-01-20 08:35:45.902973 (MainThread): Running with dbt=0.21.1
2022-01-20 08:35:46.481472 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-20 08:35:46.482393 (MainThread): Tracking: tracking
2022-01-20 08:35:46.508627 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05bfd828e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05aba34c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05aba34eb0>]}
2022-01-20 08:35:46.520071 (MainThread): Partial parsing not enabled
2022-01-20 08:35:46.527798 (MainThread): Parsing macros/adapters.sql
2022-01-20 08:35:46.553529 (MainThread): Parsing macros/catalog.sql
2022-01-20 08:35:46.559510 (MainThread): Parsing macros/etc.sql
2022-01-20 08:35:46.561792 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-20 08:35:46.563597 (MainThread): Parsing macros/materializations/seed.sql
2022-01-20 08:35:46.566372 (MainThread): Parsing macros/materializations/copy.sql
2022-01-20 08:35:46.569215 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-20 08:35:46.583946 (MainThread): Parsing macros/materializations/view.sql
2022-01-20 08:35:46.587077 (MainThread): Parsing macros/materializations/table.sql
2022-01-20 08:35:46.597681 (MainThread): Parsing macros/core.sql
2022-01-20 08:35:46.602278 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-20 08:35:46.605105 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-20 08:35:46.606879 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-20 08:35:46.608372 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-20 08:35:46.609705 (MainThread): Parsing macros/etc/query.sql
2022-01-20 08:35:46.610721 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-20 08:35:46.612605 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-20 08:35:46.614348 (MainThread): Parsing macros/etc/datetime.sql
2022-01-20 08:35:46.623367 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-20 08:35:46.626192 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-20 08:35:46.628460 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-20 08:35:46.630143 (MainThread): Parsing macros/adapters/common.sql
2022-01-20 08:35:46.737059 (MainThread): Parsing macros/materializations/test.sql
2022-01-20 08:35:46.745343 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-20 08:35:46.758363 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-20 08:35:46.767312 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-20 08:35:46.769452 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-20 08:35:46.802333 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-20 08:35:46.820174 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-20 08:35:46.834294 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-20 08:35:46.836379 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-20 08:35:46.846754 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-20 08:35:46.866949 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-20 08:35:46.871256 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-20 08:35:46.878675 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-20 08:35:47.112987 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-20 08:35:47.148498 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 08:35:47.150565 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 08:35:47.166219 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e970b225-c031-4906-acae-45f52297ad47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05aba8e1f0>]}
2022-01-20 08:35:47.170941 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-20 08:35:47.171364 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e970b225-c031-4906-acae-45f52297ad47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05aba8ea90>]}
2022-01-20 08:35:47.171730 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-01-20 08:35:47.172722 (MainThread): 
2022-01-20 08:35:47.173115 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 08:35:47.173903 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-20 08:35:47.174218 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-20 08:35:50.943435 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-20 08:35:50.944709 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-20 08:35:50.955538 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-20 08:35:58.991528 (MainThread): 08:35:58 | Concurrency: 1 threads (target='dev')
2022-01-20 08:35:58.992693 (MainThread): 08:35:58 | 
2022-01-20 08:35:58.999562 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-20 08:35:59.001212 (Thread-1): 08:35:58 | 1 of 1 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-20 08:35:59.002786 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-20 08:35:59.003777 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-20 08:35:59.012060 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-20 08:35:59.014200 (Thread-1): finished collecting timing info
2022-01-20 08:35:59.069695 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-20 08:35:59.070135 (Thread-1): Opening a new connection, currently in state closed
2022-01-20 08:35:59.074475 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         creation_date,
         last_activity_date,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-20 08:36:05.892237 (Thread-1): finished collecting timing info
2022-01-20 08:36:05.893887 (Thread-1): Database Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
  Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.
  compiled SQL at target/run/stackoverflow_post/models/stack_models/TrendingTopics.sql
Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1447, in result
    do_get_result()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    return retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1437, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/base.py", line 727, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.

(job ID: 96c80243-baf7-48c4-afaf-d36c87d79687)

                                                                  -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */
   2:
   3:
   4:  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    With temp as 
  10:(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
  11:        id,
  12:         title,
  13:         favorite_count,
  14:         accepted_answer_id,
  15:         answer_count,
  16:         creation_date,
  17:         last_activity_date,
  18:         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
  19:         view_count,
  20:         tags,
  21:         score
  22:FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`
  23:WHERE    answer_count = 0
  24:AND      accepted_answer_id IS NULL
  25:AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
  26:ORDER BY view_count DESC)
  27:
  28:SELECT * FROM temp WHERE  days_diff >= 60
  29:  );
  30:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 171, in exception_handler
    self.handle_error(e, message)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
  Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.
  compiled SQL at target/run/stackoverflow_post/models/stack_models/TrendingTopics.sql
2022-01-20 08:36:05.904046 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e970b225-c031-4906-acae-45f52297ad47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05aba0b850>]}
2022-01-20 08:36:05.905456 (Thread-1): 08:36:05 | 1 of 1 ERROR creating table model dbt_stackoverflow.TrendingTopics... [ERROR in 6.90s]
2022-01-20 08:36:05.906306 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-20 08:36:05.910364 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 08:36:05.911747 (MainThread): 08:36:05 | 
2022-01-20 08:36:05.912869 (MainThread): 08:36:05 | Finished running 1 table model in 18.74s.
2022-01-20 08:36:05.913682 (MainThread): Connection 'master' was properly closed.
2022-01-20 08:36:05.914286 (MainThread): Connection 'model.stackoverflow_post.TrendingTopics' was properly closed.
2022-01-20 08:36:05.929495 (MainThread): 
2022-01-20 08:36:05.929940 (MainThread): Completed with 1 error and 0 warnings:
2022-01-20 08:36:05.930332 (MainThread): 
2022-01-20 08:36:05.930698 (MainThread): Database Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
2022-01-20 08:36:05.931043 (MainThread):   Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.
2022-01-20 08:36:05.931374 (MainThread):   compiled SQL at target/run/stackoverflow_post/models/stack_models/TrendingTopics.sql
2022-01-20 08:36:05.931747 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-01-20 08:36:05.932197 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05c3182d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05aba964f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05aba96e20>]}
2022-01-20 08:36:05.932772 (MainThread): Flushing usage events
2022-01-20 08:36:50.213388 (MainThread): Running with dbt=0.21.1
2022-01-20 08:36:50.819801 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-20 08:36:50.820806 (MainThread): Tracking: tracking
2022-01-20 08:36:50.846333 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4537184910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4522e38d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4522e38d00>]}
2022-01-20 08:36:50.858031 (MainThread): Partial parsing not enabled
2022-01-20 08:36:50.866626 (MainThread): Parsing macros/adapters.sql
2022-01-20 08:36:50.893965 (MainThread): Parsing macros/catalog.sql
2022-01-20 08:36:50.900255 (MainThread): Parsing macros/etc.sql
2022-01-20 08:36:50.902657 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-20 08:36:50.904621 (MainThread): Parsing macros/materializations/seed.sql
2022-01-20 08:36:50.907384 (MainThread): Parsing macros/materializations/copy.sql
2022-01-20 08:36:50.910662 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-20 08:36:50.927556 (MainThread): Parsing macros/materializations/view.sql
2022-01-20 08:36:50.930581 (MainThread): Parsing macros/materializations/table.sql
2022-01-20 08:36:50.941190 (MainThread): Parsing macros/core.sql
2022-01-20 08:36:50.945459 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-20 08:36:50.948292 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-20 08:36:50.950317 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-20 08:36:50.952125 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-20 08:36:50.953482 (MainThread): Parsing macros/etc/query.sql
2022-01-20 08:36:50.954525 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-20 08:36:50.956170 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-20 08:36:50.957969 (MainThread): Parsing macros/etc/datetime.sql
2022-01-20 08:36:50.968203 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-20 08:36:50.970941 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-20 08:36:50.973157 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-20 08:36:50.974936 (MainThread): Parsing macros/adapters/common.sql
2022-01-20 08:36:51.087651 (MainThread): Parsing macros/materializations/test.sql
2022-01-20 08:36:51.096146 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-20 08:36:51.108061 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-20 08:36:51.117273 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-20 08:36:51.119403 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-20 08:36:51.154360 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-20 08:36:51.173949 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-20 08:36:51.189400 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-20 08:36:51.191477 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-20 08:36:51.203143 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-20 08:36:51.223524 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-20 08:36:51.227660 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-20 08:36:51.234971 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-20 08:36:51.485358 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-20 08:36:51.525979 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 08:36:51.528514 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 08:36:51.544738 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ce36129-2487-4d2c-9600-6245fc0bfa91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4522f0dee0>]}
2022-01-20 08:36:51.549425 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-20 08:36:51.549875 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ce36129-2487-4d2c-9600-6245fc0bfa91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4522e76d60>]}
2022-01-20 08:36:51.550176 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-01-20 08:36:51.551518 (MainThread): 
2022-01-20 08:36:51.552025 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 08:36:51.553060 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-20 08:36:51.553463 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-20 08:37:01.586096 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-20 08:37:01.586878 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-20 08:37:01.595417 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-20 08:37:03.872158 (MainThread): 08:37:03 | Concurrency: 1 threads (target='dev')
2022-01-20 08:37:03.873686 (MainThread): 08:37:03 | 
2022-01-20 08:37:03.880883 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-20 08:37:03.882490 (Thread-1): 08:37:03 | 1 of 1 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-20 08:37:03.884756 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-20 08:37:03.886383 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-20 08:37:03.894397 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-20 08:37:03.896021 (Thread-1): finished collecting timing info
2022-01-20 08:37:03.990795 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-20 08:37:03.991257 (Thread-1): Opening a new connection, currently in state closed
2022-01-20 08:37:03.995644 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         creation_date,
         last_activity_date,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-20 08:37:06.829242 (Thread-1): finished collecting timing info
2022-01-20 08:37:06.831620 (Thread-1): Database Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
  Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.
  compiled SQL at target/run/stackoverflow_post/models/stack_models/TrendingTopics.sql
Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1447, in result
    do_get_result()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    return retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1437, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/base.py", line 727, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.

(job ID: 10e7c208-1976-40c9-945b-0a1d8adc9502)

                                                                  -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */
   2:
   3:
   4:  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    With temp as 
  10:(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
  11:        id,
  12:         title,
  13:         favorite_count,
  14:         accepted_answer_id,
  15:         answer_count,
  16:         creation_date,
  17:         last_activity_date,
  18:         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
  19:         view_count,
  20:         tags,
  21:         score
  22:FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`
  23:WHERE    answer_count = 0
  24:AND      accepted_answer_id IS NULL
  25:AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
  26:ORDER BY view_count DESC)
  27:
  28:SELECT * FROM temp WHERE  days_diff >= 60
  29:  );
  30:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 171, in exception_handler
    self.handle_error(e, message)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
  Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.
  compiled SQL at target/run/stackoverflow_post/models/stack_models/TrendingTopics.sql
2022-01-20 08:37:06.847407 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ce36129-2487-4d2c-9600-6245fc0bfa91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4522de1040>]}
2022-01-20 08:37:06.849773 (Thread-1): 08:37:06 | 1 of 1 ERROR creating table model dbt_stackoverflow.TrendingTopics... [ERROR in 2.96s]
2022-01-20 08:37:06.851806 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-20 08:37:06.858299 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 08:37:06.861446 (MainThread): 08:37:06 | 
2022-01-20 08:37:06.863453 (MainThread): 08:37:06 | Finished running 1 table model in 15.31s.
2022-01-20 08:37:06.865546 (MainThread): Connection 'master' was properly closed.
2022-01-20 08:37:06.867366 (MainThread): Connection 'model.stackoverflow_post.TrendingTopics' was properly closed.
2022-01-20 08:37:06.910162 (MainThread): 
2022-01-20 08:37:06.911617 (MainThread): Completed with 1 error and 0 warnings:
2022-01-20 08:37:06.912968 (MainThread): 
2022-01-20 08:37:06.914271 (MainThread): Database Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
2022-01-20 08:37:06.915467 (MainThread):   Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.
2022-01-20 08:37:06.917524 (MainThread):   compiled SQL at target/run/stackoverflow_post/models/stack_models/TrendingTopics.sql
2022-01-20 08:37:06.918819 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-01-20 08:37:06.921067 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4522f0deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4522e6d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4522e38340>]}
2022-01-20 08:37:06.922975 (MainThread): Flushing usage events
2022-01-20 08:37:53.309642 (MainThread): Running with dbt=0.21.1
2022-01-20 08:37:53.911695 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-20 08:37:53.912770 (MainThread): Tracking: tracking
2022-01-20 08:37:53.939337 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff53093f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff673da9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff530b80a0>]}
2022-01-20 08:37:53.950899 (MainThread): Partial parsing not enabled
2022-01-20 08:37:53.960015 (MainThread): Parsing macros/adapters.sql
2022-01-20 08:37:53.985820 (MainThread): Parsing macros/catalog.sql
2022-01-20 08:37:53.991969 (MainThread): Parsing macros/etc.sql
2022-01-20 08:37:53.994069 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-20 08:37:53.996030 (MainThread): Parsing macros/materializations/seed.sql
2022-01-20 08:37:53.998600 (MainThread): Parsing macros/materializations/copy.sql
2022-01-20 08:37:54.001445 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-20 08:37:54.017024 (MainThread): Parsing macros/materializations/view.sql
2022-01-20 08:37:54.020165 (MainThread): Parsing macros/materializations/table.sql
2022-01-20 08:37:54.029842 (MainThread): Parsing macros/core.sql
2022-01-20 08:37:54.033889 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-20 08:37:54.036508 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-20 08:37:54.038235 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-20 08:37:54.039699 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-20 08:37:54.041213 (MainThread): Parsing macros/etc/query.sql
2022-01-20 08:37:54.042293 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-20 08:37:54.043915 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-20 08:37:54.045490 (MainThread): Parsing macros/etc/datetime.sql
2022-01-20 08:37:54.054308 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-20 08:37:54.056926 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-20 08:37:54.059053 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-20 08:37:54.060634 (MainThread): Parsing macros/adapters/common.sql
2022-01-20 08:37:54.167048 (MainThread): Parsing macros/materializations/test.sql
2022-01-20 08:37:54.175600 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-20 08:37:54.187456 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-20 08:37:54.196403 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-20 08:37:54.198262 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-20 08:37:54.231021 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-20 08:37:54.249455 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-20 08:37:54.263662 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-20 08:37:54.265459 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-20 08:37:54.276313 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-20 08:37:54.296980 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-20 08:37:54.301723 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-20 08:37:54.309488 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-20 08:37:54.545782 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-20 08:37:54.583217 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 08:37:54.585372 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 08:37:54.600282 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c9f2fdf-c45d-4878-a048-4df12e25d99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5317fc70>]}
2022-01-20 08:37:54.605040 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-20 08:37:54.605492 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c9f2fdf-c45d-4878-a048-4df12e25d99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5302fe80>]}
2022-01-20 08:37:54.605822 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-01-20 08:37:54.606918 (MainThread): 
2022-01-20 08:37:54.607506 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 08:37:54.608353 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-20 08:37:54.608674 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-20 08:37:59.844401 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-20 08:37:59.846093 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-20 08:37:59.876478 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-20 08:38:03.788652 (MainThread): 08:38:03 | Concurrency: 1 threads (target='dev')
2022-01-20 08:38:03.790189 (MainThread): 08:38:03 | 
2022-01-20 08:38:03.798700 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-20 08:38:03.800881 (Thread-1): 08:38:03 | 1 of 1 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-20 08:38:03.802747 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-20 08:38:03.804345 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-20 08:38:03.812464 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-20 08:38:03.814406 (Thread-1): finished collecting timing info
2022-01-20 08:38:03.874327 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-20 08:38:03.874765 (Thread-1): Opening a new connection, currently in state closed
2022-01-20 08:38:03.879216 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         creation_date,
         last_activity_date,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-20 08:38:07.645186 (Thread-1): finished collecting timing info
2022-01-20 08:38:07.647501 (Thread-1): Database Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
  Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.
  compiled SQL at target/run/stackoverflow_post/models/stack_models/TrendingTopics.sql
Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1447, in result
    do_get_result()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    return retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1437, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/base.py", line 727, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.

(job ID: e9092b9e-742f-4817-b1a6-3b33dde5eea4)

                                                                  -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */
   2:
   3:
   4:  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    With temp as 
  10:(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
  11:        id,
  12:         title,
  13:         favorite_count,
  14:         accepted_answer_id,
  15:         answer_count,
  16:         creation_date,
  17:         last_activity_date,
  18:         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
  19:         view_count,
  20:         tags,
  21:         score
  22:FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`
  23:WHERE    answer_count = 0
  24:AND      accepted_answer_id IS NULL
  25:AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
  26:ORDER BY view_count DESC)
  27:
  28:SELECT * FROM temp WHERE  days_diff >= 60
  29:  );
  30:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 171, in exception_handler
    self.handle_error(e, message)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
  Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.
  compiled SQL at target/run/stackoverflow_post/models/stack_models/TrendingTopics.sql
2022-01-20 08:38:07.661465 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c9f2fdf-c45d-4878-a048-4df12e25d99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff530010d0>]}
2022-01-20 08:38:07.663924 (Thread-1): 08:38:07 | 1 of 1 ERROR creating table model dbt_stackoverflow.TrendingTopics... [ERROR in 3.86s]
2022-01-20 08:38:07.665396 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-20 08:38:07.669841 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 08:38:07.671269 (MainThread): 08:38:07 | 
2022-01-20 08:38:07.672417 (MainThread): 08:38:07 | Finished running 1 table model in 13.06s.
2022-01-20 08:38:07.673276 (MainThread): Connection 'master' was properly closed.
2022-01-20 08:38:07.674016 (MainThread): Connection 'model.stackoverflow_post.TrendingTopics' was properly closed.
2022-01-20 08:38:07.694719 (MainThread): 
2022-01-20 08:38:07.695939 (MainThread): Completed with 1 error and 0 warnings:
2022-01-20 08:38:07.696982 (MainThread): 
2022-01-20 08:38:07.698332 (MainThread): Database Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
2022-01-20 08:38:07.699980 (MainThread):   Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.
2022-01-20 08:38:07.701539 (MainThread):   compiled SQL at target/run/stackoverflow_post/models/stack_models/TrendingTopics.sql
2022-01-20 08:38:07.703371 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-01-20 08:38:07.705878 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff530ff430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff530f03a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5302feb0>]}
2022-01-20 08:38:07.707522 (MainThread): Flushing usage events
2022-01-20 09:00:05.601222 (MainThread): Running with dbt=0.21.1
2022-01-20 09:00:06.176198 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-20 09:00:06.177230 (MainThread): Tracking: tracking
2022-01-20 09:00:06.203154 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd79a9288e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7865e3eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7865e3fd0>]}
2022-01-20 09:00:06.214241 (MainThread): Partial parsing not enabled
2022-01-20 09:00:06.222423 (MainThread): Parsing macros/adapters.sql
2022-01-20 09:00:06.246742 (MainThread): Parsing macros/catalog.sql
2022-01-20 09:00:06.253066 (MainThread): Parsing macros/etc.sql
2022-01-20 09:00:06.255099 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-20 09:00:06.256902 (MainThread): Parsing macros/materializations/seed.sql
2022-01-20 09:00:06.259528 (MainThread): Parsing macros/materializations/copy.sql
2022-01-20 09:00:06.262572 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-20 09:00:06.277968 (MainThread): Parsing macros/materializations/view.sql
2022-01-20 09:00:06.280736 (MainThread): Parsing macros/materializations/table.sql
2022-01-20 09:00:06.290666 (MainThread): Parsing macros/core.sql
2022-01-20 09:00:06.294737 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-20 09:00:06.297169 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-20 09:00:06.298851 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-20 09:00:06.300309 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-20 09:00:06.301604 (MainThread): Parsing macros/etc/query.sql
2022-01-20 09:00:06.302736 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-20 09:00:06.304558 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-20 09:00:06.306150 (MainThread): Parsing macros/etc/datetime.sql
2022-01-20 09:00:06.315734 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-20 09:00:06.318898 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-20 09:00:06.320967 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-20 09:00:06.322515 (MainThread): Parsing macros/adapters/common.sql
2022-01-20 09:00:06.428119 (MainThread): Parsing macros/materializations/test.sql
2022-01-20 09:00:06.436289 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-20 09:00:06.447963 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-20 09:00:06.456797 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-20 09:00:06.458722 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-20 09:00:06.492052 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-20 09:00:06.509837 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-20 09:00:06.524309 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-20 09:00:06.526151 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-20 09:00:06.536849 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-20 09:00:06.556900 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-20 09:00:06.561292 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-20 09:00:06.569460 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-20 09:00:06.801641 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-20 09:00:06.837329 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 09:00:06.839264 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 09:00:06.854396 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3921448d-baf8-4f27-86e2-f67b8793f0b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd786629dc0>]}
2022-01-20 09:00:06.858954 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-20 09:00:06.859365 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3921448d-baf8-4f27-86e2-f67b8793f0b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7866296a0>]}
2022-01-20 09:00:06.859686 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-01-20 09:00:06.860886 (MainThread): 
2022-01-20 09:00:06.861320 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 09:00:06.862156 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-20 09:00:06.862517 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-20 09:00:12.187004 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-20 09:00:12.188080 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-20 09:00:12.205151 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-20 09:00:14.658248 (MainThread): 09:00:14 | Concurrency: 1 threads (target='dev')
2022-01-20 09:00:14.659211 (MainThread): 09:00:14 | 
2022-01-20 09:00:14.665512 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-20 09:00:14.666763 (Thread-1): 09:00:14 | 1 of 1 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-20 09:00:14.668328 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-20 09:00:14.669108 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-20 09:00:14.675830 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-20 09:00:14.677332 (Thread-1): finished collecting timing info
2022-01-20 09:00:14.736124 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-20 09:00:14.736582 (Thread-1): Opening a new connection, currently in state closed
2022-01-20 09:00:14.741031 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         creation_date,
         last_activity_date,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-20 09:00:19.678591 (Thread-1): finished collecting timing info
2022-01-20 09:00:19.680105 (Thread-1): Database Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
  Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.
  compiled SQL at target/run/stackoverflow_post/models/stack_models/TrendingTopics.sql
Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1447, in result
    do_get_result()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    return retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1437, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/base.py", line 727, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.

(job ID: 37dc45dd-6fc7-416d-9f0c-e2708b1a57e4)

                                                                  -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */
   2:
   3:
   4:  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    With temp as 
  10:(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
  11:        id,
  12:         title,
  13:         favorite_count,
  14:         accepted_answer_id,
  15:         answer_count,
  16:         creation_date,
  17:         last_activity_date,
  18:         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
  19:         view_count,
  20:         tags,
  21:         score
  22:FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`
  23:WHERE    answer_count = 0
  24:AND      accepted_answer_id IS NULL
  25:AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
  26:ORDER BY view_count DESC)
  27:
  28:SELECT * FROM temp WHERE  days_diff >= 60
  29:  );
  30:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 171, in exception_handler
    self.handle_error(e, message)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
  Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.
  compiled SQL at target/run/stackoverflow_post/models/stack_models/TrendingTopics.sql
2022-01-20 09:00:19.688525 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3921448d-baf8-4f27-86e2-f67b8793f0b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd786585940>]}
2022-01-20 09:00:19.689938 (Thread-1): 09:00:19 | 1 of 1 ERROR creating table model dbt_stackoverflow.TrendingTopics... [ERROR in 5.02s]
2022-01-20 09:00:19.690920 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-20 09:00:19.694669 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 09:00:19.696122 (MainThread): 09:00:19 | 
2022-01-20 09:00:19.696988 (MainThread): 09:00:19 | Finished running 1 table model in 12.83s.
2022-01-20 09:00:19.697776 (MainThread): Connection 'master' was properly closed.
2022-01-20 09:00:19.698396 (MainThread): Connection 'model.stackoverflow_post.TrendingTopics' was properly closed.
2022-01-20 09:00:19.716684 (MainThread): 
2022-01-20 09:00:19.717887 (MainThread): Completed with 1 error and 0 warnings:
2022-01-20 09:00:19.718857 (MainThread): 
2022-01-20 09:00:19.719649 (MainThread): Database Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
2022-01-20 09:00:19.720465 (MainThread):   Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.
2022-01-20 09:00:19.721166 (MainThread):   compiled SQL at target/run/stackoverflow_post/models/stack_models/TrendingTopics.sql
2022-01-20 09:00:19.721703 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-01-20 09:00:19.722397 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7866cd460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd786629e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd786629c70>]}
2022-01-20 09:00:19.723146 (MainThread): Flushing usage events
2022-01-20 09:02:55.412861 (MainThread): Running with dbt=0.21.1
2022-01-20 09:02:56.070892 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-20 09:02:56.071892 (MainThread): Tracking: tracking
2022-01-20 09:02:56.099674 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6249050910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6234d0bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6234d0bd00>]}
2022-01-20 09:02:56.111432 (MainThread): Partial parsing not enabled
2022-01-20 09:02:56.120055 (MainThread): Parsing macros/adapters.sql
2022-01-20 09:02:56.146381 (MainThread): Parsing macros/catalog.sql
2022-01-20 09:02:56.153593 (MainThread): Parsing macros/etc.sql
2022-01-20 09:02:56.155910 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-20 09:02:56.158216 (MainThread): Parsing macros/materializations/seed.sql
2022-01-20 09:02:56.161371 (MainThread): Parsing macros/materializations/copy.sql
2022-01-20 09:02:56.164351 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-20 09:02:56.179942 (MainThread): Parsing macros/materializations/view.sql
2022-01-20 09:02:56.184166 (MainThread): Parsing macros/materializations/table.sql
2022-01-20 09:02:56.194880 (MainThread): Parsing macros/core.sql
2022-01-20 09:02:56.198695 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-20 09:02:56.201322 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-20 09:02:56.203170 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-20 09:02:56.204618 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-20 09:02:56.205869 (MainThread): Parsing macros/etc/query.sql
2022-01-20 09:02:56.206883 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-20 09:02:56.208470 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-20 09:02:56.211102 (MainThread): Parsing macros/etc/datetime.sql
2022-01-20 09:02:56.222436 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-20 09:02:56.225320 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-20 09:02:56.227365 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-20 09:02:56.229053 (MainThread): Parsing macros/adapters/common.sql
2022-01-20 09:02:56.351880 (MainThread): Parsing macros/materializations/test.sql
2022-01-20 09:02:56.360260 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-20 09:02:56.373440 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-20 09:02:56.383805 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-20 09:02:56.386466 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-20 09:02:56.441900 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-20 09:02:56.463477 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-20 09:02:56.478509 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-20 09:02:56.480441 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-20 09:02:56.493033 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-20 09:02:56.514550 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-20 09:02:56.519585 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-20 09:02:56.528368 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-20 09:02:56.783627 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-20 09:02:56.822304 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 09:02:56.825027 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 09:02:56.840806 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5818819e-7ff8-4d85-8d25-0d3e1d5b89b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6234df5bb0>]}
2022-01-20 09:02:56.845673 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-20 09:02:56.846048 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5818819e-7ff8-4d85-8d25-0d3e1d5b89b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6234df5eb0>]}
2022-01-20 09:02:56.846379 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-01-20 09:02:56.847404 (MainThread): 
2022-01-20 09:02:56.847824 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 09:02:56.848702 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-20 09:02:56.848932 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-20 09:03:02.031851 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-20 09:03:02.033180 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-20 09:03:02.055049 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-20 09:03:08.677409 (MainThread): 09:03:08 | Concurrency: 1 threads (target='dev')
2022-01-20 09:03:08.678593 (MainThread): 09:03:08 | 
2022-01-20 09:03:08.686446 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-20 09:03:08.687959 (Thread-1): 09:03:08 | 1 of 1 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-20 09:03:08.689723 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-20 09:03:08.691000 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-20 09:03:08.697634 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-20 09:03:08.699227 (Thread-1): finished collecting timing info
2022-01-20 09:03:08.753712 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-20 09:03:08.754211 (Thread-1): Opening a new connection, currently in state closed
2022-01-20 09:03:08.758844 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         creation_date,
         last_activity_date,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-20 09:03:20.825004 (Thread-1): finished collecting timing info
2022-01-20 09:03:20.826462 (Thread-1): Database Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
  Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.
  compiled SQL at target/run/stackoverflow_post/models/stack_models/TrendingTopics.sql
Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1447, in result
    do_get_result()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    return retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1437, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/base.py", line 727, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.

(job ID: f92c4122-459c-4699-a4f0-11e797693ebd)

                                                                  -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */
   2:
   3:
   4:  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    With temp as 
  10:(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
  11:        id,
  12:         title,
  13:         favorite_count,
  14:         accepted_answer_id,
  15:         answer_count,
  16:         creation_date,
  17:         last_activity_date,
  18:         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
  19:         view_count,
  20:         tags,
  21:         score
  22:FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`
  23:WHERE    answer_count = 0
  24:AND      accepted_answer_id IS NULL
  25:AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
  26:ORDER BY view_count DESC)
  27:
  28:SELECT * FROM temp WHERE  days_diff >= 60
  29:  );
  30:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 171, in exception_handler
    self.handle_error(e, message)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
  Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.
  compiled SQL at target/run/stackoverflow_post/models/stack_models/TrendingTopics.sql
2022-01-20 09:03:20.834883 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5818819e-7ff8-4d85-8d25-0d3e1d5b89b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6234cae760>]}
2022-01-20 09:03:20.836321 (Thread-1): 09:03:20 | 1 of 1 ERROR creating table model dbt_stackoverflow.TrendingTopics... [ERROR in 12.15s]
2022-01-20 09:03:20.837180 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-20 09:03:20.840664 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 09:03:20.842002 (MainThread): 09:03:20 | 
2022-01-20 09:03:20.842863 (MainThread): 09:03:20 | Finished running 1 table model in 23.99s.
2022-01-20 09:03:20.843655 (MainThread): Connection 'master' was properly closed.
2022-01-20 09:03:20.844324 (MainThread): Connection 'model.stackoverflow_post.TrendingTopics' was properly closed.
2022-01-20 09:03:20.855663 (MainThread): 
2022-01-20 09:03:20.856812 (MainThread): Completed with 1 error and 0 warnings:
2022-01-20 09:03:20.857122 (MainThread): 
2022-01-20 09:03:20.857431 (MainThread): Database Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
2022-01-20 09:03:20.857721 (MainThread):   Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.
2022-01-20 09:03:20.858008 (MainThread):   compiled SQL at target/run/stackoverflow_post/models/stack_models/TrendingTopics.sql
2022-01-20 09:03:20.858291 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-01-20 09:03:20.858692 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6249050910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6234dd9ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6234d39490>]}
2022-01-20 09:03:20.859122 (MainThread): Flushing usage events
2022-01-20 09:04:17.809278 (MainThread): Running with dbt=0.21.1
2022-01-20 09:04:18.795184 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-20 09:04:18.796432 (MainThread): Tracking: tracking
2022-01-20 09:04:18.850723 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56cd66deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56e19b3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56cd691040>]}
2022-01-20 09:04:18.885317 (MainThread): Partial parsing not enabled
2022-01-20 09:04:18.913121 (MainThread): Parsing macros/adapters.sql
2022-01-20 09:04:19.014431 (MainThread): Parsing macros/catalog.sql
2022-01-20 09:04:19.039244 (MainThread): Parsing macros/etc.sql
2022-01-20 09:04:19.044599 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-20 09:04:19.049308 (MainThread): Parsing macros/materializations/seed.sql
2022-01-20 09:04:19.062495 (MainThread): Parsing macros/materializations/copy.sql
2022-01-20 09:04:19.069673 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-20 09:04:19.112486 (MainThread): Parsing macros/materializations/view.sql
2022-01-20 09:04:19.119989 (MainThread): Parsing macros/materializations/table.sql
2022-01-20 09:04:19.146647 (MainThread): Parsing macros/core.sql
2022-01-20 09:04:19.157147 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-20 09:04:19.163202 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-20 09:04:19.167869 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-20 09:04:19.171693 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-20 09:04:19.174640 (MainThread): Parsing macros/etc/query.sql
2022-01-20 09:04:19.177296 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-20 09:04:19.181513 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-20 09:04:19.185356 (MainThread): Parsing macros/etc/datetime.sql
2022-01-20 09:04:19.208265 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-20 09:04:19.215902 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-20 09:04:19.221271 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-20 09:04:19.225048 (MainThread): Parsing macros/adapters/common.sql
2022-01-20 09:04:19.466460 (MainThread): Parsing macros/materializations/test.sql
2022-01-20 09:04:19.487996 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-20 09:04:19.520793 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-20 09:04:19.545055 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-20 09:04:19.550694 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-20 09:04:19.619212 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-20 09:04:19.651111 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-20 09:04:19.681585 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-20 09:04:19.685285 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-20 09:04:19.697229 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-20 09:04:19.739118 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-20 09:04:19.749164 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-20 09:04:19.767474 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-20 09:04:20.282513 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-20 09:04:20.349606 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 09:04:20.353820 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 09:04:20.381187 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a0d14e4-3d98-4100-b22b-3ce3a35d9867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56cd758a60>]}
2022-01-20 09:04:20.388199 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-20 09:04:20.388958 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a0d14e4-3d98-4100-b22b-3ce3a35d9867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56cd758730>]}
2022-01-20 09:04:20.389606 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-01-20 09:04:20.391067 (MainThread): 
2022-01-20 09:04:20.391580 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 09:04:20.392869 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-20 09:04:20.393328 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-20 09:04:25.395795 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-20 09:04:25.396290 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-20 09:04:25.400716 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-20 09:04:31.915384 (MainThread): 09:04:31 | Concurrency: 1 threads (target='dev')
2022-01-20 09:04:31.915684 (MainThread): 09:04:31 | 
2022-01-20 09:04:31.917343 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-20 09:04:31.917759 (Thread-1): 09:04:31 | 1 of 1 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-20 09:04:31.918145 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-20 09:04:31.918339 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-20 09:04:31.920325 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-20 09:04:31.920920 (Thread-1): finished collecting timing info
2022-01-20 09:04:31.968169 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-20 09:04:31.968675 (Thread-1): Opening a new connection, currently in state closed
2022-01-20 09:04:31.973021 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         creation_date,
         last_activity_date,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-20 09:04:41.188029 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         creation_date,
         last_activity_date,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-20 09:04:41.188259 (Thread-1): 404 Not found: Dataset future-enigma-338718:dbt_stackoverflow was not found in location US

(job ID: 1fb70fb5-8f15-4573-bd45-ca176c8c65e6)

                                                                  -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */
   2:
   3:
   4:  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    With temp as 
  10:(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
  11:        id,
  12:         title,
  13:         favorite_count,
  14:         accepted_answer_id,
  15:         answer_count,
  16:         creation_date,
  17:         last_activity_date,
  18:         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
  19:         view_count,
  20:         tags,
  21:         score
  22:FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`
  23:WHERE    answer_count = 0
  24:AND      accepted_answer_id IS NULL
  25:AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
  26:ORDER BY view_count DESC)
  27:
  28:SELECT * FROM temp WHERE  days_diff >= 60
  29:  );
  30:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2022-01-20 09:04:41.188515 (Thread-1): finished collecting timing info
2022-01-20 09:04:41.188913 (Thread-1): Runtime Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
  404 Not found: Dataset future-enigma-338718:dbt_stackoverflow was not found in location US
  
  (job ID: 1fb70fb5-8f15-4573-bd45-ca176c8c65e6)
Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1447, in result
    do_get_result()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    return retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1437, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/base.py", line 727, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Dataset future-enigma-338718:dbt_stackoverflow was not found in location US

(job ID: 1fb70fb5-8f15-4573-bd45-ca176c8c65e6)

                                                                  -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */
   2:
   3:
   4:  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    With temp as 
  10:(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
  11:        id,
  12:         title,
  13:         favorite_count,
  14:         accepted_answer_id,
  15:         answer_count,
  16:         creation_date,
  17:         last_activity_date,
  18:         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
  19:         view_count,
  20:         tags,
  21:         score
  22:FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`
  23:WHERE    answer_count = 0
  24:AND      accepted_answer_id IS NULL
  25:AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
  26:ORDER BY view_count DESC)
  27:
  28:SELECT * FROM temp WHERE  days_diff >= 60
  29:  );
  30:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 195, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
  404 Not found: Dataset future-enigma-338718:dbt_stackoverflow was not found in location US
  
  (job ID: 1fb70fb5-8f15-4573-bd45-ca176c8c65e6)
2022-01-20 09:04:41.191136 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a0d14e4-3d98-4100-b22b-3ce3a35d9867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56cd610a90>]}
2022-01-20 09:04:41.191569 (Thread-1): 09:04:41 | 1 of 1 ERROR creating table model dbt_stackoverflow.TrendingTopics... [ERROR in 9.27s]
2022-01-20 09:04:41.191825 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-20 09:04:41.193369 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 09:04:41.194142 (MainThread): 09:04:41 | 
2022-01-20 09:04:41.194637 (MainThread): 09:04:41 | Finished running 1 table model in 20.80s.
2022-01-20 09:04:41.195016 (MainThread): Connection 'master' was properly closed.
2022-01-20 09:04:41.195338 (MainThread): Connection 'model.stackoverflow_post.TrendingTopics' was properly closed.
2022-01-20 09:04:41.201267 (MainThread): 
2022-01-20 09:04:41.201724 (MainThread): Completed with 1 error and 0 warnings:
2022-01-20 09:04:41.202103 (MainThread): 
2022-01-20 09:04:41.202519 (MainThread): Runtime Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
2022-01-20 09:04:41.202898 (MainThread):   404 Not found: Dataset future-enigma-338718:dbt_stackoverflow was not found in location US
2022-01-20 09:04:41.203230 (MainThread):   
2022-01-20 09:04:41.203602 (MainThread):   (job ID: 1fb70fb5-8f15-4573-bd45-ca176c8c65e6)
2022-01-20 09:04:41.204180 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-01-20 09:04:41.204742 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56cd728d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56cd75d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56cd758ac0>]}
2022-01-20 09:04:41.205239 (MainThread): Flushing usage events
2022-01-20 09:15:27.259256 (MainThread): Running with dbt=0.21.1
2022-01-20 09:15:27.831187 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-20 09:15:27.832444 (MainThread): Tracking: tracking
2022-01-20 09:15:27.875627 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba62561d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba768a4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba62582070>]}
2022-01-20 09:15:27.888787 (MainThread): Partial parsing not enabled
2022-01-20 09:15:27.896738 (MainThread): Parsing macros/adapters.sql
2022-01-20 09:15:27.921179 (MainThread): Parsing macros/catalog.sql
2022-01-20 09:15:27.927299 (MainThread): Parsing macros/etc.sql
2022-01-20 09:15:27.929391 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-20 09:15:27.931318 (MainThread): Parsing macros/materializations/seed.sql
2022-01-20 09:15:27.933884 (MainThread): Parsing macros/materializations/copy.sql
2022-01-20 09:15:27.936598 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-20 09:15:27.951765 (MainThread): Parsing macros/materializations/view.sql
2022-01-20 09:15:27.954566 (MainThread): Parsing macros/materializations/table.sql
2022-01-20 09:15:27.964556 (MainThread): Parsing macros/core.sql
2022-01-20 09:15:27.968403 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-20 09:15:27.970671 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-20 09:15:27.972592 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-20 09:15:27.974084 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-20 09:15:27.975452 (MainThread): Parsing macros/etc/query.sql
2022-01-20 09:15:27.976468 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-20 09:15:27.977964 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-20 09:15:27.979608 (MainThread): Parsing macros/etc/datetime.sql
2022-01-20 09:15:27.989707 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-20 09:15:27.992541 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-20 09:15:27.994442 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-20 09:15:27.996147 (MainThread): Parsing macros/adapters/common.sql
2022-01-20 09:15:28.101371 (MainThread): Parsing macros/materializations/test.sql
2022-01-20 09:15:28.109682 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-20 09:15:28.121588 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-20 09:15:28.130454 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-20 09:15:28.132377 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-20 09:15:28.164200 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-20 09:15:28.182199 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-20 09:15:28.196330 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-20 09:15:28.198169 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-20 09:15:28.208432 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-20 09:15:28.228222 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-20 09:15:28.232350 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-20 09:15:28.239835 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-20 09:15:28.469398 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-20 09:15:28.506982 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 09:15:28.508970 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 09:15:28.523989 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61e4b24a-7231-48a6-9a34-28d3a1a70ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba625ab2e0>]}
2022-01-20 09:15:28.528404 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-20 09:15:28.528838 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61e4b24a-7231-48a6-9a34-28d3a1a70ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba625b6be0>]}
2022-01-20 09:15:28.529198 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-01-20 09:15:28.530484 (MainThread): 
2022-01-20 09:15:28.530902 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 09:15:28.531761 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-20 09:15:28.532126 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-20 09:15:35.314644 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-20 09:15:35.315741 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-20 09:15:35.333002 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-20 09:15:41.362582 (MainThread): 09:15:41 | Concurrency: 1 threads (target='dev')
2022-01-20 09:15:41.363496 (MainThread): 09:15:41 | 
2022-01-20 09:15:41.369804 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-20 09:15:41.371194 (Thread-1): 09:15:41 | 1 of 1 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-20 09:15:41.372685 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-20 09:15:41.373456 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-20 09:15:41.380689 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-20 09:15:41.382069 (Thread-1): finished collecting timing info
2022-01-20 09:15:41.437198 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-20 09:15:41.437685 (Thread-1): Opening a new connection, currently in state closed
2022-01-20 09:15:41.442433 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         creation_date,
         last_activity_date,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-20 09:15:46.081007 (Thread-1): finished collecting timing info
2022-01-20 09:15:46.083243 (Thread-1): Database Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
  Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.
  compiled SQL at target/run/stackoverflow_post/models/stack_models/TrendingTopics.sql
Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1447, in result
    do_get_result()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    return retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1437, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/base.py", line 727, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.

(job ID: 9b337fe6-1e02-4405-9895-422fb95715b3)

                                                                  -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */
   2:
   3:
   4:  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    With temp as 
  10:(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
  11:        id,
  12:         title,
  13:         favorite_count,
  14:         accepted_answer_id,
  15:         answer_count,
  16:         creation_date,
  17:         last_activity_date,
  18:         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
  19:         view_count,
  20:         tags,
  21:         score
  22:FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`
  23:WHERE    answer_count = 0
  24:AND      accepted_answer_id IS NULL
  25:AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
  26:ORDER BY view_count DESC)
  27:
  28:SELECT * FROM temp WHERE  days_diff >= 60
  29:  );
  30:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 171, in exception_handler
    self.handle_error(e, message)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
  Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.
  compiled SQL at target/run/stackoverflow_post/models/stack_models/TrendingTopics.sql
2022-01-20 09:15:46.096023 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e4b24a-7231-48a6-9a34-28d3a1a70ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba62604af0>]}
2022-01-20 09:15:46.097804 (Thread-1): 09:15:46 | 1 of 1 ERROR creating table model dbt_stackoverflow.TrendingTopics... [ERROR in 4.72s]
2022-01-20 09:15:46.098912 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-20 09:15:46.104134 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 09:15:46.105863 (MainThread): 09:15:46 | 
2022-01-20 09:15:46.107018 (MainThread): 09:15:46 | Finished running 1 table model in 17.57s.
2022-01-20 09:15:46.108112 (MainThread): Connection 'master' was properly closed.
2022-01-20 09:15:46.109334 (MainThread): Connection 'model.stackoverflow_post.TrendingTopics' was properly closed.
2022-01-20 09:15:46.139379 (MainThread): 
2022-01-20 09:15:46.141309 (MainThread): Completed with 1 error and 0 warnings:
2022-01-20 09:15:46.143263 (MainThread): 
2022-01-20 09:15:46.145851 (MainThread): Database Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
2022-01-20 09:15:46.147336 (MainThread):   Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.
2022-01-20 09:15:46.149210 (MainThread):   compiled SQL at target/run/stackoverflow_post/models/stack_models/TrendingTopics.sql
2022-01-20 09:15:46.150870 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-01-20 09:15:46.153338 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba6262da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba625ab400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba625b6520>]}
2022-01-20 09:15:46.155893 (MainThread): Flushing usage events
2022-01-20 09:23:15.577892 (MainThread): Running with dbt=0.21.1
2022-01-20 09:23:16.222698 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-20 09:23:16.223685 (MainThread): Tracking: tracking
2022-01-20 09:23:16.250910 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f424d68e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f2e20ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f2e20efd0>]}
2022-01-20 09:23:16.263163 (MainThread): Partial parsing not enabled
2022-01-20 09:23:16.271909 (MainThread): Parsing macros/adapters.sql
2022-01-20 09:23:16.298733 (MainThread): Parsing macros/catalog.sql
2022-01-20 09:23:16.305249 (MainThread): Parsing macros/etc.sql
2022-01-20 09:23:16.307484 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-20 09:23:16.309208 (MainThread): Parsing macros/materializations/seed.sql
2022-01-20 09:23:16.312002 (MainThread): Parsing macros/materializations/copy.sql
2022-01-20 09:23:16.314913 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-20 09:23:16.338208 (MainThread): Parsing macros/materializations/view.sql
2022-01-20 09:23:16.341679 (MainThread): Parsing macros/materializations/table.sql
2022-01-20 09:23:16.365290 (MainThread): Parsing macros/core.sql
2022-01-20 09:23:16.372301 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-20 09:23:16.374729 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-20 09:23:16.376537 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-20 09:23:16.378129 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-20 09:23:16.379403 (MainThread): Parsing macros/etc/query.sql
2022-01-20 09:23:16.380599 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-20 09:23:16.382249 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-20 09:23:16.383923 (MainThread): Parsing macros/etc/datetime.sql
2022-01-20 09:23:16.393989 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-20 09:23:16.397613 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-20 09:23:16.399592 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-20 09:23:16.401162 (MainThread): Parsing macros/adapters/common.sql
2022-01-20 09:23:16.518883 (MainThread): Parsing macros/materializations/test.sql
2022-01-20 09:23:16.527795 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-20 09:23:16.539992 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-20 09:23:16.550872 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-20 09:23:16.553097 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-20 09:23:16.589986 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-20 09:23:16.610741 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-20 09:23:16.626267 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-20 09:23:16.628290 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-20 09:23:16.641075 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-20 09:23:16.661970 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-20 09:23:16.667339 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-20 09:23:16.675605 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-20 09:23:16.935139 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-20 09:23:16.983761 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 09:23:16.988289 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 09:23:17.006533 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4565fb34-ece8-46ab-9fb3-893eb1c8bd6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f2e1d6af0>]}
2022-01-20 09:23:17.011165 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-20 09:23:17.011551 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4565fb34-ece8-46ab-9fb3-893eb1c8bd6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f2e1d6220>]}
2022-01-20 09:23:17.011872 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-01-20 09:23:17.012915 (MainThread): 
2022-01-20 09:23:17.013321 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 09:23:17.014234 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-20 09:23:17.014753 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-20 09:23:28.082883 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-20 09:23:28.084749 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-20 09:23:28.116134 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-20 09:23:33.932642 (MainThread): 09:23:33 | Concurrency: 1 threads (target='dev')
2022-01-20 09:23:33.933878 (MainThread): 09:23:33 | 
2022-01-20 09:23:33.942628 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-20 09:23:33.945162 (Thread-1): 09:23:33 | 1 of 1 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-20 09:23:33.947448 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-20 09:23:33.949269 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-20 09:23:33.960937 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-20 09:23:33.963360 (Thread-1): finished collecting timing info
2022-01-20 09:23:34.055990 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-20 09:23:34.056467 (Thread-1): Opening a new connection, currently in state closed
2022-01-20 09:23:34.061835 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         creation_date,
         last_activity_date,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-20 09:23:46.588881 (Thread-1): finished collecting timing info
2022-01-20 09:23:46.590939 (Thread-1): Database Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
  Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.
  compiled SQL at target/run/stackoverflow_post/models/stack_models/TrendingTopics.sql
Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1447, in result
    do_get_result()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    return retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1437, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/base.py", line 727, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.

(job ID: a33f6506-45ef-4b36-a7d8-ccb363caa933)

                                                                  -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */
   2:
   3:
   4:  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    With temp as 
  10:(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
  11:        id,
  12:         title,
  13:         favorite_count,
  14:         accepted_answer_id,
  15:         answer_count,
  16:         creation_date,
  17:         last_activity_date,
  18:         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
  19:         view_count,
  20:         tags,
  21:         score
  22:FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`
  23:WHERE    answer_count = 0
  24:AND      accepted_answer_id IS NULL
  25:AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
  26:ORDER BY view_count DESC)
  27:
  28:SELECT * FROM temp WHERE  days_diff >= 60
  29:  );
  30:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 171, in exception_handler
    self.handle_error(e, message)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
  Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.
  compiled SQL at target/run/stackoverflow_post/models/stack_models/TrendingTopics.sql
2022-01-20 09:23:46.604155 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4565fb34-ece8-46ab-9fb3-893eb1c8bd6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f2e147a90>]}
2022-01-20 09:23:46.606472 (Thread-1): 09:23:46 | 1 of 1 ERROR creating table model dbt_stackoverflow.TrendingTopics... [ERROR in 12.66s]
2022-01-20 09:23:46.608490 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-20 09:23:46.616720 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 09:23:46.619777 (MainThread): 09:23:46 | 
2022-01-20 09:23:46.621472 (MainThread): 09:23:46 | Finished running 1 table model in 29.61s.
2022-01-20 09:23:46.623483 (MainThread): Connection 'master' was properly closed.
2022-01-20 09:23:46.624704 (MainThread): Connection 'model.stackoverflow_post.TrendingTopics' was properly closed.
2022-01-20 09:23:46.652465 (MainThread): 
2022-01-20 09:23:46.653643 (MainThread): Completed with 1 error and 0 warnings:
2022-01-20 09:23:46.654670 (MainThread): 
2022-01-20 09:23:46.655703 (MainThread): Database Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
2022-01-20 09:23:46.656680 (MainThread):   Access Denied: Table bigquery-public-data:stackoverflow.stackoverflow_posts: User does not have permission to query table bigquery-public-data:stackoverflow.stackoverflow_posts.
2022-01-20 09:23:46.657605 (MainThread):   compiled SQL at target/run/stackoverflow_post/models/stack_models/TrendingTopics.sql
2022-01-20 09:23:46.658710 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-01-20 09:23:46.660908 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f2e17e310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f2e1bdfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f2e1d60d0>]}
2022-01-20 09:23:46.662743 (MainThread): Flushing usage events
2022-01-20 09:28:21.127206 (MainThread): Running with dbt=0.21.1
2022-01-20 09:28:21.919652 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-20 09:28:21.920803 (MainThread): Tracking: tracking
2022-01-20 09:28:21.955374 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff906169e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f1e25cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f1e25d00>]}
2022-01-20 09:28:21.972261 (MainThread): Partial parsing not enabled
2022-01-20 09:28:21.983976 (MainThread): Parsing macros/adapters.sql
2022-01-20 09:28:22.018971 (MainThread): Parsing macros/catalog.sql
2022-01-20 09:28:22.026501 (MainThread): Parsing macros/etc.sql
2022-01-20 09:28:22.029151 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-20 09:28:22.031630 (MainThread): Parsing macros/materializations/seed.sql
2022-01-20 09:28:22.034921 (MainThread): Parsing macros/materializations/copy.sql
2022-01-20 09:28:22.038034 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-20 09:28:22.057348 (MainThread): Parsing macros/materializations/view.sql
2022-01-20 09:28:22.061599 (MainThread): Parsing macros/materializations/table.sql
2022-01-20 09:28:22.072800 (MainThread): Parsing macros/core.sql
2022-01-20 09:28:22.077367 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-20 09:28:22.079850 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-20 09:28:22.082231 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-20 09:28:22.084315 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-20 09:28:22.085802 (MainThread): Parsing macros/etc/query.sql
2022-01-20 09:28:22.086966 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-20 09:28:22.088902 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-20 09:28:22.091462 (MainThread): Parsing macros/etc/datetime.sql
2022-01-20 09:28:22.103039 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-20 09:28:22.106312 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-20 09:28:22.108802 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-20 09:28:22.110620 (MainThread): Parsing macros/adapters/common.sql
2022-01-20 09:28:22.220534 (MainThread): Parsing macros/materializations/test.sql
2022-01-20 09:28:22.228870 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-20 09:28:22.241139 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-20 09:28:22.250177 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-20 09:28:22.252190 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-20 09:28:22.284781 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-20 09:28:22.302536 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-20 09:28:22.316923 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-20 09:28:22.318760 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-20 09:28:22.329353 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-20 09:28:22.349502 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-20 09:28:22.353726 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-20 09:28:22.361034 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-20 09:28:22.608554 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-20 09:28:22.646163 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 09:28:22.648308 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 09:28:22.662842 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8aa9b1b3-4b7e-4bd0-975b-d6feff8f7ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f1e69190>]}
2022-01-20 09:28:22.667802 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-20 09:28:22.668247 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8aa9b1b3-4b7e-4bd0-975b-d6feff8f7ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f1e69640>]}
2022-01-20 09:28:22.668571 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-01-20 09:28:22.669566 (MainThread): 
2022-01-20 09:28:22.669955 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 09:28:22.670718 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-20 09:28:22.671247 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-20 09:28:30.123533 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_future-enigma-338718_dbt_stackoverflow".
2022-01-20 09:28:30.124385 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_future-enigma-338718_dbt_stackoverflow".
2022-01-20 09:28:30.124928 (ThreadPoolExecutor-0_0): Creating schema "future-enigma-338718.dbt_stackoverflow".
2022-01-20 09:28:30.125269 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2022-01-20 09:28:30.131519 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-20 09:28:36.306643 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-20 09:28:36.308596 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-20 09:28:36.334049 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-20 09:28:41.765551 (MainThread): 09:28:41 | Concurrency: 1 threads (target='dev')
2022-01-20 09:28:41.765994 (MainThread): 09:28:41 | 
2022-01-20 09:28:41.768487 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-20 09:28:41.769031 (Thread-1): 09:28:41 | 1 of 1 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-20 09:28:41.769721 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-20 09:28:41.770292 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-20 09:28:41.773850 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-20 09:28:41.774651 (Thread-1): finished collecting timing info
2022-01-20 09:28:41.829496 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-20 09:28:41.830122 (Thread-1): Opening a new connection, currently in state closed
2022-01-20 09:28:41.834954 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         creation_date,
         last_activity_date,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-20 09:29:00.826158 (Thread-1): finished collecting timing info
2022-01-20 09:29:00.826881 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8aa9b1b3-4b7e-4bd0-975b-d6feff8f7ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f1ebed90>]}
2022-01-20 09:29:00.827436 (Thread-1): 09:29:00 | 1 of 1 OK created table model dbt_stackoverflow.TrendingTopics....... [CREATE TABLE (4.3k rows, 2.1 GB processed) in 19.06s]
2022-01-20 09:29:00.827858 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-20 09:29:00.829196 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 09:29:00.829610 (MainThread): 09:29:00 | 
2022-01-20 09:29:00.829833 (MainThread): 09:29:00 | Finished running 1 table model in 38.16s.
2022-01-20 09:29:00.830029 (MainThread): Connection 'master' was properly closed.
2022-01-20 09:29:00.830212 (MainThread): Connection 'model.stackoverflow_post.TrendingTopics' was properly closed.
2022-01-20 09:29:00.831105 (MainThread): unclosed <ssl.SSLSocket fd=14, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:b440:7363:43bc:22ba', 51350, 0, 0), raddr=('2a00:1450:4009:815::200a', 443, 0, 0)>
2022-01-20 09:29:00.831359 (MainThread): unclosed <ssl.SSLSocket fd=15, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:b440:7363:43bc:22ba', 40762, 0, 0), raddr=('2a00:1450:4009:81d::200a', 443, 0, 0)>
2022-01-20 09:29:00.837494 (MainThread): 
2022-01-20 09:29:00.837983 (MainThread): Completed successfully
2022-01-20 09:29:00.838506 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-01-20 09:29:00.839117 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff909569d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f1e76460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f1e76040>]}
2022-01-20 09:29:00.839745 (MainThread): Flushing usage events
2022-01-20 09:47:52.176392 (MainThread): Running with dbt=0.21.1
2022-01-20 09:47:52.749594 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-20 09:47:52.750537 (MainThread): Tracking: tracking
2022-01-20 09:47:52.774992 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d58186910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d43e3b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d43e3bee0>]}
2022-01-20 09:47:52.786511 (MainThread): Partial parsing not enabled
2022-01-20 09:47:52.794540 (MainThread): Parsing macros/adapters.sql
2022-01-20 09:47:52.821757 (MainThread): Parsing macros/catalog.sql
2022-01-20 09:47:52.827944 (MainThread): Parsing macros/etc.sql
2022-01-20 09:47:52.830014 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-20 09:47:52.831840 (MainThread): Parsing macros/materializations/seed.sql
2022-01-20 09:47:52.834385 (MainThread): Parsing macros/materializations/copy.sql
2022-01-20 09:47:52.837297 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-20 09:47:52.852561 (MainThread): Parsing macros/materializations/view.sql
2022-01-20 09:47:52.855208 (MainThread): Parsing macros/materializations/table.sql
2022-01-20 09:47:52.865079 (MainThread): Parsing macros/core.sql
2022-01-20 09:47:52.869082 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-20 09:47:52.871396 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-20 09:47:52.873182 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-20 09:47:52.874572 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-20 09:47:52.875904 (MainThread): Parsing macros/etc/query.sql
2022-01-20 09:47:52.876922 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-20 09:47:52.878580 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-20 09:47:52.880303 (MainThread): Parsing macros/etc/datetime.sql
2022-01-20 09:47:52.889032 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-20 09:47:52.891656 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-20 09:47:52.893535 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-20 09:47:52.895297 (MainThread): Parsing macros/adapters/common.sql
2022-01-20 09:47:53.000783 (MainThread): Parsing macros/materializations/test.sql
2022-01-20 09:47:53.009090 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-20 09:47:53.021001 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-20 09:47:53.029772 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-20 09:47:53.031738 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-20 09:47:53.063555 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-20 09:47:53.081320 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-20 09:47:53.095630 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-20 09:47:53.097459 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-20 09:47:53.107925 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-20 09:47:53.128639 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-20 09:47:53.132804 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-20 09:47:53.140241 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-20 09:47:53.372849 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-20 09:47:53.410219 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 09:47:53.412591 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 09:47:53.435723 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '155c331f-b9f9-4b55-aa53-4144e344b87a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d43e8f2e0>]}
2022-01-20 09:47:53.440857 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-20 09:47:53.441361 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '155c331f-b9f9-4b55-aa53-4144e344b87a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d43e7dd30>]}
2022-01-20 09:47:53.441710 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-01-20 09:47:53.442862 (MainThread): 
2022-01-20 09:47:53.443274 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 09:47:53.444045 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-20 09:47:53.444423 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-20 09:47:57.710163 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-20 09:47:57.711216 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-20 09:47:57.728142 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-20 09:48:07.210489 (MainThread): 09:48:07 | Concurrency: 1 threads (target='dev')
2022-01-20 09:48:07.211624 (MainThread): 09:48:07 | 
2022-01-20 09:48:07.218345 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-20 09:48:07.219537 (Thread-1): 09:48:07 | 1 of 1 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-20 09:48:07.220894 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-20 09:48:07.221609 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-20 09:48:07.231952 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-20 09:48:07.233290 (Thread-1): finished collecting timing info
2022-01-20 09:48:07.266326 (Thread-1): Opening a new connection, currently in state closed
2022-01-20 09:48:07.271283 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-20 09:48:13.722305 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-20 09:48:13.722812 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         creation_date,
         last_activity_date,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `future-enigma-338718`.`stackoverflow`.`stackoverflow_posts`--`bigquery-public-data.stackoverflow.stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-20 09:48:14.802352 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         creation_date,
         last_activity_date,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `future-enigma-338718`.`stackoverflow`.`stackoverflow_posts`--`bigquery-public-data.stackoverflow.stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-20 09:48:14.803162 (Thread-1): 404 Not found: Dataset future-enigma-338718:stackoverflow was not found in location US

(job ID: 91ed96b5-f016-42fa-9a03-9fe9f6237cfd)

                                                                  -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */
   2:
   3:
   4:  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    With temp as 
  10:(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
  11:        id,
  12:         title,
  13:         favorite_count,
  14:         accepted_answer_id,
  15:         answer_count,
  16:         creation_date,
  17:         last_activity_date,
  18:         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
  19:         view_count,
  20:         tags,
  21:         score
  22:FROM     `future-enigma-338718`.`stackoverflow`.`stackoverflow_posts`--`bigquery-public-data.stackoverflow.stackoverflow_posts`
  23:WHERE    answer_count = 0
  24:AND      accepted_answer_id IS NULL
  25:AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
  26:ORDER BY view_count DESC)
  27:
  28:SELECT * FROM temp WHERE  days_diff >= 60
  29:  );
  30:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2022-01-20 09:48:14.804083 (Thread-1): finished collecting timing info
2022-01-20 09:48:14.805395 (Thread-1): Runtime Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
  404 Not found: Dataset future-enigma-338718:stackoverflow was not found in location US
  
  (job ID: 91ed96b5-f016-42fa-9a03-9fe9f6237cfd)
Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1447, in result
    do_get_result()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    return retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1437, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/base.py", line 727, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Dataset future-enigma-338718:stackoverflow was not found in location US

(job ID: 91ed96b5-f016-42fa-9a03-9fe9f6237cfd)

                                                                  -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */
   2:
   3:
   4:  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    With temp as 
  10:(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
  11:        id,
  12:         title,
  13:         favorite_count,
  14:         accepted_answer_id,
  15:         answer_count,
  16:         creation_date,
  17:         last_activity_date,
  18:         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
  19:         view_count,
  20:         tags,
  21:         score
  22:FROM     `future-enigma-338718`.`stackoverflow`.`stackoverflow_posts`--`bigquery-public-data.stackoverflow.stackoverflow_posts`
  23:WHERE    answer_count = 0
  24:AND      accepted_answer_id IS NULL
  25:AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
  26:ORDER BY view_count DESC)
  27:
  28:SELECT * FROM temp WHERE  days_diff >= 60
  29:  );
  30:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 195, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
  404 Not found: Dataset future-enigma-338718:stackoverflow was not found in location US
  
  (job ID: 91ed96b5-f016-42fa-9a03-9fe9f6237cfd)
2022-01-20 09:48:14.813348 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155c331f-b9f9-4b55-aa53-4144e344b87a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d43e11d30>]}
2022-01-20 09:48:14.814619 (Thread-1): 09:48:14 | 1 of 1 ERROR creating table model dbt_stackoverflow.TrendingTopics... [ERROR in 7.59s]
2022-01-20 09:48:14.815464 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-20 09:48:14.818844 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 09:48:14.820139 (MainThread): 09:48:14 | 
2022-01-20 09:48:14.820920 (MainThread): 09:48:14 | Finished running 1 table model in 21.38s.
2022-01-20 09:48:14.821637 (MainThread): Connection 'master' was properly closed.
2022-01-20 09:48:14.822226 (MainThread): Connection 'model.stackoverflow_post.TrendingTopics' was properly closed.
2022-01-20 09:48:14.837675 (MainThread): 
2022-01-20 09:48:14.838120 (MainThread): Completed with 1 error and 0 warnings:
2022-01-20 09:48:14.838518 (MainThread): 
2022-01-20 09:48:14.838903 (MainThread): Runtime Error in model TrendingTopics (models/stack_models/TrendingTopics.sql)
2022-01-20 09:48:14.839257 (MainThread):   404 Not found: Dataset future-enigma-338718:stackoverflow was not found in location US
2022-01-20 09:48:14.839606 (MainThread):   
2022-01-20 09:48:14.840005 (MainThread):   (job ID: 91ed96b5-f016-42fa-9a03-9fe9f6237cfd)
2022-01-20 09:48:14.840376 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-01-20 09:48:14.840897 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d43f0fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d43e8fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d43ed1520>]}
2022-01-20 09:48:14.841356 (MainThread): Flushing usage events
2022-01-20 09:52:15.463120 (MainThread): Running with dbt=0.21.1
2022-01-20 09:52:16.027060 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-20 09:52:16.028040 (MainThread): Tracking: tracking
2022-01-20 09:52:16.052980 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61af4cbf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61c381d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61af4fb0a0>]}
2022-01-20 09:52:16.065046 (MainThread): Partial parsing not enabled
2022-01-20 09:52:16.073186 (MainThread): Parsing macros/adapters.sql
2022-01-20 09:52:16.098079 (MainThread): Parsing macros/catalog.sql
2022-01-20 09:52:16.104320 (MainThread): Parsing macros/etc.sql
2022-01-20 09:52:16.106274 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-20 09:52:16.108115 (MainThread): Parsing macros/materializations/seed.sql
2022-01-20 09:52:16.111059 (MainThread): Parsing macros/materializations/copy.sql
2022-01-20 09:52:16.113806 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-20 09:52:16.129109 (MainThread): Parsing macros/materializations/view.sql
2022-01-20 09:52:16.131830 (MainThread): Parsing macros/materializations/table.sql
2022-01-20 09:52:16.141815 (MainThread): Parsing macros/core.sql
2022-01-20 09:52:16.145960 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-20 09:52:16.148502 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-20 09:52:16.150311 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-20 09:52:16.151914 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-20 09:52:16.153411 (MainThread): Parsing macros/etc/query.sql
2022-01-20 09:52:16.154542 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-20 09:52:16.156194 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-20 09:52:16.157830 (MainThread): Parsing macros/etc/datetime.sql
2022-01-20 09:52:16.166699 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-20 09:52:16.169472 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-20 09:52:16.171336 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-20 09:52:16.172954 (MainThread): Parsing macros/adapters/common.sql
2022-01-20 09:52:16.279195 (MainThread): Parsing macros/materializations/test.sql
2022-01-20 09:52:16.287502 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-20 09:52:16.299456 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-20 09:52:16.308435 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-20 09:52:16.310525 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-20 09:52:16.342968 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-20 09:52:16.360952 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-20 09:52:16.375136 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-20 09:52:16.377279 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-20 09:52:16.387764 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-20 09:52:16.407905 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-20 09:52:16.412163 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-20 09:52:16.419413 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-20 09:52:16.649550 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-20 09:52:16.688246 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 09:52:16.690235 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-20 09:52:16.713067 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd798ff51-d7f1-42b4-8ff8-4c9dc33a077e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61af475bb0>]}
2022-01-20 09:52:16.717666 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-20 09:52:16.718103 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd798ff51-d7f1-42b4-8ff8-4c9dc33a077e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61af5a6fd0>]}
2022-01-20 09:52:16.718447 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-01-20 09:52:16.719524 (MainThread): 
2022-01-20 09:52:16.719981 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 09:52:16.720772 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-20 09:52:16.721165 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-20 09:52:22.352623 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-20 09:52:22.353780 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-20 09:52:22.370474 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-20 09:52:26.490582 (MainThread): 09:52:26 | Concurrency: 1 threads (target='dev')
2022-01-20 09:52:26.491590 (MainThread): 09:52:26 | 
2022-01-20 09:52:26.497632 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-20 09:52:26.498936 (Thread-1): 09:52:26 | 1 of 1 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-20 09:52:26.500404 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-20 09:52:26.501420 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-20 09:52:26.511858 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-20 09:52:26.513314 (Thread-1): finished collecting timing info
2022-01-20 09:52:26.567914 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-20 09:52:26.568394 (Thread-1): Opening a new connection, currently in state closed
2022-01-20 09:52:26.572640 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         creation_date,
         last_activity_date,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`--`bigquery-public-data.stackoverflow.stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data.stackoverflow.stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-20 09:52:43.190443 (Thread-1): finished collecting timing info
2022-01-20 09:52:43.192029 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd798ff51-d7f1-42b4-8ff8-4c9dc33a077e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61af526970>]}
2022-01-20 09:52:43.193261 (Thread-1): 09:52:43 | 1 of 1 OK created table model dbt_stackoverflow.TrendingTopics....... [CREATE TABLE (4.3k rows, 2.1 GB processed) in 16.69s]
2022-01-20 09:52:43.194242 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-20 09:52:43.197141 (MainThread): Acquiring new bigquery connection "master".
2022-01-20 09:52:43.198575 (MainThread): 09:52:43 | 
2022-01-20 09:52:43.199278 (MainThread): 09:52:43 | Finished running 1 table model in 26.48s.
2022-01-20 09:52:43.199954 (MainThread): Connection 'master' was properly closed.
2022-01-20 09:52:43.200481 (MainThread): Connection 'model.stackoverflow_post.TrendingTopics' was properly closed.
2022-01-20 09:52:43.202901 (MainThread): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:b440:7363:43bc:22ba', 55178, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2022-01-20 09:52:43.203690 (MainThread): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:b440:7363:43bc:22ba', 55180, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2022-01-20 09:52:43.219250 (MainThread): 
2022-01-20 09:52:43.220039 (MainThread): Completed successfully
2022-01-20 09:52:43.220749 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-01-20 09:52:43.221935 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61af46ec40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61af458be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61af5263d0>]}
2022-01-20 09:52:43.223229 (MainThread): Flushing usage events
2022-01-21 08:17:56.284433 (MainThread): Running with dbt=0.21.1
2022-01-21 08:17:57.414584 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-21 08:17:57.415835 (MainThread): Tracking: tracking
2022-01-21 08:17:57.456922 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f587fbfb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586b92dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586b92dcd0>]}
2022-01-21 08:17:57.467753 (MainThread): Partial parsing not enabled
2022-01-21 08:17:57.483535 (MainThread): Parsing macros/adapters.sql
2022-01-21 08:17:57.507828 (MainThread): Parsing macros/catalog.sql
2022-01-21 08:17:57.513961 (MainThread): Parsing macros/etc.sql
2022-01-21 08:17:57.515975 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-21 08:17:57.517703 (MainThread): Parsing macros/materializations/seed.sql
2022-01-21 08:17:57.520197 (MainThread): Parsing macros/materializations/copy.sql
2022-01-21 08:17:57.523085 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-21 08:17:57.537663 (MainThread): Parsing macros/materializations/view.sql
2022-01-21 08:17:57.540258 (MainThread): Parsing macros/materializations/table.sql
2022-01-21 08:17:57.549528 (MainThread): Parsing macros/core.sql
2022-01-21 08:17:57.553243 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-21 08:17:57.555704 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-21 08:17:57.557463 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-21 08:17:57.558843 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-21 08:17:57.560152 (MainThread): Parsing macros/etc/query.sql
2022-01-21 08:17:57.561176 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-21 08:17:57.562724 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-21 08:17:57.564402 (MainThread): Parsing macros/etc/datetime.sql
2022-01-21 08:17:57.572728 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-21 08:17:57.575238 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-21 08:17:57.577152 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-21 08:17:57.578684 (MainThread): Parsing macros/adapters/common.sql
2022-01-21 08:17:57.683782 (MainThread): Parsing macros/materializations/test.sql
2022-01-21 08:17:57.692107 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-21 08:17:57.703862 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-21 08:17:57.712611 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-21 08:17:57.714732 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-21 08:17:57.746273 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-21 08:17:57.763234 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-21 08:17:57.777065 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-21 08:17:57.779063 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-21 08:17:57.789295 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-21 08:17:57.808719 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-21 08:17:57.812580 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-21 08:17:57.820487 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-21 08:17:58.050048 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-21 08:17:58.062797 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TopTags".
2022-01-21 08:17:58.091014 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-21 08:17:58.093137 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-21 08:17:58.115017 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '602499e1-6d3e-48ca-9c8a-f29f6c6999a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586b7e8970>]}
2022-01-21 08:17:58.119819 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-21 08:17:58.120261 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '602499e1-6d3e-48ca-9c8a-f29f6c6999a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586b7e8a60>]}
2022-01-21 08:17:58.120586 (MainThread): Found 2 models, 2 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-01-21 08:17:58.121662 (MainThread): 
2022-01-21 08:17:58.122074 (MainThread): Acquiring new bigquery connection "master".
2022-01-21 08:17:58.123045 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-21 08:17:58.123397 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-21 08:18:04.764043 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-21 08:18:04.766084 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-21 08:18:04.796030 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-21 08:18:14.285369 (MainThread): 08:18:14 | Concurrency: 1 threads (target='dev')
2022-01-21 08:18:14.286821 (MainThread): 08:18:14 | 
2022-01-21 08:18:14.303634 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-21 08:18:14.305998 (Thread-1): 08:18:14 | 1 of 2 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-21 08:18:14.308081 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-21 08:18:14.309306 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-21 08:18:14.326153 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-21 08:18:14.328081 (Thread-1): finished collecting timing info
2022-01-21 08:18:14.359710 (Thread-1): Opening a new connection, currently in state closed
2022-01-21 08:18:14.364365 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-21 08:18:17.962165 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-21 08:18:17.962826 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         creation_date,
         last_activity_date,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-21 08:18:22.608128 (Thread-1): finished collecting timing info
2022-01-21 08:18:22.609228 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '602499e1-6d3e-48ca-9c8a-f29f6c6999a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586aee1430>]}
2022-01-21 08:18:22.610107 (Thread-1): 08:18:22 | 1 of 2 OK created table model dbt_stackoverflow.TrendingTopics....... [CREATE TABLE (4.3k rows, 2.1 GB processed) in 8.30s]
2022-01-21 08:18:22.610655 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-21 08:18:22.611930 (Thread-1): Began running node model.stackoverflow_post.TopTags
2022-01-21 08:18:22.612956 (Thread-1): 08:18:22 | 2 of 2 START table model dbt_stackoverflow.TopTags................... [RUN]
2022-01-21 08:18:22.613585 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TopTags".
2022-01-21 08:18:22.613916 (Thread-1): Compiling model.stackoverflow_post.TopTags
2022-01-21 08:18:22.617531 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TopTags"
2022-01-21 08:18:22.626086 (Thread-1): finished collecting timing info
2022-01-21 08:18:22.629264 (Thread-1): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 22558, 0, 0), raddr=('2a00:1450:4009:81f::200a', 443, 0, 0)>
2022-01-21 08:18:22.630451 (Thread-1): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 35644, 0, 0), raddr=('2a00:1450:4009:80a::200a', 443, 0, 0)>
2022-01-21 08:18:22.631298 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 22560, 0, 0), raddr=('2a00:1450:4009:81f::200a', 443, 0, 0)>
2022-01-21 08:18:22.632256 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 35646, 0, 0), raddr=('2a00:1450:4009:80a::200a', 443, 0, 0)>
2022-01-21 08:18:22.633106 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 22562, 0, 0), raddr=('2a00:1450:4009:81f::200a', 443, 0, 0)>
2022-01-21 08:18:22.633506 (Thread-1): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 35648, 0, 0), raddr=('2a00:1450:4009:80a::200a', 443, 0, 0)>
2022-01-21 08:18:22.637490 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TopTags"
2022-01-21 08:18:22.638450 (Thread-1): Opening a new connection, currently in state closed
2022-01-21 08:18:22.645138 (Thread-1): On model.stackoverflow_post.TopTags: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TopTags"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TopTags`
  
  
  OPTIONS()
  as (
    SELECT
  ROW_NUMBER() OVER() AS Tag_Key,
  splitted_tags,
  COUNT(*) AS tech_count
FROM (
  SELECT
    SPLIT(tags,'|') AS TechnologyName
  FROM
    `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`)
CROSS JOIN
  UNNEST(TechnologyName) splitted_tags
GROUP BY
  splitted_tags
ORDER BY
  tech_count DESC
  );
    
2022-01-21 08:18:31.079394 (Thread-1): finished collecting timing info
2022-01-21 08:18:31.080067 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '602499e1-6d3e-48ca-9c8a-f29f6c6999a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586aee1910>]}
2022-01-21 08:18:31.087900 (Thread-1): 08:18:31 | 2 of 2 OK created table model dbt_stackoverflow.TopTags.............. [CREATE TABLE (3.7k rows, 123.2 KB processed) in 8.47s]
2022-01-21 08:18:31.088836 (Thread-1): Finished running node model.stackoverflow_post.TopTags
2022-01-21 08:18:31.091636 (MainThread): Acquiring new bigquery connection "master".
2022-01-21 08:18:31.092695 (MainThread): 08:18:31 | 
2022-01-21 08:18:31.093250 (MainThread): 08:18:31 | Finished running 2 table models in 32.97s.
2022-01-21 08:18:31.093737 (MainThread): Connection 'master' was properly closed.
2022-01-21 08:18:31.094142 (MainThread): Connection 'model.stackoverflow_post.TopTags' was properly closed.
2022-01-21 08:18:31.096438 (MainThread): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 22566, 0, 0), raddr=('2a00:1450:4009:81f::200a', 443, 0, 0)>
2022-01-21 08:18:31.097016 (MainThread): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 35650, 0, 0), raddr=('2a00:1450:4009:80a::200a', 443, 0, 0)>
2022-01-21 08:18:31.104718 (MainThread): 
2022-01-21 08:18:31.105078 (MainThread): Completed successfully
2022-01-21 08:18:31.105385 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-01-21 08:18:31.105744 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586b95a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586b92dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586aed9550>]}
2022-01-21 08:18:31.106160 (MainThread): Flushing usage events
2022-01-21 08:32:32.866700 (MainThread): Running with dbt=0.21.1
2022-01-21 08:32:33.424784 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-21 08:32:33.425685 (MainThread): Tracking: tracking
2022-01-21 08:32:33.450506 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cf27d79a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cde489b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cde489af0>]}
2022-01-21 08:32:33.461813 (MainThread): Partial parsing not enabled
2022-01-21 08:32:33.470027 (MainThread): Parsing macros/adapters.sql
2022-01-21 08:32:33.493382 (MainThread): Parsing macros/catalog.sql
2022-01-21 08:32:33.499014 (MainThread): Parsing macros/etc.sql
2022-01-21 08:32:33.501065 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-21 08:32:33.502793 (MainThread): Parsing macros/materializations/seed.sql
2022-01-21 08:32:33.505475 (MainThread): Parsing macros/materializations/copy.sql
2022-01-21 08:32:33.508092 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-21 08:32:33.523635 (MainThread): Parsing macros/materializations/view.sql
2022-01-21 08:32:33.526300 (MainThread): Parsing macros/materializations/table.sql
2022-01-21 08:32:33.535531 (MainThread): Parsing macros/core.sql
2022-01-21 08:32:33.539163 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-21 08:32:33.541566 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-21 08:32:33.543247 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-21 08:32:33.544699 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-21 08:32:33.545922 (MainThread): Parsing macros/etc/query.sql
2022-01-21 08:32:33.546918 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-21 08:32:33.548432 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-21 08:32:33.550115 (MainThread): Parsing macros/etc/datetime.sql
2022-01-21 08:32:33.558503 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-21 08:32:33.561114 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-21 08:32:33.563294 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-21 08:32:33.564913 (MainThread): Parsing macros/adapters/common.sql
2022-01-21 08:32:33.666510 (MainThread): Parsing macros/materializations/test.sql
2022-01-21 08:32:33.674619 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-21 08:32:33.686100 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-21 08:32:33.694474 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-21 08:32:33.696259 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-21 08:32:33.727862 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-21 08:32:33.744491 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-21 08:32:33.758077 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-21 08:32:33.759814 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-21 08:32:33.770361 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-21 08:32:33.789489 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-21 08:32:33.793356 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-21 08:32:33.800299 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-21 08:32:34.024701 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-21 08:32:34.037807 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TopTags".
2022-01-21 08:32:34.050050 (MainThread): Acquiring new bigquery connection "test.stackoverflow_post.assert_total_notlessthan_zero".
2022-01-21 08:32:34.052812 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-21 08:32:34.075888 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-21 08:32:34.077867 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-21 08:32:34.099896 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c913aa1-3c67-4250-a6ef-b5a4819748cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cde3da040>]}
2022-01-21 08:32:34.104763 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-21 08:32:34.105226 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c913aa1-3c67-4250-a6ef-b5a4819748cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cde3da070>]}
2022-01-21 08:32:34.105573 (MainThread): Found 2 models, 3 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-01-21 08:32:34.106655 (MainThread): 
2022-01-21 08:32:34.107041 (MainThread): Acquiring new bigquery connection "master".
2022-01-21 08:32:34.107885 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-21 08:32:34.108255 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-21 08:32:35.680944 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-21 08:32:35.682033 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-21 08:32:35.697689 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-21 08:32:37.625918 (MainThread): 08:32:37 | Concurrency: 1 threads (target='dev')
2022-01-21 08:32:37.626865 (MainThread): 08:32:37 | 
2022-01-21 08:32:37.632710 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-21 08:32:37.634039 (Thread-1): 08:32:37 | 1 of 2 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-21 08:32:37.635656 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-21 08:32:37.636416 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-21 08:32:37.646666 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-21 08:32:37.648064 (Thread-1): finished collecting timing info
2022-01-21 08:32:37.665779 (Thread-1): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 22568, 0, 0), raddr=('2a00:1450:4009:81f::200a', 443, 0, 0)>
2022-01-21 08:32:37.666423 (Thread-1): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 38722, 0, 0), raddr=('2a00:1450:4009:815::200a', 443, 0, 0)>
2022-01-21 08:32:37.666900 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 22570, 0, 0), raddr=('2a00:1450:4009:81f::200a', 443, 0, 0)>
2022-01-21 08:32:37.667251 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 38724, 0, 0), raddr=('2a00:1450:4009:815::200a', 443, 0, 0)>
2022-01-21 08:32:37.683720 (Thread-1): Opening a new connection, currently in state closed
2022-01-21 08:32:37.689891 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-21 08:32:39.927630 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-21 08:32:39.928157 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         creation_date,
         last_activity_date,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-21 08:32:44.398963 (Thread-1): finished collecting timing info
2022-01-21 08:32:44.400621 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c913aa1-3c67-4250-a6ef-b5a4819748cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cde2d2f70>]}
2022-01-21 08:32:44.402180 (Thread-1): 08:32:44 | 1 of 2 OK created table model dbt_stackoverflow.TrendingTopics....... [CREATE TABLE (4.3k rows, 2.1 GB processed) in 6.77s]
2022-01-21 08:32:44.403023 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-21 08:32:44.404924 (Thread-1): Began running node model.stackoverflow_post.TopTags
2022-01-21 08:32:44.406440 (Thread-1): 08:32:44 | 2 of 2 START table model dbt_stackoverflow.TopTags................... [RUN]
2022-01-21 08:32:44.408380 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TopTags".
2022-01-21 08:32:44.409182 (Thread-1): Compiling model.stackoverflow_post.TopTags
2022-01-21 08:32:44.415189 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TopTags"
2022-01-21 08:32:44.416407 (Thread-1): finished collecting timing info
2022-01-21 08:32:44.419387 (Thread-1): Opening a new connection, currently in state closed
2022-01-21 08:32:44.426700 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-21 08:32:45.048547 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TopTags"
2022-01-21 08:32:45.050099 (Thread-1): On model.stackoverflow_post.TopTags: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TopTags"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TopTags`
  
  
  OPTIONS()
  as (
    SELECT
  ROW_NUMBER() OVER() AS Tag_Key,
  splitted_tags,
  COUNT(*) AS tech_count
FROM (
  SELECT
    SPLIT(tags,'|') AS TechnologyName
  FROM
    `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`)
CROSS JOIN
  UNNEST(TechnologyName) splitted_tags
GROUP BY
  splitted_tags
ORDER BY
  tech_count DESC
  );
    
2022-01-21 08:32:48.786986 (Thread-1): finished collecting timing info
2022-01-21 08:32:48.788554 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c913aa1-3c67-4250-a6ef-b5a4819748cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cde2ad880>]}
2022-01-21 08:32:48.789875 (Thread-1): 08:32:48 | 2 of 2 OK created table model dbt_stackoverflow.TopTags.............. [CREATE TABLE (3.7k rows, 123.2 KB processed) in 4.38s]
2022-01-21 08:32:48.790751 (Thread-1): Finished running node model.stackoverflow_post.TopTags
2022-01-21 08:32:48.793928 (MainThread): Acquiring new bigquery connection "master".
2022-01-21 08:32:48.795233 (MainThread): 08:32:48 | 
2022-01-21 08:32:48.796021 (MainThread): 08:32:48 | Finished running 2 table models in 14.69s.
2022-01-21 08:32:48.796779 (MainThread): Connection 'master' was properly closed.
2022-01-21 08:32:48.797387 (MainThread): Connection 'model.stackoverflow_post.TopTags' was properly closed.
2022-01-21 08:32:48.815092 (MainThread): 
2022-01-21 08:32:48.815769 (MainThread): Completed successfully
2022-01-21 08:32:48.816390 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-01-21 08:32:48.817044 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cde3c22b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cde2c9b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cde489e50>]}
2022-01-21 08:32:48.817715 (MainThread): Flushing usage events
2022-01-21 08:34:19.064686 (MainThread): Running with dbt=0.21.1
2022-01-21 08:34:19.623339 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=None, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2022-01-21 08:34:19.624297 (MainThread): Tracking: tracking
2022-01-21 08:34:19.648828 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff69badc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fe266fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fe266ff70>]}
2022-01-21 08:34:19.659845 (MainThread): Partial parsing not enabled
2022-01-21 08:34:19.668214 (MainThread): Parsing macros/adapters.sql
2022-01-21 08:34:19.693031 (MainThread): Parsing macros/catalog.sql
2022-01-21 08:34:19.698698 (MainThread): Parsing macros/etc.sql
2022-01-21 08:34:19.700878 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-21 08:34:19.702645 (MainThread): Parsing macros/materializations/seed.sql
2022-01-21 08:34:19.705331 (MainThread): Parsing macros/materializations/copy.sql
2022-01-21 08:34:19.707949 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-21 08:34:19.722348 (MainThread): Parsing macros/materializations/view.sql
2022-01-21 08:34:19.725006 (MainThread): Parsing macros/materializations/table.sql
2022-01-21 08:34:19.734860 (MainThread): Parsing macros/core.sql
2022-01-21 08:34:19.738590 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-21 08:34:19.740959 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-21 08:34:19.742657 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-21 08:34:19.744074 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-21 08:34:19.745358 (MainThread): Parsing macros/etc/query.sql
2022-01-21 08:34:19.746362 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-21 08:34:19.747885 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-21 08:34:19.749601 (MainThread): Parsing macros/etc/datetime.sql
2022-01-21 08:34:19.758293 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-21 08:34:19.760826 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-21 08:34:19.762773 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-21 08:34:19.764295 (MainThread): Parsing macros/adapters/common.sql
2022-01-21 08:34:19.867002 (MainThread): Parsing macros/materializations/test.sql
2022-01-21 08:34:19.875111 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-21 08:34:19.887757 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-21 08:34:19.896179 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-21 08:34:19.897988 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-21 08:34:19.928601 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-21 08:34:19.946263 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-21 08:34:19.960122 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-21 08:34:19.961904 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-21 08:34:19.972260 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-21 08:34:19.991794 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-21 08:34:19.995706 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-21 08:34:20.002744 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-21 08:34:20.229391 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-21 08:34:20.242865 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TopTags".
2022-01-21 08:34:20.255265 (MainThread): Acquiring new bigquery connection "test.stackoverflow_post.assert_total_notlessthan_zero".
2022-01-21 08:34:20.258046 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-21 08:34:20.280498 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-21 08:34:20.282471 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-21 08:34:20.304963 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f62e8803-a001-4d92-a589-9baff413238a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fe25bb0d0>]}
2022-01-21 08:34:20.309744 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-21 08:34:20.310230 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f62e8803-a001-4d92-a589-9baff413238a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fe25f9400>]}
2022-01-21 08:34:20.310582 (MainThread): Found 2 models, 3 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-01-21 08:34:20.311739 (MainThread): 
2022-01-21 08:34:20.312132 (MainThread): Acquiring new bigquery connection "master".
2022-01-21 08:34:20.313071 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-21 08:34:20.313408 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-01-21 08:34:20.317661 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-21 08:34:23.611528 (MainThread): 08:34:23 | Concurrency: 1 threads (target='dev')
2022-01-21 08:34:23.612494 (MainThread): 08:34:23 | 
2022-01-21 08:34:23.619805 (Thread-1): Began running node test.stackoverflow_post.assert_total_notlessthan_zero
2022-01-21 08:34:23.620813 (Thread-1): 08:34:23 | 1 of 3 START test assert_total_notlessthan_zero...................... [RUN]
2022-01-21 08:34:23.622398 (Thread-1): Acquiring new bigquery connection "test.stackoverflow_post.assert_total_notlessthan_zero".
2022-01-21 08:34:23.623368 (Thread-1): Compiling test.stackoverflow_post.assert_total_notlessthan_zero
2022-01-21 08:34:23.632865 (Thread-1): Writing injected SQL for node "test.stackoverflow_post.assert_total_notlessthan_zero"
2022-01-21 08:34:23.641654 (Thread-1): finished collecting timing info
2022-01-21 08:34:23.679398 (Thread-1): Writing runtime SQL for node "test.stackoverflow_post.assert_total_notlessthan_zero"
2022-01-21 08:34:23.679925 (Thread-1): Opening a new connection, currently in state closed
2022-01-21 08:34:23.684529 (Thread-1): On test.stackoverflow_post.assert_total_notlessthan_zero: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "test.stackoverflow_post.assert_total_notlessthan_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
    splitted_tags,
from `future-enigma-338718`.`dbt_stackoverflow`.`TopTags`)
where tech_count <= 0
      
    ) dbt_internal_test
2022-01-21 08:34:23.687279 (Thread-1): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 31998, 0, 0), raddr=('2a00:1450:4009:81e::200a', 443, 0, 0)>
2022-01-21 08:34:23.687561 (Thread-1): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 38730, 0, 0), raddr=('2a00:1450:4009:815::200a', 443, 0, 0)>
2022-01-21 08:34:27.196053 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got ")" at [12:5]')
2022-01-21 08:34:28.218158 (Thread-1): finished collecting timing info
2022-01-21 08:34:28.221222 (Thread-1): Database Error in test assert_total_notlessthan_zero (tests/assert_total_notlessthan_zero.sql)
  Syntax error: Expected end of input but got ")" at [12:5]
  compiled SQL at target/run/stackoverflow_post/tests/assert_total_notlessthan_zero.sql
Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1447, in result
    do_get_result()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    return retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1437, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/base.py", line 727, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected end of input but got ")" at [12:5]

(job ID: f5858d59-1cad-4543-bdf0-e88bc4c9e099)

                                                                         -----Query Job SQL Follows-----                                                                          

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "test.stackoverflow_post.assert_total_notlessthan_zero"} */
   2:select
   3:      count(*) as failures,
   4:      count(*) != 0 as should_warn,
   5:      count(*) != 0 as should_error
   6:    from (
   7:      select
   8:    splitted_tags,
   9:from `future-enigma-338718`.`dbt_stackoverflow`.`TopTags`)
  10:where tech_count <= 0
  11:      
  12:    ) dbt_internal_test
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/test.py", line 132, in execute
    result = self.execute_test(test, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/test.py", line 102, in execute_test
    macro_func()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 132, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 167, in exception_handler
    self.handle_error(e, message)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in test assert_total_notlessthan_zero (tests/assert_total_notlessthan_zero.sql)
  Syntax error: Expected end of input but got ")" at [12:5]
  compiled SQL at target/run/stackoverflow_post/tests/assert_total_notlessthan_zero.sql
2022-01-21 08:34:28.241519 (Thread-1): 08:34:28 | 1 of 3 ERROR assert_total_notlessthan_zero........................... [ERROR in 4.62s]
2022-01-21 08:34:28.242311 (Thread-1): Finished running node test.stackoverflow_post.assert_total_notlessthan_zero
2022-01-21 08:34:28.243054 (Thread-1): Began running node test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566
2022-01-21 08:34:28.244043 (Thread-1): 08:34:28 | 2 of 3 START test not_null_TopTags_Tag_Key........................... [RUN]
2022-01-21 08:34:28.245168 (Thread-1): Acquiring new bigquery connection "test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566".
2022-01-21 08:34:28.245758 (Thread-1): Compiling test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566
2022-01-21 08:34:28.266695 (Thread-1): Writing injected SQL for node "test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566"
2022-01-21 08:34:28.267220 (Thread-1): finished collecting timing info
2022-01-21 08:34:28.269449 (Thread-1): Writing runtime SQL for node "test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566"
2022-01-21 08:34:28.270169 (Thread-1): Opening a new connection, currently in state closed
2022-01-21 08:34:28.275155 (Thread-1): On test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `future-enigma-338718`.`dbt_stackoverflow`.`TopTags`
where Tag_Key is null



      
    ) dbt_internal_test
2022-01-21 08:34:38.672864 (Thread-1): finished collecting timing info
2022-01-21 08:34:38.674404 (Thread-1): 08:34:38 | 2 of 3 PASS not_null_TopTags_Tag_Key................................. [PASS in 10.43s]
2022-01-21 08:34:38.675239 (Thread-1): Finished running node test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566
2022-01-21 08:34:38.676047 (Thread-1): Began running node test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757
2022-01-21 08:34:38.677469 (Thread-1): 08:34:38 | 3 of 3 START test unique_TopTags_Tag_Key............................. [RUN]
2022-01-21 08:34:38.678803 (Thread-1): Acquiring new bigquery connection "test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757".
2022-01-21 08:34:38.679518 (Thread-1): Compiling test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757
2022-01-21 08:34:38.702587 (Thread-1): Writing injected SQL for node "test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757"
2022-01-21 08:34:38.703447 (Thread-1): finished collecting timing info
2022-01-21 08:34:38.707783 (Thread-1): Writing runtime SQL for node "test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757"
2022-01-21 08:34:38.708378 (Thread-1): Opening a new connection, currently in state closed
2022-01-21 08:34:38.714527 (Thread-1): On test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    Tag_Key as unique_field,
    count(*) as n_records

from `future-enigma-338718`.`dbt_stackoverflow`.`TopTags`
where Tag_Key is not null
group by Tag_Key
having count(*) > 1



      
    ) dbt_internal_test
2022-01-21 08:34:45.085104 (Thread-1): finished collecting timing info
2022-01-21 08:34:45.087462 (Thread-1): 08:34:45 | 3 of 3 PASS unique_TopTags_Tag_Key................................... [PASS in 6.41s]
2022-01-21 08:34:45.088904 (Thread-1): Finished running node test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757
2022-01-21 08:34:45.093585 (MainThread): Acquiring new bigquery connection "master".
2022-01-21 08:34:45.095321 (MainThread): 08:34:45 | 
2022-01-21 08:34:45.096772 (MainThread): 08:34:45 | Finished running 3 tests in 24.78s.
2022-01-21 08:34:45.098043 (MainThread): Connection 'master' was properly closed.
2022-01-21 08:34:45.099236 (MainThread): Connection 'test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757' was properly closed.
2022-01-21 08:34:45.125167 (MainThread): 
2022-01-21 08:34:45.126375 (MainThread): Completed with 1 error and 0 warnings:
2022-01-21 08:34:45.127532 (MainThread): 
2022-01-21 08:34:45.128640 (MainThread): Database Error in test assert_total_notlessthan_zero (tests/assert_total_notlessthan_zero.sql)
2022-01-21 08:34:45.129844 (MainThread):   Syntax error: Expected end of input but got ")" at [12:5]
2022-01-21 08:34:45.130865 (MainThread):   compiled SQL at target/run/stackoverflow_post/tests/assert_total_notlessthan_zero.sql
2022-01-21 08:34:45.131937 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-01-21 08:34:45.133243 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff69badc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fe264eee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fe266ff70>]}
2022-01-21 08:34:45.134605 (MainThread): Flushing usage events
2022-01-21 08:35:05.186927 (MainThread): Running with dbt=0.21.1
2022-01-21 08:35:05.829211 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-21 08:35:05.830132 (MainThread): Tracking: tracking
2022-01-21 08:35:05.856513 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4544f7feb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45592c4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4544fa3040>]}
2022-01-21 08:35:05.867541 (MainThread): Partial parsing not enabled
2022-01-21 08:35:05.875588 (MainThread): Parsing macros/adapters.sql
2022-01-21 08:35:05.898973 (MainThread): Parsing macros/catalog.sql
2022-01-21 08:35:05.906276 (MainThread): Parsing macros/etc.sql
2022-01-21 08:35:05.908342 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-21 08:35:05.910132 (MainThread): Parsing macros/materializations/seed.sql
2022-01-21 08:35:05.912843 (MainThread): Parsing macros/materializations/copy.sql
2022-01-21 08:35:05.915955 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-21 08:35:05.931523 (MainThread): Parsing macros/materializations/view.sql
2022-01-21 08:35:05.934364 (MainThread): Parsing macros/materializations/table.sql
2022-01-21 08:35:05.944310 (MainThread): Parsing macros/core.sql
2022-01-21 08:35:05.948805 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-21 08:35:05.951185 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-21 08:35:05.953146 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-21 08:35:05.954615 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-21 08:35:05.955948 (MainThread): Parsing macros/etc/query.sql
2022-01-21 08:35:05.957077 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-21 08:35:05.958699 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-21 08:35:05.960342 (MainThread): Parsing macros/etc/datetime.sql
2022-01-21 08:35:05.968975 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-21 08:35:05.971425 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-21 08:35:05.973355 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-21 08:35:05.974920 (MainThread): Parsing macros/adapters/common.sql
2022-01-21 08:35:06.077381 (MainThread): Parsing macros/materializations/test.sql
2022-01-21 08:35:06.085596 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-21 08:35:06.097170 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-21 08:35:06.108258 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-21 08:35:06.110304 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-21 08:35:06.140973 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-21 08:35:06.159064 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-21 08:35:06.172763 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-21 08:35:06.174516 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-21 08:35:06.184388 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-21 08:35:06.203635 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-21 08:35:06.207718 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-21 08:35:06.214726 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-21 08:35:06.448101 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-21 08:35:06.462946 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TopTags".
2022-01-21 08:35:06.475378 (MainThread): Acquiring new bigquery connection "test.stackoverflow_post.assert_total_notlessthan_zero".
2022-01-21 08:35:06.478042 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-21 08:35:06.500802 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-21 08:35:06.502722 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-21 08:35:06.526985 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27c9f721-8bb5-49ad-b88a-20f78ac171c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4544eca520>]}
2022-01-21 08:35:06.532027 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-21 08:35:06.532475 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27c9f721-8bb5-49ad-b88a-20f78ac171c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4544edcfa0>]}
2022-01-21 08:35:06.532836 (MainThread): Found 2 models, 3 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-01-21 08:35:06.533940 (MainThread): 
2022-01-21 08:35:06.534328 (MainThread): Acquiring new bigquery connection "master".
2022-01-21 08:35:06.535181 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-21 08:35:06.535556 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-21 08:35:11.950032 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-21 08:35:11.951084 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-21 08:35:11.967620 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-21 08:35:14.815759 (MainThread): 08:35:14 | Concurrency: 1 threads (target='dev')
2022-01-21 08:35:14.816716 (MainThread): 08:35:14 | 
2022-01-21 08:35:14.822699 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-21 08:35:14.823908 (Thread-1): 08:35:14 | 1 of 2 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-21 08:35:14.825321 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-21 08:35:14.826065 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-21 08:35:14.838995 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-21 08:35:14.840248 (Thread-1): finished collecting timing info
2022-01-21 08:35:14.856909 (Thread-1): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 32006, 0, 0), raddr=('2a00:1450:4009:81e::200a', 443, 0, 0)>
2022-01-21 08:35:14.857586 (Thread-1): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 38738, 0, 0), raddr=('2a00:1450:4009:815::200a', 443, 0, 0)>
2022-01-21 08:35:14.858102 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 32008, 0, 0), raddr=('2a00:1450:4009:81e::200a', 443, 0, 0)>
2022-01-21 08:35:14.858566 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 38740, 0, 0), raddr=('2a00:1450:4009:815::200a', 443, 0, 0)>
2022-01-21 08:35:14.874523 (Thread-1): Opening a new connection, currently in state closed
2022-01-21 08:35:14.878844 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-21 08:35:18.648838 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-21 08:35:18.649333 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         creation_date,
         last_activity_date,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-21 08:35:24.994914 (Thread-1): finished collecting timing info
2022-01-21 08:35:24.999101 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27c9f721-8bb5-49ad-b88a-20f78ac171c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4544dbcf40>]}
2022-01-21 08:35:25.001983 (Thread-1): 08:35:24 | 1 of 2 OK created table model dbt_stackoverflow.TrendingTopics....... [CREATE TABLE (4.3k rows, 2.1 GB processed) in 10.17s]
2022-01-21 08:35:25.003565 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-21 08:35:25.007912 (Thread-1): Began running node model.stackoverflow_post.TopTags
2022-01-21 08:35:25.009290 (Thread-1): 08:35:25 | 2 of 2 START table model dbt_stackoverflow.TopTags................... [RUN]
2022-01-21 08:35:25.011741 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TopTags".
2022-01-21 08:35:25.012869 (Thread-1): Compiling model.stackoverflow_post.TopTags
2022-01-21 08:35:25.019229 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TopTags"
2022-01-21 08:35:25.020359 (Thread-1): finished collecting timing info
2022-01-21 08:35:25.024474 (Thread-1): Opening a new connection, currently in state closed
2022-01-21 08:35:25.037073 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-21 08:35:29.150284 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TopTags"
2022-01-21 08:35:29.150765 (Thread-1): On model.stackoverflow_post.TopTags: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TopTags"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TopTags`
  
  
  OPTIONS()
  as (
    SELECT
  ROW_NUMBER() OVER() AS Tag_Key,
  splitted_tags,
  COUNT(*) AS tech_count
FROM (
  SELECT
    SPLIT(tags,'|') AS TechnologyName
  FROM
    `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`)
CROSS JOIN
  UNNEST(TechnologyName) splitted_tags
GROUP BY
  splitted_tags
ORDER BY
  tech_count DESC
  );
    
2022-01-21 08:35:36.477934 (Thread-1): finished collecting timing info
2022-01-21 08:35:36.479011 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27c9f721-8bb5-49ad-b88a-20f78ac171c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4544d95a60>]}
2022-01-21 08:35:36.479934 (Thread-1): 08:35:36 | 2 of 2 OK created table model dbt_stackoverflow.TopTags.............. [CREATE TABLE (3.7k rows, 123.2 KB processed) in 11.47s]
2022-01-21 08:35:36.480409 (Thread-1): Finished running node model.stackoverflow_post.TopTags
2022-01-21 08:35:36.481906 (MainThread): Acquiring new bigquery connection "master".
2022-01-21 08:35:36.482367 (MainThread): 08:35:36 | 
2022-01-21 08:35:36.482657 (MainThread): 08:35:36 | Finished running 2 table models in 29.95s.
2022-01-21 08:35:36.482874 (MainThread): Connection 'master' was properly closed.
2022-01-21 08:35:36.483078 (MainThread): Connection 'model.stackoverflow_post.TopTags' was properly closed.
2022-01-21 08:35:36.490227 (MainThread): 
2022-01-21 08:35:36.490840 (MainThread): Completed successfully
2022-01-21 08:35:36.491336 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-01-21 08:35:36.491723 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45592c4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4544fd7fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4544f7fa90>]}
2022-01-21 08:35:36.492239 (MainThread): Flushing usage events
2022-01-21 08:35:55.015256 (MainThread): Running with dbt=0.21.1
2022-01-21 08:35:55.599853 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=None, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2022-01-21 08:35:55.600850 (MainThread): Tracking: tracking
2022-01-21 08:35:55.625841 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eef47ceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f0374b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eef4aa040>]}
2022-01-21 08:35:55.637354 (MainThread): Partial parsing not enabled
2022-01-21 08:35:55.645511 (MainThread): Parsing macros/adapters.sql
2022-01-21 08:35:55.673103 (MainThread): Parsing macros/catalog.sql
2022-01-21 08:35:55.682335 (MainThread): Parsing macros/etc.sql
2022-01-21 08:35:55.684598 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-21 08:35:55.686765 (MainThread): Parsing macros/materializations/seed.sql
2022-01-21 08:35:55.691472 (MainThread): Parsing macros/materializations/copy.sql
2022-01-21 08:35:55.694542 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-21 08:35:55.714589 (MainThread): Parsing macros/materializations/view.sql
2022-01-21 08:35:55.717697 (MainThread): Parsing macros/materializations/table.sql
2022-01-21 08:35:55.732802 (MainThread): Parsing macros/core.sql
2022-01-21 08:35:55.738887 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-21 08:35:55.741625 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-21 08:35:55.745087 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-21 08:35:55.747218 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-21 08:35:55.748645 (MainThread): Parsing macros/etc/query.sql
2022-01-21 08:35:55.749869 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-21 08:35:55.753193 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-21 08:35:55.755368 (MainThread): Parsing macros/etc/datetime.sql
2022-01-21 08:35:55.769665 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-21 08:35:55.773337 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-21 08:35:55.776203 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-21 08:35:55.779124 (MainThread): Parsing macros/adapters/common.sql
2022-01-21 08:35:55.920287 (MainThread): Parsing macros/materializations/test.sql
2022-01-21 08:35:55.933604 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-21 08:35:55.949096 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-21 08:35:55.962836 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-21 08:35:55.964878 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-21 08:35:56.001485 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-21 08:35:56.021105 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-21 08:35:56.038760 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-21 08:35:56.040903 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-21 08:35:56.052753 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-21 08:35:56.075393 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-21 08:35:56.080443 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-21 08:35:56.088765 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-21 08:35:56.406902 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-21 08:35:56.420549 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TopTags".
2022-01-21 08:35:56.434304 (MainThread): Acquiring new bigquery connection "test.stackoverflow_post.assert_total_notlessthan_zero".
2022-01-21 08:35:56.437180 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-21 08:35:56.461036 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-21 08:35:56.463013 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-21 08:35:56.486617 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c153fa1e-3b85-4b6a-8ce9-3009aaf2bd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eef38d520>]}
2022-01-21 08:35:56.492256 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-21 08:35:56.492801 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c153fa1e-3b85-4b6a-8ce9-3009aaf2bd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eef39ffa0>]}
2022-01-21 08:35:56.493169 (MainThread): Found 2 models, 3 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-01-21 08:35:56.494751 (MainThread): 
2022-01-21 08:35:56.495199 (MainThread): Acquiring new bigquery connection "master".
2022-01-21 08:35:56.496160 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-21 08:35:56.496505 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-01-21 08:35:56.501117 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-21 08:36:02.931277 (MainThread): 08:36:02 | Concurrency: 1 threads (target='dev')
2022-01-21 08:36:02.935435 (MainThread): 08:36:02 | 
2022-01-21 08:36:02.962330 (Thread-1): Began running node test.stackoverflow_post.assert_total_notlessthan_zero
2022-01-21 08:36:02.966698 (Thread-1): 08:36:02 | 1 of 3 START test assert_total_notlessthan_zero...................... [RUN]
2022-01-21 08:36:02.970393 (Thread-1): Acquiring new bigquery connection "test.stackoverflow_post.assert_total_notlessthan_zero".
2022-01-21 08:36:02.972624 (Thread-1): Compiling test.stackoverflow_post.assert_total_notlessthan_zero
2022-01-21 08:36:02.981926 (Thread-1): Writing injected SQL for node "test.stackoverflow_post.assert_total_notlessthan_zero"
2022-01-21 08:36:02.982922 (Thread-1): finished collecting timing info
2022-01-21 08:36:03.028131 (Thread-1): Writing runtime SQL for node "test.stackoverflow_post.assert_total_notlessthan_zero"
2022-01-21 08:36:03.028764 (Thread-1): Opening a new connection, currently in state closed
2022-01-21 08:36:03.034148 (Thread-1): On test.stackoverflow_post.assert_total_notlessthan_zero: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "test.stackoverflow_post.assert_total_notlessthan_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
    splitted_tags
from `future-enigma-338718`.`dbt_stackoverflow`.`TopTags`)
where tech_count <= 0
      
    ) dbt_internal_test
2022-01-21 08:36:03.038334 (Thread-1): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 32014, 0, 0), raddr=('2a00:1450:4009:81e::200a', 443, 0, 0)>
2022-01-21 08:36:03.038867 (Thread-1): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 38746, 0, 0), raddr=('2a00:1450:4009:815::200a', 443, 0, 0)>
2022-01-21 08:36:08.184065 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got ")" at [12:5]')
2022-01-21 08:36:10.027256 (Thread-1): finished collecting timing info
2022-01-21 08:36:10.028759 (Thread-1): Database Error in test assert_total_notlessthan_zero (tests/assert_total_notlessthan_zero.sql)
  Syntax error: Expected end of input but got ")" at [12:5]
  compiled SQL at target/run/stackoverflow_post/tests/assert_total_notlessthan_zero.sql
Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1447, in result
    do_get_result()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    return retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1437, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/base.py", line 727, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected end of input but got ")" at [12:5]

(job ID: 134d4774-b73a-4ffc-bded-6947c390c1d9)

                                                                         -----Query Job SQL Follows-----                                                                          

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "test.stackoverflow_post.assert_total_notlessthan_zero"} */
   2:select
   3:      count(*) as failures,
   4:      count(*) != 0 as should_warn,
   5:      count(*) != 0 as should_error
   6:    from (
   7:      select
   8:    splitted_tags
   9:from `future-enigma-338718`.`dbt_stackoverflow`.`TopTags`)
  10:where tech_count <= 0
  11:      
  12:    ) dbt_internal_test
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/test.py", line 132, in execute
    result = self.execute_test(test, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/test.py", line 102, in execute_test
    macro_func()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 132, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 167, in exception_handler
    self.handle_error(e, message)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in test assert_total_notlessthan_zero (tests/assert_total_notlessthan_zero.sql)
  Syntax error: Expected end of input but got ")" at [12:5]
  compiled SQL at target/run/stackoverflow_post/tests/assert_total_notlessthan_zero.sql
2022-01-21 08:36:10.036623 (Thread-1): 08:36:10 | 1 of 3 ERROR assert_total_notlessthan_zero........................... [ERROR in 7.07s]
2022-01-21 08:36:10.037463 (Thread-1): Finished running node test.stackoverflow_post.assert_total_notlessthan_zero
2022-01-21 08:36:10.038276 (Thread-1): Began running node test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566
2022-01-21 08:36:10.039058 (Thread-1): 08:36:10 | 2 of 3 START test not_null_TopTags_Tag_Key........................... [RUN]
2022-01-21 08:36:10.040286 (Thread-1): Acquiring new bigquery connection "test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566".
2022-01-21 08:36:10.041510 (Thread-1): Compiling test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566
2022-01-21 08:36:10.071874 (Thread-1): Writing injected SQL for node "test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566"
2022-01-21 08:36:10.072448 (Thread-1): finished collecting timing info
2022-01-21 08:36:10.074850 (Thread-1): Writing runtime SQL for node "test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566"
2022-01-21 08:36:10.075387 (Thread-1): Opening a new connection, currently in state closed
2022-01-21 08:36:10.080267 (Thread-1): On test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `future-enigma-338718`.`dbt_stackoverflow`.`TopTags`
where Tag_Key is null



      
    ) dbt_internal_test
2022-01-21 08:36:14.311336 (Thread-1): finished collecting timing info
2022-01-21 08:36:14.312886 (Thread-1): 08:36:14 | 2 of 3 PASS not_null_TopTags_Tag_Key................................. [PASS in 4.27s]
2022-01-21 08:36:14.313702 (Thread-1): Finished running node test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566
2022-01-21 08:36:14.314527 (Thread-1): Began running node test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757
2022-01-21 08:36:14.315572 (Thread-1): 08:36:14 | 3 of 3 START test unique_TopTags_Tag_Key............................. [RUN]
2022-01-21 08:36:14.316819 (Thread-1): Acquiring new bigquery connection "test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757".
2022-01-21 08:36:14.317510 (Thread-1): Compiling test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757
2022-01-21 08:36:14.342348 (Thread-1): Writing injected SQL for node "test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757"
2022-01-21 08:36:14.343052 (Thread-1): finished collecting timing info
2022-01-21 08:36:14.346031 (Thread-1): Writing runtime SQL for node "test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757"
2022-01-21 08:36:14.346602 (Thread-1): Opening a new connection, currently in state closed
2022-01-21 08:36:14.353073 (Thread-1): On test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    Tag_Key as unique_field,
    count(*) as n_records

from `future-enigma-338718`.`dbt_stackoverflow`.`TopTags`
where Tag_Key is not null
group by Tag_Key
having count(*) > 1



      
    ) dbt_internal_test
2022-01-21 08:36:18.724427 (Thread-1): finished collecting timing info
2022-01-21 08:36:18.725955 (Thread-1): 08:36:18 | 3 of 3 PASS unique_TopTags_Tag_Key................................... [PASS in 4.41s]
2022-01-21 08:36:18.726837 (Thread-1): Finished running node test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757
2022-01-21 08:36:18.730197 (MainThread): Acquiring new bigquery connection "master".
2022-01-21 08:36:18.731559 (MainThread): 08:36:18 | 
2022-01-21 08:36:18.732509 (MainThread): 08:36:18 | Finished running 3 tests in 22.24s.
2022-01-21 08:36:18.733286 (MainThread): Connection 'master' was properly closed.
2022-01-21 08:36:18.733952 (MainThread): Connection 'test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757' was properly closed.
2022-01-21 08:36:18.752046 (MainThread): 
2022-01-21 08:36:18.752935 (MainThread): Completed with 1 error and 0 warnings:
2022-01-21 08:36:18.753758 (MainThread): 
2022-01-21 08:36:18.754727 (MainThread): Database Error in test assert_total_notlessthan_zero (tests/assert_total_notlessthan_zero.sql)
2022-01-21 08:36:18.755507 (MainThread):   Syntax error: Expected end of input but got ")" at [12:5]
2022-01-21 08:36:18.756399 (MainThread):   compiled SQL at target/run/stackoverflow_post/tests/assert_total_notlessthan_zero.sql
2022-01-21 08:36:18.757215 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-01-21 08:36:18.758005 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f0374b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eef45d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eef38a5b0>]}
2022-01-21 08:36:18.758942 (MainThread): Flushing usage events
2022-01-21 08:37:00.295952 (MainThread): Running with dbt=0.21.1
2022-01-21 08:37:00.952509 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-21 08:37:00.953785 (MainThread): Tracking: tracking
2022-01-21 08:37:00.996258 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f064d77bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0661aba700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f064d7980d0>]}
2022-01-21 08:37:01.009021 (MainThread): Partial parsing not enabled
2022-01-21 08:37:01.016836 (MainThread): Parsing macros/adapters.sql
2022-01-21 08:37:01.041497 (MainThread): Parsing macros/catalog.sql
2022-01-21 08:37:01.047312 (MainThread): Parsing macros/etc.sql
2022-01-21 08:37:01.049245 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-21 08:37:01.051115 (MainThread): Parsing macros/materializations/seed.sql
2022-01-21 08:37:01.053778 (MainThread): Parsing macros/materializations/copy.sql
2022-01-21 08:37:01.056549 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-21 08:37:01.071047 (MainThread): Parsing macros/materializations/view.sql
2022-01-21 08:37:01.073698 (MainThread): Parsing macros/materializations/table.sql
2022-01-21 08:37:01.083844 (MainThread): Parsing macros/core.sql
2022-01-21 08:37:01.087658 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-21 08:37:01.089922 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-21 08:37:01.091669 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-21 08:37:01.093154 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-21 08:37:01.094373 (MainThread): Parsing macros/etc/query.sql
2022-01-21 08:37:01.095429 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-21 08:37:01.096982 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-21 08:37:01.098554 (MainThread): Parsing macros/etc/datetime.sql
2022-01-21 08:37:01.106978 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-21 08:37:01.109491 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-21 08:37:01.111302 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-21 08:37:01.112856 (MainThread): Parsing macros/adapters/common.sql
2022-01-21 08:37:01.216195 (MainThread): Parsing macros/materializations/test.sql
2022-01-21 08:37:01.224202 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-21 08:37:01.242067 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-21 08:37:01.252663 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-21 08:37:01.254646 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-21 08:37:01.286986 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-21 08:37:01.304378 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-21 08:37:01.318066 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-21 08:37:01.319832 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-21 08:37:01.330054 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-21 08:37:01.349645 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-21 08:37:01.353713 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-21 08:37:01.360698 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-21 08:37:01.591145 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-21 08:37:01.603893 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TopTags".
2022-01-21 08:37:01.617519 (MainThread): Acquiring new bigquery connection "test.stackoverflow_post.assert_total_notlessthan_zero".
2022-01-21 08:37:01.620383 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-21 08:37:01.645847 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-21 08:37:01.647809 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-21 08:37:01.670786 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f665cb08-83fa-4e15-a42c-fddbbb0580ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f064d704160>]}
2022-01-21 08:37:01.675605 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-21 08:37:01.676024 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f665cb08-83fa-4e15-a42c-fddbbb0580ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f064d6fb1c0>]}
2022-01-21 08:37:01.676329 (MainThread): Found 2 models, 3 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-01-21 08:37:01.677454 (MainThread): 
2022-01-21 08:37:01.677847 (MainThread): Acquiring new bigquery connection "master".
2022-01-21 08:37:01.678690 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-21 08:37:01.679063 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-21 08:37:07.555763 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-21 08:37:07.556883 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-21 08:37:07.574212 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-21 08:37:12.169505 (MainThread): 08:37:12 | Concurrency: 1 threads (target='dev')
2022-01-21 08:37:12.170736 (MainThread): 08:37:12 | 
2022-01-21 08:37:12.177620 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-21 08:37:12.178841 (Thread-1): 08:37:12 | 1 of 2 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-21 08:37:12.180161 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-21 08:37:12.180930 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-21 08:37:12.191888 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-21 08:37:12.193146 (Thread-1): finished collecting timing info
2022-01-21 08:37:12.207491 (Thread-1): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 32024, 0, 0), raddr=('2a00:1450:4009:81e::200a', 443, 0, 0)>
2022-01-21 08:37:12.207931 (Thread-1): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 38754, 0, 0), raddr=('2a00:1450:4009:815::200a', 443, 0, 0)>
2022-01-21 08:37:12.208279 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 32026, 0, 0), raddr=('2a00:1450:4009:81e::200a', 443, 0, 0)>
2022-01-21 08:37:12.208655 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 38756, 0, 0), raddr=('2a00:1450:4009:815::200a', 443, 0, 0)>
2022-01-21 08:37:12.223567 (Thread-1): Opening a new connection, currently in state closed
2022-01-21 08:37:12.228056 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-21 08:37:14.671999 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-21 08:37:14.672501 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         creation_date,
         last_activity_date,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-21 08:37:19.141083 (Thread-1): finished collecting timing info
2022-01-21 08:37:19.142728 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f665cb08-83fa-4e15-a42c-fddbbb0580ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f064d5b5fa0>]}
2022-01-21 08:37:19.144122 (Thread-1): 08:37:19 | 1 of 2 OK created table model dbt_stackoverflow.TrendingTopics....... [CREATE TABLE (4.3k rows, 2.1 GB processed) in 6.96s]
2022-01-21 08:37:19.145030 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-21 08:37:19.147432 (Thread-1): Began running node model.stackoverflow_post.TopTags
2022-01-21 08:37:19.148841 (Thread-1): 08:37:19 | 2 of 2 START table model dbt_stackoverflow.TopTags................... [RUN]
2022-01-21 08:37:19.151289 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TopTags".
2022-01-21 08:37:19.152331 (Thread-1): Compiling model.stackoverflow_post.TopTags
2022-01-21 08:37:19.159899 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TopTags"
2022-01-21 08:37:19.161228 (Thread-1): finished collecting timing info
2022-01-21 08:37:19.164905 (Thread-1): Opening a new connection, currently in state closed
2022-01-21 08:37:19.171898 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-21 08:37:27.016231 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TopTags"
2022-01-21 08:37:27.017655 (Thread-1): On model.stackoverflow_post.TopTags: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TopTags"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TopTags`
  
  
  OPTIONS()
  as (
    SELECT
  ROW_NUMBER() OVER() AS Tag_Key,
  splitted_tags,
  COUNT(*) AS tech_count
FROM (
  SELECT
    SPLIT(tags,'|') AS TechnologyName
  FROM
    `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`)
CROSS JOIN
  UNNEST(TechnologyName) splitted_tags
GROUP BY
  splitted_tags
ORDER BY
  tech_count DESC
  );
    
2022-01-21 08:37:32.307127 (Thread-1): finished collecting timing info
2022-01-21 08:37:32.307693 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f665cb08-83fa-4e15-a42c-fddbbb0580ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0663bbaeb0>]}
2022-01-21 08:37:32.308133 (Thread-1): 08:37:32 | 2 of 2 OK created table model dbt_stackoverflow.TopTags.............. [CREATE TABLE (3.7k rows, 123.2 KB processed) in 13.16s]
2022-01-21 08:37:32.308427 (Thread-1): Finished running node model.stackoverflow_post.TopTags
2022-01-21 08:37:32.309994 (MainThread): Acquiring new bigquery connection "master".
2022-01-21 08:37:32.310848 (MainThread): 08:37:32 | 
2022-01-21 08:37:32.311411 (MainThread): 08:37:32 | Finished running 2 table models in 30.63s.
2022-01-21 08:37:32.311971 (MainThread): Connection 'master' was properly closed.
2022-01-21 08:37:32.312488 (MainThread): Connection 'model.stackoverflow_post.TopTags' was properly closed.
2022-01-21 08:37:32.322338 (MainThread): 
2022-01-21 08:37:32.322746 (MainThread): Completed successfully
2022-01-21 08:37:32.323141 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-01-21 08:37:32.323471 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f064d7de4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0661aba700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f064d6fb580>]}
2022-01-21 08:37:32.323826 (MainThread): Flushing usage events
2022-01-21 08:38:51.684479 (MainThread): Running with dbt=0.21.1
2022-01-21 08:38:52.390761 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=None, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2022-01-21 08:38:52.391919 (MainThread): Tracking: tracking
2022-01-21 08:38:52.435406 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f127dc7e8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1269933d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1269933fa0>]}
2022-01-21 08:38:52.453579 (MainThread): Partial parsing not enabled
2022-01-21 08:38:52.461974 (MainThread): Parsing macros/adapters.sql
2022-01-21 08:38:52.488644 (MainThread): Parsing macros/catalog.sql
2022-01-21 08:38:52.495426 (MainThread): Parsing macros/etc.sql
2022-01-21 08:38:52.497775 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-21 08:38:52.499922 (MainThread): Parsing macros/materializations/seed.sql
2022-01-21 08:38:52.503184 (MainThread): Parsing macros/materializations/copy.sql
2022-01-21 08:38:52.506167 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-21 08:38:52.521606 (MainThread): Parsing macros/materializations/view.sql
2022-01-21 08:38:52.524650 (MainThread): Parsing macros/materializations/table.sql
2022-01-21 08:38:52.534349 (MainThread): Parsing macros/core.sql
2022-01-21 08:38:52.538344 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-21 08:38:52.540695 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-21 08:38:52.542421 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-21 08:38:52.544596 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-21 08:38:52.545947 (MainThread): Parsing macros/etc/query.sql
2022-01-21 08:38:52.547413 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-21 08:38:52.550501 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-21 08:38:52.554099 (MainThread): Parsing macros/etc/datetime.sql
2022-01-21 08:38:52.570812 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-21 08:38:52.574095 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-21 08:38:52.576234 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-21 08:38:52.577900 (MainThread): Parsing macros/adapters/common.sql
2022-01-21 08:38:52.694795 (MainThread): Parsing macros/materializations/test.sql
2022-01-21 08:38:52.705209 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-21 08:38:52.720262 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-21 08:38:52.733889 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-21 08:38:52.737223 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-21 08:38:52.797270 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-21 08:38:52.843099 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-21 08:38:52.881799 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-21 08:38:52.889179 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-21 08:38:52.912478 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-21 08:38:52.967616 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-21 08:38:52.978506 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-21 08:38:52.991804 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-21 08:38:53.465761 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-21 08:38:53.482864 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TopTags".
2022-01-21 08:38:53.497111 (MainThread): Acquiring new bigquery connection "test.stackoverflow_post.assert_total_notlessthan_zero".
2022-01-21 08:38:53.500007 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-21 08:38:53.525710 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-21 08:38:53.527982 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-21 08:38:53.552657 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f91fca1-9163-4304-9262-4c6f5e4d700f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f126987f0d0>]}
2022-01-21 08:38:53.557760 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-21 08:38:53.558222 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f91fca1-9163-4304-9262-4c6f5e4d700f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12698bd460>]}
2022-01-21 08:38:53.558569 (MainThread): Found 2 models, 3 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-01-21 08:38:53.560022 (MainThread): 
2022-01-21 08:38:53.560489 (MainThread): Acquiring new bigquery connection "master".
2022-01-21 08:38:53.561381 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-21 08:38:53.561610 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-01-21 08:38:53.567382 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-21 08:38:56.237161 (MainThread): 08:38:56 | Concurrency: 1 threads (target='dev')
2022-01-21 08:38:56.238202 (MainThread): 08:38:56 | 
2022-01-21 08:38:56.245665 (Thread-1): Began running node test.stackoverflow_post.assert_total_notlessthan_zero
2022-01-21 08:38:56.246729 (Thread-1): 08:38:56 | 1 of 3 START test assert_total_notlessthan_zero...................... [RUN]
2022-01-21 08:38:56.248208 (Thread-1): Acquiring new bigquery connection "test.stackoverflow_post.assert_total_notlessthan_zero".
2022-01-21 08:38:56.249270 (Thread-1): Compiling test.stackoverflow_post.assert_total_notlessthan_zero
2022-01-21 08:38:56.258710 (Thread-1): Writing injected SQL for node "test.stackoverflow_post.assert_total_notlessthan_zero"
2022-01-21 08:38:56.259776 (Thread-1): finished collecting timing info
2022-01-21 08:38:56.290459 (Thread-1): Writing runtime SQL for node "test.stackoverflow_post.assert_total_notlessthan_zero"
2022-01-21 08:38:56.290954 (Thread-1): Opening a new connection, currently in state closed
2022-01-21 08:38:56.295751 (Thread-1): On test.stackoverflow_post.assert_total_notlessthan_zero: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "test.stackoverflow_post.assert_total_notlessthan_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
    splitted_tags
from `future-enigma-338718`.`dbt_stackoverflow`.`TopTags`
where tech_count <= 0
      
    ) dbt_internal_test
2022-01-21 08:38:56.298676 (Thread-1): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 32032, 0, 0), raddr=('2a00:1450:4009:81e::200a', 443, 0, 0)>
2022-01-21 08:38:56.298991 (Thread-1): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 38764, 0, 0), raddr=('2a00:1450:4009:815::200a', 443, 0, 0)>
2022-01-21 08:39:01.422636 (Thread-1): finished collecting timing info
2022-01-21 08:39:01.424215 (Thread-1): 08:39:01 | 1 of 3 PASS assert_total_notlessthan_zero............................ [PASS in 5.18s]
2022-01-21 08:39:01.425322 (Thread-1): Finished running node test.stackoverflow_post.assert_total_notlessthan_zero
2022-01-21 08:39:01.426043 (Thread-1): Began running node test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566
2022-01-21 08:39:01.426940 (Thread-1): 08:39:01 | 2 of 3 START test not_null_TopTags_Tag_Key........................... [RUN]
2022-01-21 08:39:01.428079 (Thread-1): Acquiring new bigquery connection "test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566".
2022-01-21 08:39:01.428715 (Thread-1): Compiling test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566
2022-01-21 08:39:01.464348 (Thread-1): Writing injected SQL for node "test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566"
2022-01-21 08:39:01.464931 (Thread-1): finished collecting timing info
2022-01-21 08:39:01.467425 (Thread-1): Writing runtime SQL for node "test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566"
2022-01-21 08:39:01.467979 (Thread-1): Opening a new connection, currently in state closed
2022-01-21 08:39:01.475709 (Thread-1): On test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `future-enigma-338718`.`dbt_stackoverflow`.`TopTags`
where Tag_Key is null



      
    ) dbt_internal_test
2022-01-21 08:39:06.449130 (Thread-1): finished collecting timing info
2022-01-21 08:39:06.451550 (Thread-1): 08:39:06 | 2 of 3 PASS not_null_TopTags_Tag_Key................................. [PASS in 5.02s]
2022-01-21 08:39:06.452997 (Thread-1): Finished running node test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566
2022-01-21 08:39:06.454514 (Thread-1): Began running node test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757
2022-01-21 08:39:06.456161 (Thread-1): 08:39:06 | 3 of 3 START test unique_TopTags_Tag_Key............................. [RUN]
2022-01-21 08:39:06.458215 (Thread-1): Acquiring new bigquery connection "test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757".
2022-01-21 08:39:06.459360 (Thread-1): Compiling test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757
2022-01-21 08:39:06.482151 (Thread-1): Writing injected SQL for node "test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757"
2022-01-21 08:39:06.482718 (Thread-1): finished collecting timing info
2022-01-21 08:39:06.485280 (Thread-1): Writing runtime SQL for node "test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757"
2022-01-21 08:39:06.485843 (Thread-1): Opening a new connection, currently in state closed
2022-01-21 08:39:06.491569 (Thread-1): On test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    Tag_Key as unique_field,
    count(*) as n_records

from `future-enigma-338718`.`dbt_stackoverflow`.`TopTags`
where Tag_Key is not null
group by Tag_Key
having count(*) > 1



      
    ) dbt_internal_test
2022-01-21 08:39:12.589496 (Thread-1): finished collecting timing info
2022-01-21 08:39:12.591098 (Thread-1): 08:39:12 | 3 of 3 PASS unique_TopTags_Tag_Key................................... [PASS in 6.13s]
2022-01-21 08:39:12.592055 (Thread-1): Finished running node test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757
2022-01-21 08:39:12.595894 (MainThread): Acquiring new bigquery connection "master".
2022-01-21 08:39:12.597649 (MainThread): 08:39:12 | 
2022-01-21 08:39:12.598443 (MainThread): 08:39:12 | Finished running 3 tests in 19.04s.
2022-01-21 08:39:12.599225 (MainThread): Connection 'master' was properly closed.
2022-01-21 08:39:12.599888 (MainThread): Connection 'test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757' was properly closed.
2022-01-21 08:39:12.603458 (MainThread): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 32038, 0, 0), raddr=('2a00:1450:4009:81e::200a', 443, 0, 0)>
2022-01-21 08:39:12.604576 (MainThread): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:926e:88d:cf2d:3fa3', 38770, 0, 0), raddr=('2a00:1450:4009:815::200a', 443, 0, 0)>
2022-01-21 08:39:12.622416 (MainThread): 
2022-01-21 08:39:12.622885 (MainThread): Completed successfully
2022-01-21 08:39:12.623428 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-01-21 08:39:12.624006 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f127dc7e8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1268ee2d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1269933fa0>]}
2022-01-21 08:39:12.624551 (MainThread): Flushing usage events
2022-01-23 11:19:26.708522 (MainThread): Running with dbt=0.21.1
2022-01-23 11:19:27.709921 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-23 11:19:27.711224 (MainThread): Tracking: tracking
2022-01-23 11:19:27.752887 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe25bebdac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe247bf5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe247bf5cd0>]}
2022-01-23 11:19:27.764093 (MainThread): Partial parsing not enabled
2022-01-23 11:19:27.780097 (MainThread): Parsing macros/adapters.sql
2022-01-23 11:19:27.805592 (MainThread): Parsing macros/catalog.sql
2022-01-23 11:19:27.811916 (MainThread): Parsing macros/etc.sql
2022-01-23 11:19:27.813874 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-23 11:19:27.815574 (MainThread): Parsing macros/materializations/seed.sql
2022-01-23 11:19:27.818573 (MainThread): Parsing macros/materializations/copy.sql
2022-01-23 11:19:27.821551 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-23 11:19:27.836896 (MainThread): Parsing macros/materializations/view.sql
2022-01-23 11:19:27.839526 (MainThread): Parsing macros/materializations/table.sql
2022-01-23 11:19:27.849268 (MainThread): Parsing macros/core.sql
2022-01-23 11:19:27.853415 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-23 11:19:27.855763 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-23 11:19:27.857527 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-23 11:19:27.859003 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-23 11:19:27.860440 (MainThread): Parsing macros/etc/query.sql
2022-01-23 11:19:27.861512 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-23 11:19:27.863073 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-23 11:19:27.864688 (MainThread): Parsing macros/etc/datetime.sql
2022-01-23 11:19:27.873234 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-23 11:19:27.875760 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-23 11:19:27.877879 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-23 11:19:27.879479 (MainThread): Parsing macros/adapters/common.sql
2022-01-23 11:19:27.986137 (MainThread): Parsing macros/materializations/test.sql
2022-01-23 11:19:27.994540 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-23 11:19:28.007784 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-23 11:19:28.017201 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-23 11:19:28.019375 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-23 11:19:28.052660 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-23 11:19:28.071168 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-23 11:19:28.086095 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-23 11:19:28.088010 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-23 11:19:28.098602 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-23 11:19:28.120187 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-23 11:19:28.124280 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-23 11:19:28.131452 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-23 11:19:28.358973 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.Post_Type".
2022-01-23 11:19:28.371387 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-23 11:19:28.384644 (MainThread): 1699: statically parsed stack_models/Post_Owners.sql
2022-01-23 11:19:28.396243 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.Post_Owners".
2022-01-23 11:19:28.400299 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'f23d730c-af18-4689-88f6-161f3ab66b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe247b0d460>]}
2022-01-23 11:19:28.412328 (MainThread): Acquiring new bigquery connection "test.stackoverflow_post.assert_total_notlessthan_zero".
2022-01-23 11:19:28.415210 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:19:28.440026 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:19:28.441885 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:19:28.450127 (MainThread): [WARNING]: Test 'test.stackoverflow_post.assert_total_notlessthan_zero' (tests/assert_total_notlessthan_zero.sql) depends on a node named 'TopTags' which was not found
2022-01-23 11:19:28.450435 (MainThread): [WARNING]: Test 'test.stackoverflow_post.unique_TopTags_Tag_Key.918184c757' (models/stack_models/schema.yml) depends on a node named 'TopTags' which was not found
2022-01-23 11:19:28.450680 (MainThread): [WARNING]: Test 'test.stackoverflow_post.not_null_TopTags_Tag_Key.918b642566' (models/stack_models/schema.yml) depends on a node named 'TopTags' which was not found
2022-01-23 11:19:28.464894 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f23d730c-af18-4689-88f6-161f3ab66b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2478a06d0>]}
2022-01-23 11:19:28.470141 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-23 11:19:28.470651 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f23d730c-af18-4689-88f6-161f3ab66b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2478a0610>]}
2022-01-23 11:19:28.471040 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-01-23 11:19:28.472265 (MainThread): 
2022-01-23 11:19:28.472699 (MainThread): Acquiring new bigquery connection "master".
2022-01-23 11:19:28.473670 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-23 11:19:28.473924 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-23 11:19:29.308645 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-23 11:19:29.310276 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-23 11:19:29.329821 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-23 11:19:29.921170 (MainThread): 11:19:29 | Concurrency: 1 threads (target='dev')
2022-01-23 11:19:29.922213 (MainThread): 11:19:29 | 
2022-01-23 11:19:29.936963 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-23 11:19:29.938437 (Thread-1): 11:19:29 | 1 of 3 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-23 11:19:29.940293 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-23 11:19:29.941192 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-23 11:19:29.955599 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-23 11:19:29.957848 (Thread-1): finished collecting timing info
2022-01-23 11:19:29.989206 (Thread-1): Opening a new connection, currently in state closed
2022-01-23 11:19:29.994237 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-23 11:19:30.589077 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-23 11:19:30.589576 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         creation_date,
         last_activity_date,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-23 11:19:34.792609 (Thread-1): finished collecting timing info
2022-01-23 11:19:34.794606 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f23d730c-af18-4689-88f6-161f3ab66b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe246f96c10>]}
2022-01-23 11:19:34.795971 (Thread-1): 11:19:34 | 1 of 3 OK created table model dbt_stackoverflow.TrendingTopics....... [CREATE TABLE (4.3k rows, 2.1 GB processed) in 4.85s]
2022-01-23 11:19:34.797183 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-23 11:19:34.800375 (Thread-1): Began running node model.stackoverflow_post.Post_Owners
2022-01-23 11:19:34.801681 (Thread-1): 11:19:34 | 2 of 3 START table model dbt_stackoverflow.Post_Owners............... [RUN]
2022-01-23 11:19:34.802840 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.Post_Owners".
2022-01-23 11:19:34.803338 (Thread-1): Compiling model.stackoverflow_post.Post_Owners
2022-01-23 11:19:34.808031 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.Post_Owners"
2022-01-23 11:19:34.808951 (Thread-1): finished collecting timing info
2022-01-23 11:19:34.813584 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.Post_Owners"
2022-01-23 11:19:34.814139 (Thread-1): Opening a new connection, currently in state closed
2022-01-23 11:19:34.820222 (Thread-1): On model.stackoverflow_post.Post_Owners: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Owners"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Owners`
  
  
  OPTIONS()
  as (
    SELECT 
     owner_display_name,
     owner_user_id,
     count(*) as user_cnt
FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
group by 1,2
  );
    
2022-01-23 11:19:36.402470 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: owner_display_name at [10:6]')
2022-01-23 11:19:38.007783 (Thread-1): finished collecting timing info
2022-01-23 11:19:38.010653 (Thread-1): Database Error in model Post_Owners (models/stack_models/Post_Owners.sql)
  Unrecognized name: owner_display_name at [10:6]
  compiled SQL at target/run/stackoverflow_post/models/stack_models/Post_Owners.sql
Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1447, in result
    do_get_result()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    return retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1437, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/base.py", line 727, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Unrecognized name: owner_display_name at [10:6]

(job ID: 749e1a13-8184-4035-b118-92c19e023742)

                                                                 -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Owners"} */
   2:
   3:
   4:  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Owners`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    SELECT 
  10:     owner_display_name,
  11:     owner_user_id,
  12:     count(*) as user_cnt
  13:FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  14:group by 1,2
  15:  );
  16:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 167, in exception_handler
    self.handle_error(e, message)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model Post_Owners (models/stack_models/Post_Owners.sql)
  Unrecognized name: owner_display_name at [10:6]
  compiled SQL at target/run/stackoverflow_post/models/stack_models/Post_Owners.sql
2022-01-23 11:19:38.030220 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f23d730c-af18-4689-88f6-161f3ab66b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe245763dc0>]}
2022-01-23 11:19:38.031802 (Thread-1): 11:19:38 | 2 of 3 ERROR creating table model dbt_stackoverflow.Post_Owners...... [ERROR in 3.23s]
2022-01-23 11:19:38.032765 (Thread-1): Finished running node model.stackoverflow_post.Post_Owners
2022-01-23 11:19:38.033666 (Thread-1): Began running node model.stackoverflow_post.Post_Type
2022-01-23 11:19:38.035200 (Thread-1): 11:19:38 | 3 of 3 START table model dbt_stackoverflow.Post_Type................. [RUN]
2022-01-23 11:19:38.036541 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.Post_Type".
2022-01-23 11:19:38.037259 (Thread-1): Compiling model.stackoverflow_post.Post_Type
2022-01-23 11:19:38.045998 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.Post_Type"
2022-01-23 11:19:38.047114 (Thread-1): finished collecting timing info
2022-01-23 11:19:38.052094 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.Post_Type"
2022-01-23 11:19:38.052787 (Thread-1): Opening a new connection, currently in state closed
2022-01-23 11:19:38.060567 (Thread-1): On model.stackoverflow_post.Post_Type: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Type"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Type`
  
  
  OPTIONS()
  as (
    SELECT 
    post_type_id,
    count(*) as post_cnt
FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
group by 1
  );
    
2022-01-23 11:19:39.344527 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: post_type_id at [10:5]')
2022-01-23 11:19:42.820980 (Thread-1): finished collecting timing info
2022-01-23 11:19:42.822605 (Thread-1): Database Error in model Post_Type (models/stack_models/Post_Type.sql)
  Unrecognized name: post_type_id at [10:5]
  compiled SQL at target/run/stackoverflow_post/models/stack_models/Post_Type.sql
Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1447, in result
    do_get_result()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    return retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1437, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/base.py", line 727, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Unrecognized name: post_type_id at [10:5]

(job ID: 9281dbbb-d9bd-44c0-8292-b17688152bd2)

                                                                -----Query Job SQL Follows-----                                                                

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Type"} */
   2:
   3:
   4:  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Type`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    SELECT 
  10:    post_type_id,
  11:    count(*) as post_cnt
  12:FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  13:group by 1
  14:  );
  15:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 167, in exception_handler
    self.handle_error(e, message)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model Post_Type (models/stack_models/Post_Type.sql)
  Unrecognized name: post_type_id at [10:5]
  compiled SQL at target/run/stackoverflow_post/models/stack_models/Post_Type.sql
2022-01-23 11:19:42.830098 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f23d730c-af18-4689-88f6-161f3ab66b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2456541c0>]}
2022-01-23 11:19:42.831746 (Thread-1): 11:19:42 | 3 of 3 ERROR creating table model dbt_stackoverflow.Post_Type........ [ERROR in 4.79s]
2022-01-23 11:19:42.833468 (Thread-1): Finished running node model.stackoverflow_post.Post_Type
2022-01-23 11:19:42.838373 (MainThread): Acquiring new bigquery connection "master".
2022-01-23 11:19:42.840075 (MainThread): 11:19:42 | 
2022-01-23 11:19:42.841544 (MainThread): 11:19:42 | Finished running 3 table models in 14.37s.
2022-01-23 11:19:42.842312 (MainThread): Connection 'master' was properly closed.
2022-01-23 11:19:42.842953 (MainThread): Connection 'model.stackoverflow_post.Post_Type' was properly closed.
2022-01-23 11:19:42.853442 (MainThread): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 58722, 0, 0), raddr=('2a00:1450:4009:81d::200a', 443, 0, 0)>
2022-01-23 11:19:42.854845 (MainThread): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 58724, 0, 0), raddr=('2a00:1450:4009:81d::200a', 443, 0, 0)>
2022-01-23 11:19:42.855799 (MainThread): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 58728, 0, 0), raddr=('2a00:1450:4009:81d::200a', 443, 0, 0)>
2022-01-23 11:19:42.856537 (MainThread): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 58730, 0, 0), raddr=('2a00:1450:4009:81d::200a', 443, 0, 0)>
2022-01-23 11:19:42.857414 (MainThread): unclosed <ssl.SSLSocket fd=14, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 58732, 0, 0), raddr=('2a00:1450:4009:81d::200a', 443, 0, 0)>
2022-01-23 11:19:42.857944 (MainThread): unclosed <ssl.SSLSocket fd=15, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 58734, 0, 0), raddr=('2a00:1450:4009:81d::200a', 443, 0, 0)>
2022-01-23 11:19:42.864802 (MainThread): 
2022-01-23 11:19:42.865242 (MainThread): Completed with 2 errors and 0 warnings:
2022-01-23 11:19:42.865589 (MainThread): 
2022-01-23 11:19:42.866033 (MainThread): Database Error in model Post_Owners (models/stack_models/Post_Owners.sql)
2022-01-23 11:19:42.866342 (MainThread):   Unrecognized name: owner_display_name at [10:6]
2022-01-23 11:19:42.866613 (MainThread):   compiled SQL at target/run/stackoverflow_post/models/stack_models/Post_Owners.sql
2022-01-23 11:19:42.866901 (MainThread): 
2022-01-23 11:19:42.867181 (MainThread): Database Error in model Post_Type (models/stack_models/Post_Type.sql)
2022-01-23 11:19:42.867443 (MainThread):   Unrecognized name: post_type_id at [10:5]
2022-01-23 11:19:42.867693 (MainThread):   compiled SQL at target/run/stackoverflow_post/models/stack_models/Post_Type.sql
2022-01-23 11:19:42.868068 (MainThread): 
Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
2022-01-23 11:19:42.868568 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe245701250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24565b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24565be20>]}
2022-01-23 11:19:42.868981 (MainThread): Flushing usage events
2022-01-23 11:27:05.935960 (MainThread): Running with dbt=0.21.1
2022-01-23 11:27:06.484895 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-23 11:27:06.485818 (MainThread): Tracking: tracking
2022-01-23 11:27:06.510422 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f210f577ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20fb229d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20fb229a90>]}
2022-01-23 11:27:06.521562 (MainThread): Partial parsing not enabled
2022-01-23 11:27:06.529820 (MainThread): Parsing macros/adapters.sql
2022-01-23 11:27:06.553288 (MainThread): Parsing macros/catalog.sql
2022-01-23 11:27:06.558959 (MainThread): Parsing macros/etc.sql
2022-01-23 11:27:06.560932 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-23 11:27:06.562608 (MainThread): Parsing macros/materializations/seed.sql
2022-01-23 11:27:06.565164 (MainThread): Parsing macros/materializations/copy.sql
2022-01-23 11:27:06.567863 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-23 11:27:06.583106 (MainThread): Parsing macros/materializations/view.sql
2022-01-23 11:27:06.585805 (MainThread): Parsing macros/materializations/table.sql
2022-01-23 11:27:06.595056 (MainThread): Parsing macros/core.sql
2022-01-23 11:27:06.598715 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-23 11:27:06.601048 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-23 11:27:06.602719 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-23 11:27:06.604132 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-23 11:27:06.605381 (MainThread): Parsing macros/etc/query.sql
2022-01-23 11:27:06.606487 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-23 11:27:06.608034 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-23 11:27:06.609613 (MainThread): Parsing macros/etc/datetime.sql
2022-01-23 11:27:06.618470 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-23 11:27:06.620988 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-23 11:27:06.622813 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-23 11:27:06.624435 (MainThread): Parsing macros/adapters/common.sql
2022-01-23 11:27:06.727125 (MainThread): Parsing macros/materializations/test.sql
2022-01-23 11:27:06.734821 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-23 11:27:06.745041 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-23 11:27:06.752363 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-23 11:27:06.754024 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-23 11:27:06.784937 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-23 11:27:06.801863 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-23 11:27:06.816141 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-23 11:27:06.817974 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-23 11:27:06.827835 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-23 11:27:06.847397 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-23 11:27:06.851238 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-23 11:27:06.858473 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-23 11:27:07.076179 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.Post_Type".
2022-01-23 11:27:07.088611 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-23 11:27:07.092811 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.Post_Owners".
2022-01-23 11:27:07.104834 (MainThread): Acquiring new bigquery connection "test.stackoverflow_post.assert_total_notlessthan_zero".
2022-01-23 11:27:07.107457 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:27:07.130981 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:27:07.132888 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:27:07.134653 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:27:07.136649 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:27:07.144561 (MainThread): [WARNING]: Test 'test.stackoverflow_post.assert_total_notlessthan_zero' (tests/assert_total_notlessthan_zero.sql) depends on a node named 'TopTags' which was not found
2022-01-23 11:27:07.158447 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72d13720-1aec-4f09-ab4f-c63d2239905f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20fb1ffac0>]}
2022-01-23 11:27:07.164240 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-23 11:27:07.164747 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72d13720-1aec-4f09-ab4f-c63d2239905f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20fb1ffeb0>]}
2022-01-23 11:27:07.165090 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-01-23 11:27:07.166438 (MainThread): 
2022-01-23 11:27:07.166836 (MainThread): Acquiring new bigquery connection "master".
2022-01-23 11:27:07.167716 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-23 11:27:07.168475 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-23 11:27:07.821878 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-23 11:27:07.822935 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-23 11:27:07.830467 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-23 11:27:07.830867 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 55986, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2022-01-23 11:27:07.831124 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 58740, 0, 0), raddr=('2a00:1450:4009:81d::200a', 443, 0, 0)>
2022-01-23 11:27:08.386428 (MainThread): 11:27:08 | Concurrency: 1 threads (target='dev')
2022-01-23 11:27:08.387368 (MainThread): 11:27:08 | 
2022-01-23 11:27:08.391937 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-23 11:27:08.392359 (Thread-1): 11:27:08 | 1 of 3 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-23 11:27:08.393016 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-23 11:27:08.393301 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-23 11:27:08.397032 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-23 11:27:08.397529 (Thread-1): finished collecting timing info
2022-01-23 11:27:08.428924 (Thread-1): Opening a new connection, currently in state closed
2022-01-23 11:27:08.434280 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-23 11:27:09.110616 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-23 11:27:09.111109 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         owner_display_name,
         owner_user_id,
         post_type_id,
         creation_date,
         last_activity_date,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-23 11:27:12.483476 (Thread-1): finished collecting timing info
2022-01-23 11:27:12.484636 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72d13720-1aec-4f09-ab4f-c63d2239905f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20fb048370>]}
2022-01-23 11:27:12.485558 (Thread-1): 11:27:12 | 1 of 3 OK created table model dbt_stackoverflow.TrendingTopics....... [CREATE TABLE (4.3k rows, 2.6 GB processed) in 4.09s]
2022-01-23 11:27:12.486101 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-23 11:27:12.487794 (Thread-1): Began running node model.stackoverflow_post.Post_Owners
2022-01-23 11:27:12.488492 (Thread-1): 11:27:12 | 2 of 3 START table model dbt_stackoverflow.Post_Owners............... [RUN]
2022-01-23 11:27:12.489111 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.Post_Owners".
2022-01-23 11:27:12.489465 (Thread-1): Compiling model.stackoverflow_post.Post_Owners
2022-01-23 11:27:12.493318 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.Post_Owners"
2022-01-23 11:27:12.493850 (Thread-1): finished collecting timing info
2022-01-23 11:27:12.497016 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.Post_Owners"
2022-01-23 11:27:12.497629 (Thread-1): Opening a new connection, currently in state closed
2022-01-23 11:27:12.503870 (Thread-1): On model.stackoverflow_post.Post_Owners: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Owners"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Owners`
  
  
  OPTIONS()
  as (
    SELECT ROW_NUMBER() OVER() AS owner_tbl_key,
     owner_display_name,
     owner_user_id,
     count(*) as user_cnt
FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
group by 1,2
  );
    
2022-01-23 11:27:13.795949 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Column 1 contains an analytic function, which is not allowed in GROUP BY at [14:10]')
2022-01-23 11:27:15.030284 (Thread-1): finished collecting timing info
2022-01-23 11:27:15.034653 (Thread-1): Database Error in model Post_Owners (models/stack_models/Post_Owners.sql)
  Column 1 contains an analytic function, which is not allowed in GROUP BY at [14:10]
  compiled SQL at target/run/stackoverflow_post/models/stack_models/Post_Owners.sql
Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1447, in result
    do_get_result()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    return retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1437, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/base.py", line 727, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Column 1 contains an analytic function, which is not allowed in GROUP BY at [14:10]

(job ID: 413edb65-a7df-4480-8eca-417c7a26eea6)

                                                                 -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Owners"} */
   2:
   3:
   4:  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Owners`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    SELECT ROW_NUMBER() OVER() AS owner_tbl_key,
  10:     owner_display_name,
  11:     owner_user_id,
  12:     count(*) as user_cnt
  13:FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  14:group by 1,2
  15:  );
  16:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 167, in exception_handler
    self.handle_error(e, message)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model Post_Owners (models/stack_models/Post_Owners.sql)
  Column 1 contains an analytic function, which is not allowed in GROUP BY at [14:10]
  compiled SQL at target/run/stackoverflow_post/models/stack_models/Post_Owners.sql
2022-01-23 11:27:15.046151 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72d13720-1aec-4f09-ab4f-c63d2239905f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20fb071730>]}
2022-01-23 11:27:15.048305 (Thread-1): 11:27:15 | 2 of 3 ERROR creating table model dbt_stackoverflow.Post_Owners...... [ERROR in 2.56s]
2022-01-23 11:27:15.049497 (Thread-1): Finished running node model.stackoverflow_post.Post_Owners
2022-01-23 11:27:15.050109 (Thread-1): Began running node model.stackoverflow_post.Post_Type
2022-01-23 11:27:15.051179 (Thread-1): 11:27:15 | 3 of 3 START table model dbt_stackoverflow.Post_Type................. [RUN]
2022-01-23 11:27:15.053134 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.Post_Type".
2022-01-23 11:27:15.053853 (Thread-1): Compiling model.stackoverflow_post.Post_Type
2022-01-23 11:27:15.060129 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.Post_Type"
2022-01-23 11:27:15.060991 (Thread-1): finished collecting timing info
2022-01-23 11:27:15.066529 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.Post_Type"
2022-01-23 11:27:15.067337 (Thread-1): Opening a new connection, currently in state closed
2022-01-23 11:27:15.074680 (Thread-1): On model.stackoverflow_post.Post_Type: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Type"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Type`
  
  
  OPTIONS()
  as (
    SELECT 
    ROW_NUMBER() OVER() AS post_tbl_key,
    post_type_id,
    count(*) as post_cnt
FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
group by 1
  );
    
2022-01-23 11:27:16.461919 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Column 1 contains an analytic function, which is not allowed in GROUP BY at [14:10]')
2022-01-23 11:27:17.587584 (Thread-1): finished collecting timing info
2022-01-23 11:27:17.589831 (Thread-1): Database Error in model Post_Type (models/stack_models/Post_Type.sql)
  Column 1 contains an analytic function, which is not allowed in GROUP BY at [14:10]
  compiled SQL at target/run/stackoverflow_post/models/stack_models/Post_Type.sql
Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1447, in result
    do_get_result()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    return retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1437, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/base.py", line 727, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Column 1 contains an analytic function, which is not allowed in GROUP BY at [14:10]

(job ID: 9eb8b0e1-23aa-4bca-9eeb-28abddef18e7)

                                                                -----Query Job SQL Follows-----                                                                

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Type"} */
   2:
   3:
   4:  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Type`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    SELECT 
  10:    ROW_NUMBER() OVER() AS post_tbl_key,
  11:    post_type_id,
  12:    count(*) as post_cnt
  13:FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  14:group by 1
  15:  );
  16:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 167, in exception_handler
    self.handle_error(e, message)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model Post_Type (models/stack_models/Post_Type.sql)
  Column 1 contains an analytic function, which is not allowed in GROUP BY at [14:10]
  compiled SQL at target/run/stackoverflow_post/models/stack_models/Post_Type.sql
2022-01-23 11:27:17.592725 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72d13720-1aec-4f09-ab4f-c63d2239905f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20fb1cbac0>]}
2022-01-23 11:27:17.594492 (Thread-1): 11:27:17 | 3 of 3 ERROR creating table model dbt_stackoverflow.Post_Type........ [ERROR in 2.54s]
2022-01-23 11:27:17.595561 (Thread-1): Finished running node model.stackoverflow_post.Post_Type
2022-01-23 11:27:17.600310 (MainThread): Acquiring new bigquery connection "master".
2022-01-23 11:27:17.602115 (MainThread): 11:27:17 | 
2022-01-23 11:27:17.603172 (MainThread): 11:27:17 | Finished running 3 table models in 10.44s.
2022-01-23 11:27:17.604190 (MainThread): Connection 'master' was properly closed.
2022-01-23 11:27:17.605005 (MainThread): Connection 'model.stackoverflow_post.Post_Type' was properly closed.
2022-01-23 11:27:17.617270 (MainThread): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 55988, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2022-01-23 11:27:17.618639 (MainThread): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 58744, 0, 0), raddr=('2a00:1450:4009:81d::200a', 443, 0, 0)>
2022-01-23 11:27:17.619848 (MainThread): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 55990, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2022-01-23 11:27:17.620902 (MainThread): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 58746, 0, 0), raddr=('2a00:1450:4009:81d::200a', 443, 0, 0)>
2022-01-23 11:27:17.622192 (MainThread): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 55992, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2022-01-23 11:27:17.623720 (MainThread): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 58748, 0, 0), raddr=('2a00:1450:4009:81d::200a', 443, 0, 0)>
2022-01-23 11:27:17.642565 (MainThread): 
2022-01-23 11:27:17.643743 (MainThread): Completed with 2 errors and 0 warnings:
2022-01-23 11:27:17.644901 (MainThread): 
2022-01-23 11:27:17.646000 (MainThread): Database Error in model Post_Owners (models/stack_models/Post_Owners.sql)
2022-01-23 11:27:17.646991 (MainThread):   Column 1 contains an analytic function, which is not allowed in GROUP BY at [14:10]
2022-01-23 11:27:17.648000 (MainThread):   compiled SQL at target/run/stackoverflow_post/models/stack_models/Post_Owners.sql
2022-01-23 11:27:17.649075 (MainThread): 
2022-01-23 11:27:17.650047 (MainThread): Database Error in model Post_Type (models/stack_models/Post_Type.sql)
2022-01-23 11:27:17.650629 (MainThread):   Column 1 contains an analytic function, which is not allowed in GROUP BY at [14:10]
2022-01-23 11:27:17.651194 (MainThread):   compiled SQL at target/run/stackoverflow_post/models/stack_models/Post_Type.sql
2022-01-23 11:27:17.651981 (MainThread): 
Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
2022-01-23 11:27:17.652869 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20fb1cbac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20fa8340a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20fa834ee0>]}
2022-01-23 11:27:17.654222 (MainThread): Flushing usage events
2022-01-23 11:33:47.116736 (MainThread): Running with dbt=0.21.1
2022-01-23 11:33:47.782589 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-23 11:33:47.783540 (MainThread): Tracking: tracking
2022-01-23 11:33:47.812045 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1af32988e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1adef4ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1adef4dfa0>]}
2022-01-23 11:33:47.827113 (MainThread): Partial parsing not enabled
2022-01-23 11:33:47.838997 (MainThread): Parsing macros/adapters.sql
2022-01-23 11:33:47.869588 (MainThread): Parsing macros/catalog.sql
2022-01-23 11:33:47.877866 (MainThread): Parsing macros/etc.sql
2022-01-23 11:33:47.880150 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-23 11:33:47.881986 (MainThread): Parsing macros/materializations/seed.sql
2022-01-23 11:33:47.884922 (MainThread): Parsing macros/materializations/copy.sql
2022-01-23 11:33:47.889002 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-23 11:33:47.905861 (MainThread): Parsing macros/materializations/view.sql
2022-01-23 11:33:47.909681 (MainThread): Parsing macros/materializations/table.sql
2022-01-23 11:33:47.919515 (MainThread): Parsing macros/core.sql
2022-01-23 11:33:47.924960 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-23 11:33:47.927640 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-23 11:33:47.929641 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-23 11:33:47.931106 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-23 11:33:47.932588 (MainThread): Parsing macros/etc/query.sql
2022-01-23 11:33:47.933737 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-23 11:33:47.935300 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-23 11:33:47.937966 (MainThread): Parsing macros/etc/datetime.sql
2022-01-23 11:33:47.948869 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-23 11:33:47.951474 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-23 11:33:47.954336 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-23 11:33:47.956968 (MainThread): Parsing macros/adapters/common.sql
2022-01-23 11:33:48.094236 (MainThread): Parsing macros/materializations/test.sql
2022-01-23 11:33:48.104802 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-23 11:33:48.124882 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-23 11:33:48.141106 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-23 11:33:48.144449 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-23 11:33:48.192108 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-23 11:33:48.215620 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-23 11:33:48.233987 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-23 11:33:48.236268 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-23 11:33:48.249107 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-23 11:33:48.273133 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-23 11:33:48.277641 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-23 11:33:48.287953 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-23 11:33:48.534754 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.Post_Type".
2022-01-23 11:33:48.549787 (MainThread): 1699: statically parsed stack_models/TrendingTopics.sql
2022-01-23 11:33:48.555926 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-23 11:33:48.559174 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '573cd65a-7080-44c4-baaa-712993696aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1adeed1a30>]}
2022-01-23 11:33:48.560467 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.Post_Owners".
2022-01-23 11:33:48.573627 (MainThread): Acquiring new bigquery connection "test.stackoverflow_post.assert_total_notlessthan_zero".
2022-01-23 11:33:48.576377 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:33:48.600419 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:33:48.602413 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:33:48.604303 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:33:48.606171 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:33:48.617957 (MainThread): [WARNING]: Test 'test.stackoverflow_post.assert_total_notlessthan_zero' (tests/assert_total_notlessthan_zero.sql) depends on a node named 'TopTags' which was not found
2022-01-23 11:33:48.633730 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '573cd65a-7080-44c4-baaa-712993696aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1adec777f0>]}
2022-01-23 11:33:48.639094 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-23 11:33:48.639533 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '573cd65a-7080-44c4-baaa-712993696aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1adec3e310>]}
2022-01-23 11:33:48.639877 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-01-23 11:33:48.641177 (MainThread): 
2022-01-23 11:33:48.641615 (MainThread): Acquiring new bigquery connection "master".
2022-01-23 11:33:48.642574 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-23 11:33:48.642888 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-23 11:33:49.324657 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-23 11:33:49.325678 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-23 11:33:49.343237 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-23 11:33:49.344780 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 33532, 0, 0), raddr=('2a00:1450:4009:820::200a', 443, 0, 0)>
2022-01-23 11:33:49.345371 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 51896, 0, 0), raddr=('2a00:1450:4009:81e::200a', 443, 0, 0)>
2022-01-23 11:33:49.876959 (MainThread): 11:33:49 | Concurrency: 1 threads (target='dev')
2022-01-23 11:33:49.877787 (MainThread): 11:33:49 | 
2022-01-23 11:33:49.882226 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-23 11:33:49.882828 (Thread-1): 11:33:49 | 1 of 3 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-23 11:33:49.883708 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-23 11:33:49.884188 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-23 11:33:49.889959 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-23 11:33:49.890986 (Thread-1): finished collecting timing info
2022-01-23 11:33:49.923162 (Thread-1): Opening a new connection, currently in state closed
2022-01-23 11:33:49.928356 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-23 11:33:50.582625 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-23 11:33:50.583441 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         owner_display_name,
         owner_user_id,
         post_type_id,
         creation_date,
         last_activity_date,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-23 11:33:54.081046 (Thread-1): finished collecting timing info
2022-01-23 11:33:54.082668 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '573cd65a-7080-44c4-baaa-712993696aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1adf029f40>]}
2022-01-23 11:33:54.083613 (Thread-1): 11:33:54 | 1 of 3 OK created table model dbt_stackoverflow.TrendingTopics....... [CREATE TABLE (4.3k rows, 2.6 GB processed) in 4.20s]
2022-01-23 11:33:54.084388 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-23 11:33:54.085899 (Thread-1): Began running node model.stackoverflow_post.Post_Owners
2022-01-23 11:33:54.086567 (Thread-1): 11:33:54 | 2 of 3 START table model dbt_stackoverflow.Post_Owners............... [RUN]
2022-01-23 11:33:54.087445 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.Post_Owners".
2022-01-23 11:33:54.088112 (Thread-1): Compiling model.stackoverflow_post.Post_Owners
2022-01-23 11:33:54.098107 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.Post_Owners"
2022-01-23 11:33:54.098997 (Thread-1): finished collecting timing info
2022-01-23 11:33:54.103964 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.Post_Owners"
2022-01-23 11:33:54.104918 (Thread-1): Opening a new connection, currently in state closed
2022-01-23 11:33:54.113390 (Thread-1): On model.stackoverflow_post.Post_Owners: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Owners"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Owners`
  
  
  OPTIONS()
  as (
    WITH TEMP AS (SELECT 
     owner_display_name,
     owner_user_id,
     count(*) as user_cnt
FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
group by 1,2 
)

SELECT ROW_NUMBER() OVER() AS owner_tbl_key,* FROM TEMP
  );
    
2022-01-23 11:33:57.707358 (Thread-1): finished collecting timing info
2022-01-23 11:33:57.709939 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '573cd65a-7080-44c4-baaa-712993696aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1adec98670>]}
2022-01-23 11:33:57.712140 (Thread-1): 11:33:57 | 2 of 3 OK created table model dbt_stackoverflow.Post_Owners.......... [CREATE TABLE (4.2k rows, 34.1 KB processed) in 3.62s]
2022-01-23 11:33:57.713480 (Thread-1): Finished running node model.stackoverflow_post.Post_Owners
2022-01-23 11:33:57.714822 (Thread-1): Began running node model.stackoverflow_post.Post_Type
2022-01-23 11:33:57.716864 (Thread-1): 11:33:57 | 3 of 3 START table model dbt_stackoverflow.Post_Type................. [RUN]
2022-01-23 11:33:57.718889 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.Post_Type".
2022-01-23 11:33:57.720092 (Thread-1): Compiling model.stackoverflow_post.Post_Type
2022-01-23 11:33:57.729437 (Thread-1): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 33534, 0, 0), raddr=('2a00:1450:4009:820::200a', 443, 0, 0)>
2022-01-23 11:33:57.730928 (Thread-1): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 51898, 0, 0), raddr=('2a00:1450:4009:81e::200a', 443, 0, 0)>
2022-01-23 11:33:57.732905 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 33536, 0, 0), raddr=('2a00:1450:4009:820::200a', 443, 0, 0)>
2022-01-23 11:33:57.734545 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 51900, 0, 0), raddr=('2a00:1450:4009:81e::200a', 443, 0, 0)>
2022-01-23 11:33:57.736247 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 33538, 0, 0), raddr=('2a00:1450:4009:820::200a', 443, 0, 0)>
2022-01-23 11:33:57.737227 (Thread-1): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 51904, 0, 0), raddr=('2a00:1450:4009:81e::200a', 443, 0, 0)>
2022-01-23 11:33:57.741187 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.Post_Type"
2022-01-23 11:33:57.741941 (Thread-1): finished collecting timing info
2022-01-23 11:33:57.746572 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.Post_Type"
2022-01-23 11:33:57.747639 (Thread-1): Opening a new connection, currently in state closed
2022-01-23 11:33:57.756640 (Thread-1): On model.stackoverflow_post.Post_Type: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Type"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Type`
  
  
  OPTIONS()
  as (
    WITH TEMP AS (SELECT 
    post_type_id,
    count(*) as post_cnt
FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
group by 1)

SELECT ROW_NUMBER() OVER() AS post_tbl_key,* FROM TEMP
  );
    
2022-01-23 11:34:01.154284 (Thread-1): finished collecting timing info
2022-01-23 11:34:01.155267 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '573cd65a-7080-44c4-baaa-712993696aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1adec86e20>]}
2022-01-23 11:34:01.156057 (Thread-1): 11:34:01 | 3 of 3 OK created table model dbt_stackoverflow.Post_Type............ [CREATE TABLE (1.0 rows, 33.3 KB processed) in 3.44s]
2022-01-23 11:34:01.156664 (Thread-1): Finished running node model.stackoverflow_post.Post_Type
2022-01-23 11:34:01.158299 (MainThread): Acquiring new bigquery connection "master".
2022-01-23 11:34:01.159134 (MainThread): 11:34:01 | 
2022-01-23 11:34:01.159592 (MainThread): 11:34:01 | Finished running 3 table models in 12.52s.
2022-01-23 11:34:01.159976 (MainThread): Connection 'master' was properly closed.
2022-01-23 11:34:01.160288 (MainThread): Connection 'model.stackoverflow_post.Post_Type' was properly closed.
2022-01-23 11:34:01.173097 (MainThread): 
2022-01-23 11:34:01.173638 (MainThread): Completed successfully
2022-01-23 11:34:01.174128 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-01-23 11:34:01.174726 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1adeeddaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1adf0213d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1af32988e0>]}
2022-01-23 11:34:01.175261 (MainThread): Flushing usage events
2022-01-23 11:52:00.458347 (MainThread): Running with dbt=0.21.1
2022-01-23 11:52:01.007725 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-23 11:52:01.008713 (MainThread): Tracking: tracking
2022-01-23 11:52:01.032721 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ee772e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc102ab6cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ee7940a0>]}
2022-01-23 11:52:01.043789 (MainThread): Partial parsing not enabled
2022-01-23 11:52:01.052239 (MainThread): Parsing macros/adapters.sql
2022-01-23 11:52:01.075504 (MainThread): Parsing macros/catalog.sql
2022-01-23 11:52:01.081120 (MainThread): Parsing macros/etc.sql
2022-01-23 11:52:01.083001 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-23 11:52:01.084739 (MainThread): Parsing macros/materializations/seed.sql
2022-01-23 11:52:01.087253 (MainThread): Parsing macros/materializations/copy.sql
2022-01-23 11:52:01.089926 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-23 11:52:01.104238 (MainThread): Parsing macros/materializations/view.sql
2022-01-23 11:52:01.106910 (MainThread): Parsing macros/materializations/table.sql
2022-01-23 11:52:01.116010 (MainThread): Parsing macros/core.sql
2022-01-23 11:52:01.119567 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-23 11:52:01.121786 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-23 11:52:01.123450 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-23 11:52:01.124894 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-23 11:52:01.126117 (MainThread): Parsing macros/etc/query.sql
2022-01-23 11:52:01.127114 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-23 11:52:01.128653 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-23 11:52:01.130246 (MainThread): Parsing macros/etc/datetime.sql
2022-01-23 11:52:01.138897 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-23 11:52:01.141342 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-23 11:52:01.143300 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-23 11:52:01.144888 (MainThread): Parsing macros/adapters/common.sql
2022-01-23 11:52:01.250093 (MainThread): Parsing macros/materializations/test.sql
2022-01-23 11:52:01.257843 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-23 11:52:01.268287 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-23 11:52:01.276784 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-23 11:52:01.278716 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-23 11:52:01.309305 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-23 11:52:01.325938 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-23 11:52:01.339141 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-23 11:52:01.340938 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-23 11:52:01.350702 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-23 11:52:01.369387 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-23 11:52:01.373125 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-23 11:52:01.379825 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-23 11:52:01.594419 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.Post_Type".
2022-01-23 11:52:01.606409 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-23 11:52:01.610404 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.Post_Owners".
2022-01-23 11:52:01.622123 (MainThread): Acquiring new bigquery connection "test.stackoverflow_post.assert_total_notlessthan_zero".
2022-01-23 11:52:01.624746 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:52:01.648295 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:52:01.650156 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:52:01.651937 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:52:01.653862 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:52:01.661823 (MainThread): [WARNING]: Test 'test.stackoverflow_post.assert_total_notlessthan_zero' (tests/assert_total_notlessthan_zero.sql) depends on a node named 'TopTags' which was not found
2022-01-23 11:52:01.675997 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a11a0725-5f94-4bec-822a-7f9c18c75b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ee73ed60>]}
2022-01-23 11:52:01.681182 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-23 11:52:01.681645 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a11a0725-5f94-4bec-822a-7f9c18c75b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ee73eeb0>]}
2022-01-23 11:52:01.681989 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-01-23 11:52:01.683140 (MainThread): 
2022-01-23 11:52:01.683529 (MainThread): Acquiring new bigquery connection "master".
2022-01-23 11:52:01.684456 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-23 11:52:01.685163 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-23 11:52:02.374705 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-23 11:52:02.375716 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-23 11:52:02.391485 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-23 11:52:02.392630 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 33544, 0, 0), raddr=('2a00:1450:4009:820::200a', 443, 0, 0)>
2022-01-23 11:52:02.393374 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 58756, 0, 0), raddr=('2a00:1450:4009:81d::200a', 443, 0, 0)>
2022-01-23 11:52:02.987534 (MainThread): 11:52:02 | Concurrency: 1 threads (target='dev')
2022-01-23 11:52:02.987889 (MainThread): 11:52:02 | 
2022-01-23 11:52:02.990576 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-23 11:52:02.990992 (Thread-1): 11:52:02 | 1 of 3 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-23 11:52:02.991700 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-23 11:52:02.992013 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-23 11:52:02.995723 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-23 11:52:02.996244 (Thread-1): finished collecting timing info
2022-01-23 11:52:03.024212 (Thread-1): Opening a new connection, currently in state closed
2022-01-23 11:52:03.029119 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-23 11:52:03.625697 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-23 11:52:03.626193 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         owner_display_name,
         owner_user_id,
         post_type_id,
         creation_date,
         last_activity_date,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-23 11:52:07.498837 (Thread-1): finished collecting timing info
2022-01-23 11:52:07.499392 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a11a0725-5f94-4bec-822a-7f9c18c75b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ee5845b0>]}
2022-01-23 11:52:07.499850 (Thread-1): 11:52:07 | 1 of 3 OK created table model dbt_stackoverflow.TrendingTopics....... [CREATE TABLE (4.3k rows, 2.6 GB processed) in 4.51s]
2022-01-23 11:52:07.500109 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-23 11:52:07.501095 (Thread-1): Began running node model.stackoverflow_post.Post_Owners
2022-01-23 11:52:07.501424 (Thread-1): 11:52:07 | 2 of 3 START table model dbt_stackoverflow.Post_Owners............... [RUN]
2022-01-23 11:52:07.501817 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.Post_Owners".
2022-01-23 11:52:07.502031 (Thread-1): Compiling model.stackoverflow_post.Post_Owners
2022-01-23 11:52:07.504364 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.Post_Owners"
2022-01-23 11:52:07.504802 (Thread-1): finished collecting timing info
2022-01-23 11:52:07.506779 (Thread-1): Opening a new connection, currently in state closed
2022-01-23 11:52:07.512212 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-23 11:52:08.108289 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.Post_Owners"
2022-01-23 11:52:08.108812 (Thread-1): On model.stackoverflow_post.Post_Owners: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Owners"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Owners`
  
  
  OPTIONS()
  as (
    SELECT
     ROW_NUMBER() OVER() AS owner_tbl_key, 
     distinct owner_display_name,
     owner_user_id
FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  );
    
2022-01-23 11:52:08.435954 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword DISTINCT at [11:6]')
2022-01-23 11:52:09.233068 (Thread-1): finished collecting timing info
2022-01-23 11:52:09.234495 (Thread-1): Database Error in model Post_Owners (models/stack_models/Post_Owners.sql)
  Syntax error: Expected ")" but got keyword DISTINCT at [11:6]
  compiled SQL at target/run/stackoverflow_post/models/stack_models/Post_Owners.sql
Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1447, in result
    do_get_result()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    return retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1437, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/base.py", line 727, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected ")" but got keyword DISTINCT at [11:6]

(job ID: 3a8dc5e4-5930-480f-8459-9c9952c05c05)

                                                                 -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Owners"} */
   2:
   3:
   4:  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Owners`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    SELECT
  10:     ROW_NUMBER() OVER() AS owner_tbl_key, 
  11:     distinct owner_display_name,
  12:     owner_user_id
  13:FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  14:  );
  15:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 167, in exception_handler
    self.handle_error(e, message)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model Post_Owners (models/stack_models/Post_Owners.sql)
  Syntax error: Expected ")" but got keyword DISTINCT at [11:6]
  compiled SQL at target/run/stackoverflow_post/models/stack_models/Post_Owners.sql
2022-01-23 11:52:09.242095 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a11a0725-5f94-4bec-822a-7f9c18c75b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ee5adeb0>]}
2022-01-23 11:52:09.243270 (Thread-1): 11:52:09 | 2 of 3 ERROR creating table model dbt_stackoverflow.Post_Owners...... [ERROR in 1.74s]
2022-01-23 11:52:09.244039 (Thread-1): Finished running node model.stackoverflow_post.Post_Owners
2022-01-23 11:52:09.244775 (Thread-1): Began running node model.stackoverflow_post.Post_Type
2022-01-23 11:52:09.246089 (Thread-1): 11:52:09 | 3 of 3 START table model dbt_stackoverflow.Post_Type................. [RUN]
2022-01-23 11:52:09.247268 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.Post_Type".
2022-01-23 11:52:09.247933 (Thread-1): Compiling model.stackoverflow_post.Post_Type
2022-01-23 11:52:09.255425 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.Post_Type"
2022-01-23 11:52:09.256985 (Thread-1): finished collecting timing info
2022-01-23 11:52:09.261744 (Thread-1): Opening a new connection, currently in state closed
2022-01-23 11:52:09.270567 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-23 11:52:09.849136 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.Post_Type"
2022-01-23 11:52:09.850041 (Thread-1): On model.stackoverflow_post.Post_Type: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Type"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Type`
  
  
  OPTIONS()
  as (
    SELECT 
    ROW_NUMBER() OVER() AS post_tbl_key,
    post_type_id
FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  );
    
2022-01-23 11:52:13.125109 (Thread-1): finished collecting timing info
2022-01-23 11:52:13.126682 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a11a0725-5f94-4bec-822a-7f9c18c75b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0edd75fa0>]}
2022-01-23 11:52:13.128036 (Thread-1): 11:52:13 | 3 of 3 OK created table model dbt_stackoverflow.Post_Type............ [CREATE TABLE (4.3k rows, 33.3 KB processed) in 3.88s]
2022-01-23 11:52:13.128862 (Thread-1): Finished running node model.stackoverflow_post.Post_Type
2022-01-23 11:52:13.132337 (MainThread): Acquiring new bigquery connection "master".
2022-01-23 11:52:13.133649 (MainThread): 11:52:13 | 
2022-01-23 11:52:13.134439 (MainThread): 11:52:13 | Finished running 3 table models in 11.45s.
2022-01-23 11:52:13.135171 (MainThread): Connection 'master' was properly closed.
2022-01-23 11:52:13.135742 (MainThread): Connection 'model.stackoverflow_post.Post_Type' was properly closed.
2022-01-23 11:52:13.144523 (MainThread): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 33546, 0, 0), raddr=('2a00:1450:4009:820::200a', 443, 0, 0)>
2022-01-23 11:52:13.145378 (MainThread): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 58758, 0, 0), raddr=('2a00:1450:4009:81d::200a', 443, 0, 0)>
2022-01-23 11:52:13.146160 (MainThread): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 33548, 0, 0), raddr=('2a00:1450:4009:820::200a', 443, 0, 0)>
2022-01-23 11:52:13.146879 (MainThread): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 58760, 0, 0), raddr=('2a00:1450:4009:81d::200a', 443, 0, 0)>
2022-01-23 11:52:13.147616 (MainThread): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 33550, 0, 0), raddr=('2a00:1450:4009:820::200a', 443, 0, 0)>
2022-01-23 11:52:13.148356 (MainThread): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 58762, 0, 0), raddr=('2a00:1450:4009:81d::200a', 443, 0, 0)>
2022-01-23 11:52:13.158789 (MainThread): 
2022-01-23 11:52:13.159347 (MainThread): Completed with 1 error and 0 warnings:
2022-01-23 11:52:13.159838 (MainThread): 
2022-01-23 11:52:13.160312 (MainThread): Database Error in model Post_Owners (models/stack_models/Post_Owners.sql)
2022-01-23 11:52:13.160646 (MainThread):   Syntax error: Expected ")" but got keyword DISTINCT at [11:6]
2022-01-23 11:52:13.160961 (MainThread):   compiled SQL at target/run/stackoverflow_post/models/stack_models/Post_Owners.sql
2022-01-23 11:52:13.161299 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-01-23 11:52:13.161725 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0edd58dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0edc52220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0edc52040>]}
2022-01-23 11:52:13.162194 (MainThread): Flushing usage events
2022-01-23 11:53:06.512349 (MainThread): Running with dbt=0.21.1
2022-01-23 11:53:07.063331 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-23 11:53:07.064326 (MainThread): Tracking: tracking
2022-01-23 11:53:07.088592 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ac8a6a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2098560be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2098560d60>]}
2022-01-23 11:53:07.099666 (MainThread): Partial parsing not enabled
2022-01-23 11:53:07.107959 (MainThread): Parsing macros/adapters.sql
2022-01-23 11:53:07.131464 (MainThread): Parsing macros/catalog.sql
2022-01-23 11:53:07.137044 (MainThread): Parsing macros/etc.sql
2022-01-23 11:53:07.138922 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-23 11:53:07.140661 (MainThread): Parsing macros/materializations/seed.sql
2022-01-23 11:53:07.143212 (MainThread): Parsing macros/materializations/copy.sql
2022-01-23 11:53:07.145875 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-23 11:53:07.160130 (MainThread): Parsing macros/materializations/view.sql
2022-01-23 11:53:07.162719 (MainThread): Parsing macros/materializations/table.sql
2022-01-23 11:53:07.171982 (MainThread): Parsing macros/core.sql
2022-01-23 11:53:07.175639 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-23 11:53:07.177895 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-23 11:53:07.179557 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-23 11:53:07.180946 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-23 11:53:07.182172 (MainThread): Parsing macros/etc/query.sql
2022-01-23 11:53:07.183172 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-23 11:53:07.184734 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-23 11:53:07.186336 (MainThread): Parsing macros/etc/datetime.sql
2022-01-23 11:53:07.195128 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-23 11:53:07.197675 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-23 11:53:07.199513 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-23 11:53:07.202114 (MainThread): Parsing macros/adapters/common.sql
2022-01-23 11:53:07.306766 (MainThread): Parsing macros/materializations/test.sql
2022-01-23 11:53:07.314699 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-23 11:53:07.326361 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-23 11:53:07.334144 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-23 11:53:07.335904 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-23 11:53:07.366870 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-23 11:53:07.383579 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-23 11:53:07.396910 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-23 11:53:07.398629 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-23 11:53:07.408481 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-23 11:53:07.427171 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-23 11:53:07.430922 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-23 11:53:07.437677 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-23 11:53:07.653865 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.Post_Type".
2022-01-23 11:53:07.665971 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-23 11:53:07.669975 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.Post_Owners".
2022-01-23 11:53:07.681803 (MainThread): Acquiring new bigquery connection "test.stackoverflow_post.assert_total_notlessthan_zero".
2022-01-23 11:53:07.684442 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:53:07.707497 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:53:07.709347 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:53:07.711103 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:53:07.713190 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:53:07.721163 (MainThread): [WARNING]: Test 'test.stackoverflow_post.assert_total_notlessthan_zero' (tests/assert_total_notlessthan_zero.sql) depends on a node named 'TopTags' which was not found
2022-01-23 11:53:07.735001 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '547cacf1-85e8-456c-96a4-dddd31a789a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209852f970>]}
2022-01-23 11:53:07.740382 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-23 11:53:07.740950 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '547cacf1-85e8-456c-96a4-dddd31a789a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209852fe50>]}
2022-01-23 11:53:07.741321 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-01-23 11:53:07.742487 (MainThread): 
2022-01-23 11:53:07.742885 (MainThread): Acquiring new bigquery connection "master".
2022-01-23 11:53:07.743835 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-23 11:53:07.744583 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-23 11:53:08.833246 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-23 11:53:08.834300 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-23 11:53:08.843159 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-23 11:53:08.843621 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 51908, 0, 0), raddr=('2a00:1450:4009:81e::200a', 443, 0, 0)>
2022-01-23 11:53:08.843959 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 58766, 0, 0), raddr=('2a00:1450:4009:81d::200a', 443, 0, 0)>
2022-01-23 11:53:09.396832 (MainThread): 11:53:09 | Concurrency: 1 threads (target='dev')
2022-01-23 11:53:09.397780 (MainThread): 11:53:09 | 
2022-01-23 11:53:09.402668 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-23 11:53:09.403060 (Thread-1): 11:53:09 | 1 of 3 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-23 11:53:09.403738 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-23 11:53:09.404031 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-23 11:53:09.407480 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-23 11:53:09.407990 (Thread-1): finished collecting timing info
2022-01-23 11:53:09.433413 (Thread-1): Opening a new connection, currently in state closed
2022-01-23 11:53:09.438284 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-23 11:53:10.423814 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-23 11:53:10.424349 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         owner_display_name,
         owner_user_id,
         post_type_id,
         creation_date,
         last_activity_date,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-23 11:53:13.549051 (Thread-1): finished collecting timing info
2022-01-23 11:53:13.549620 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '547cacf1-85e8-456c-96a4-dddd31a789a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20983745b0>]}
2022-01-23 11:53:13.550072 (Thread-1): 11:53:13 | 1 of 3 OK created table model dbt_stackoverflow.TrendingTopics....... [CREATE TABLE (4.3k rows, 2.6 GB processed) in 4.15s]
2022-01-23 11:53:13.550328 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-23 11:53:13.551334 (Thread-1): Began running node model.stackoverflow_post.Post_Owners
2022-01-23 11:53:13.551680 (Thread-1): 11:53:13 | 2 of 3 START table model dbt_stackoverflow.Post_Owners............... [RUN]
2022-01-23 11:53:13.552090 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.Post_Owners".
2022-01-23 11:53:13.552304 (Thread-1): Compiling model.stackoverflow_post.Post_Owners
2022-01-23 11:53:13.554604 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.Post_Owners"
2022-01-23 11:53:13.554996 (Thread-1): finished collecting timing info
2022-01-23 11:53:13.556823 (Thread-1): Opening a new connection, currently in state closed
2022-01-23 11:53:13.562276 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-23 11:53:14.157393 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.Post_Owners"
2022-01-23 11:53:14.157966 (Thread-1): On model.stackoverflow_post.Post_Owners: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Owners"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Owners`
  
  
  OPTIONS()
  as (
    SELECT
     ROW_NUMBER() OVER() AS owner_tbl_key, 
     distinct owner_display_name,
     owner_user_id
FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  );
    
2022-01-23 11:53:14.564931 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword DISTINCT at [11:6]')
2022-01-23 11:53:15.901269 (Thread-1): finished collecting timing info
2022-01-23 11:53:15.902767 (Thread-1): Database Error in model Post_Owners (models/stack_models/Post_Owners.sql)
  Syntax error: Expected ")" but got keyword DISTINCT at [11:6]
  compiled SQL at target/run/stackoverflow_post/models/stack_models/Post_Owners.sql
Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1447, in result
    do_get_result()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    return retry_target(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1437, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/cloud/bigquery/job/base.py", line 727, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected ")" but got keyword DISTINCT at [11:6]

(job ID: 8d290901-23d4-4644-b5f6-15cc0077865d)

                                                                 -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Owners"} */
   2:
   3:
   4:  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Owners`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    SELECT
  10:     ROW_NUMBER() OVER() AS owner_tbl_key, 
  11:     distinct owner_display_name,
  12:     owner_user_id
  13:FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  14:  );
  15:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 566, in _retry_and_handle
    return retry.retry_target(
  File "/home/kp/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 167, in exception_handler
    self.handle_error(e, message)
  File "/home/kp/anaconda3/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model Post_Owners (models/stack_models/Post_Owners.sql)
  Syntax error: Expected ")" but got keyword DISTINCT at [11:6]
  compiled SQL at target/run/stackoverflow_post/models/stack_models/Post_Owners.sql
2022-01-23 11:53:15.910624 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '547cacf1-85e8-456c-96a4-dddd31a789a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2098343bb0>]}
2022-01-23 11:53:15.912013 (Thread-1): 11:53:15 | 2 of 3 ERROR creating table model dbt_stackoverflow.Post_Owners...... [ERROR in 2.36s]
2022-01-23 11:53:15.912884 (Thread-1): Finished running node model.stackoverflow_post.Post_Owners
2022-01-23 11:53:15.913733 (Thread-1): Began running node model.stackoverflow_post.Post_Type
2022-01-23 11:53:15.915100 (Thread-1): 11:53:15 | 3 of 3 START table model dbt_stackoverflow.Post_Type................. [RUN]
2022-01-23 11:53:15.916336 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.Post_Type".
2022-01-23 11:53:15.916981 (Thread-1): Compiling model.stackoverflow_post.Post_Type
2022-01-23 11:53:15.926880 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.Post_Type"
2022-01-23 11:53:15.928110 (Thread-1): finished collecting timing info
2022-01-23 11:53:15.932946 (Thread-1): Opening a new connection, currently in state closed
2022-01-23 11:53:15.942990 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-23 11:53:16.512079 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.Post_Type"
2022-01-23 11:53:16.512622 (Thread-1): On model.stackoverflow_post.Post_Type: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Type"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Type`
  
  
  OPTIONS()
  as (
    SELECT 
    ROW_NUMBER() OVER() AS post_tbl_key,
    post_type_id
FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  );
    
2022-01-23 11:53:19.173851 (Thread-1): finished collecting timing info
2022-01-23 11:53:19.175217 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '547cacf1-85e8-456c-96a4-dddd31a789a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209837f400>]}
2022-01-23 11:53:19.175697 (Thread-1): 11:53:19 | 3 of 3 OK created table model dbt_stackoverflow.Post_Type............ [CREATE TABLE (4.3k rows, 33.3 KB processed) in 3.26s]
2022-01-23 11:53:19.175993 (Thread-1): Finished running node model.stackoverflow_post.Post_Type
2022-01-23 11:53:19.177382 (MainThread): Acquiring new bigquery connection "master".
2022-01-23 11:53:19.177837 (MainThread): 11:53:19 | 
2022-01-23 11:53:19.178097 (MainThread): 11:53:19 | Finished running 3 table models in 11.44s.
2022-01-23 11:53:19.178341 (MainThread): Connection 'master' was properly closed.
2022-01-23 11:53:19.178546 (MainThread): Connection 'model.stackoverflow_post.Post_Type' was properly closed.
2022-01-23 11:53:19.181703 (MainThread): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 51910, 0, 0), raddr=('2a00:1450:4009:81e::200a', 443, 0, 0)>
2022-01-23 11:53:19.182077 (MainThread): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 58768, 0, 0), raddr=('2a00:1450:4009:81d::200a', 443, 0, 0)>
2022-01-23 11:53:19.182408 (MainThread): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 51912, 0, 0), raddr=('2a00:1450:4009:81e::200a', 443, 0, 0)>
2022-01-23 11:53:19.182680 (MainThread): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 58770, 0, 0), raddr=('2a00:1450:4009:81d::200a', 443, 0, 0)>
2022-01-23 11:53:19.182967 (MainThread): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 51914, 0, 0), raddr=('2a00:1450:4009:81e::200a', 443, 0, 0)>
2022-01-23 11:53:19.183225 (MainThread): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 58772, 0, 0), raddr=('2a00:1450:4009:81d::200a', 443, 0, 0)>
2022-01-23 11:53:19.187908 (MainThread): 
2022-01-23 11:53:19.188269 (MainThread): Completed with 1 error and 0 warnings:
2022-01-23 11:53:19.188561 (MainThread): 
2022-01-23 11:53:19.188838 (MainThread): Database Error in model Post_Owners (models/stack_models/Post_Owners.sql)
2022-01-23 11:53:19.189088 (MainThread):   Syntax error: Expected ")" but got keyword DISTINCT at [11:6]
2022-01-23 11:53:19.189342 (MainThread):   compiled SQL at target/run/stackoverflow_post/models/stack_models/Post_Owners.sql
2022-01-23 11:53:19.189624 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-01-23 11:53:19.189965 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2098343fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2098243a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2098243cd0>]}
2022-01-23 11:53:19.190322 (MainThread): Flushing usage events
2022-01-23 11:53:57.075199 (MainThread): Running with dbt=0.21.1
2022-01-23 11:53:57.623230 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-23 11:53:57.624209 (MainThread): Tracking: tracking
2022-01-23 11:53:57.648500 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdfee61e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe131a5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdfee830a0>]}
2022-01-23 11:53:57.659575 (MainThread): Partial parsing not enabled
2022-01-23 11:53:57.667603 (MainThread): Parsing macros/adapters.sql
2022-01-23 11:53:57.690895 (MainThread): Parsing macros/catalog.sql
2022-01-23 11:53:57.696500 (MainThread): Parsing macros/etc.sql
2022-01-23 11:53:57.698366 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-23 11:53:57.700237 (MainThread): Parsing macros/materializations/seed.sql
2022-01-23 11:53:57.702809 (MainThread): Parsing macros/materializations/copy.sql
2022-01-23 11:53:57.705547 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-23 11:53:57.719545 (MainThread): Parsing macros/materializations/view.sql
2022-01-23 11:53:57.722112 (MainThread): Parsing macros/materializations/table.sql
2022-01-23 11:53:57.731324 (MainThread): Parsing macros/core.sql
2022-01-23 11:53:57.734920 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-23 11:53:57.737145 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-23 11:53:57.738811 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-23 11:53:57.740206 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-23 11:53:57.741425 (MainThread): Parsing macros/etc/query.sql
2022-01-23 11:53:57.742423 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-23 11:53:57.743922 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-23 11:53:57.745505 (MainThread): Parsing macros/etc/datetime.sql
2022-01-23 11:53:57.754236 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-23 11:53:57.756745 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-23 11:53:57.758603 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-23 11:53:57.760153 (MainThread): Parsing macros/adapters/common.sql
2022-01-23 11:53:57.863439 (MainThread): Parsing macros/materializations/test.sql
2022-01-23 11:53:57.871193 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-23 11:53:57.882098 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-23 11:53:57.889639 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-23 11:53:57.891300 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-23 11:53:57.922825 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-23 11:53:57.940140 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-23 11:53:57.953832 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-23 11:53:57.955644 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-23 11:53:57.965664 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-23 11:53:57.984330 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-23 11:53:57.988079 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-23 11:53:57.994847 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-23 11:53:58.215680 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.Post_Type".
2022-01-23 11:53:58.228041 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-23 11:53:58.232103 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.Post_Owners".
2022-01-23 11:53:58.244204 (MainThread): Acquiring new bigquery connection "test.stackoverflow_post.assert_total_notlessthan_zero".
2022-01-23 11:53:58.246790 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:53:58.270392 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:53:58.272303 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:53:58.274083 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:53:58.276057 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-23 11:53:58.283970 (MainThread): [WARNING]: Test 'test.stackoverflow_post.assert_total_notlessthan_zero' (tests/assert_total_notlessthan_zero.sql) depends on a node named 'TopTags' which was not found
2022-01-23 11:53:58.298226 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef3a22bc-1ded-4db1-a69a-434ff4850f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdfee26ca0>]}
2022-01-23 11:53:58.303710 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-23 11:53:58.304265 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef3a22bc-1ded-4db1-a69a-434ff4850f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdfee26a00>]}
2022-01-23 11:53:58.304660 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-01-23 11:53:58.305888 (MainThread): 
2022-01-23 11:53:58.306289 (MainThread): Acquiring new bigquery connection "master".
2022-01-23 11:53:58.307200 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-23 11:53:58.308015 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-23 11:53:59.351661 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-23 11:53:59.352978 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-23 11:53:59.369913 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-23 11:53:59.371219 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 51918, 0, 0), raddr=('2a00:1450:4009:81e::200a', 443, 0, 0)>
2022-01-23 11:53:59.372138 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 58776, 0, 0), raddr=('2a00:1450:4009:81d::200a', 443, 0, 0)>
2022-01-23 11:54:00.020126 (MainThread): 11:54:00 | Concurrency: 1 threads (target='dev')
2022-01-23 11:54:00.021063 (MainThread): 11:54:00 | 
2022-01-23 11:54:00.027109 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-23 11:54:00.028274 (Thread-1): 11:54:00 | 1 of 3 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-23 11:54:00.030052 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-23 11:54:00.030777 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-23 11:54:00.040695 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-23 11:54:00.041898 (Thread-1): finished collecting timing info
2022-01-23 11:54:00.070387 (Thread-1): Opening a new connection, currently in state closed
2022-01-23 11:54:00.075126 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-23 11:54:00.666910 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-23 11:54:00.667415 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         owner_display_name,
         owner_user_id,
         post_type_id,
         creation_date,
         last_activity_date,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-23 11:54:03.928359 (Thread-1): finished collecting timing info
2022-01-23 11:54:03.928905 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef3a22bc-1ded-4db1-a69a-434ff4850f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdfec8da00>]}
2022-01-23 11:54:03.929339 (Thread-1): 11:54:03 | 1 of 3 OK created table model dbt_stackoverflow.TrendingTopics....... [CREATE TABLE (4.3k rows, 2.6 GB processed) in 3.90s]
2022-01-23 11:54:03.929587 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-23 11:54:03.930467 (Thread-1): Began running node model.stackoverflow_post.Post_Owners
2022-01-23 11:54:03.930834 (Thread-1): 11:54:03 | 2 of 3 START table model dbt_stackoverflow.Post_Owners............... [RUN]
2022-01-23 11:54:03.931223 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.Post_Owners".
2022-01-23 11:54:03.931435 (Thread-1): Compiling model.stackoverflow_post.Post_Owners
2022-01-23 11:54:03.933850 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.Post_Owners"
2022-01-23 11:54:03.934280 (Thread-1): finished collecting timing info
2022-01-23 11:54:03.936117 (Thread-1): Opening a new connection, currently in state closed
2022-01-23 11:54:03.941517 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-23 11:54:04.536258 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.Post_Owners"
2022-01-23 11:54:04.536735 (Thread-1): On model.stackoverflow_post.Post_Owners: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Owners"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Owners`
  
  
  OPTIONS()
  as (
    SELECT
     distinct owner_display_name,
     owner_user_id,
     ROW_NUMBER() OVER() AS owner_tbl_key
FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  );
    
2022-01-23 11:54:07.813623 (Thread-1): finished collecting timing info
2022-01-23 11:54:07.815010 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef3a22bc-1ded-4db1-a69a-434ff4850f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdfe465f70>]}
2022-01-23 11:54:07.815465 (Thread-1): 11:54:07 | 2 of 3 OK created table model dbt_stackoverflow.Post_Owners.......... [CREATE TABLE (4.3k rows, 34.1 KB processed) in 3.88s]
2022-01-23 11:54:07.815737 (Thread-1): Finished running node model.stackoverflow_post.Post_Owners
2022-01-23 11:54:07.816030 (Thread-1): Began running node model.stackoverflow_post.Post_Type
2022-01-23 11:54:07.816359 (Thread-1): 11:54:07 | 3 of 3 START table model dbt_stackoverflow.Post_Type................. [RUN]
2022-01-23 11:54:07.816786 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.Post_Type".
2022-01-23 11:54:07.817031 (Thread-1): Compiling model.stackoverflow_post.Post_Type
2022-01-23 11:54:07.819743 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.Post_Type"
2022-01-23 11:54:07.820367 (Thread-1): finished collecting timing info
2022-01-23 11:54:07.822195 (Thread-1): Opening a new connection, currently in state closed
2022-01-23 11:54:07.828500 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-23 11:54:08.349687 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.Post_Type"
2022-01-23 11:54:08.351046 (Thread-1): On model.stackoverflow_post.Post_Type: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Type"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Type`
  
  
  OPTIONS()
  as (
    SELECT 
    ROW_NUMBER() OVER() AS post_tbl_key,
    post_type_id
FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  );
    
2022-01-23 11:54:11.398515 (Thread-1): finished collecting timing info
2022-01-23 11:54:11.399874 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef3a22bc-1ded-4db1-a69a-434ff4850f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdfe448070>]}
2022-01-23 11:54:11.400354 (Thread-1): 11:54:11 | 3 of 3 OK created table model dbt_stackoverflow.Post_Type............ [CREATE TABLE (4.3k rows, 33.3 KB processed) in 3.58s]
2022-01-23 11:54:11.400634 (Thread-1): Finished running node model.stackoverflow_post.Post_Type
2022-01-23 11:54:11.402142 (MainThread): Acquiring new bigquery connection "master".
2022-01-23 11:54:11.402591 (MainThread): 11:54:11 | 
2022-01-23 11:54:11.402842 (MainThread): 11:54:11 | Finished running 3 table models in 13.10s.
2022-01-23 11:54:11.403065 (MainThread): Connection 'master' was properly closed.
2022-01-23 11:54:11.403263 (MainThread): Connection 'model.stackoverflow_post.Post_Type' was properly closed.
2022-01-23 11:54:11.406350 (MainThread): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 51920, 0, 0), raddr=('2a00:1450:4009:81e::200a', 443, 0, 0)>
2022-01-23 11:54:11.406755 (MainThread): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 58778, 0, 0), raddr=('2a00:1450:4009:81d::200a', 443, 0, 0)>
2022-01-23 11:54:11.407050 (MainThread): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 51922, 0, 0), raddr=('2a00:1450:4009:81e::200a', 443, 0, 0)>
2022-01-23 11:54:11.407312 (MainThread): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 58780, 0, 0), raddr=('2a00:1450:4009:81d::200a', 443, 0, 0)>
2022-01-23 11:54:11.407592 (MainThread): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 51924, 0, 0), raddr=('2a00:1450:4009:81e::200a', 443, 0, 0)>
2022-01-23 11:54:11.407858 (MainThread): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:e0fa:9b5e:5af0:e48b', 58782, 0, 0), raddr=('2a00:1450:4009:81d::200a', 443, 0, 0)>
2022-01-23 11:54:11.412115 (MainThread): 
2022-01-23 11:54:11.412537 (MainThread): Completed successfully
2022-01-23 11:54:11.412827 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-01-23 11:54:11.413154 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdfed2f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdfed42d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdfed42fa0>]}
2022-01-23 11:54:11.413496 (MainThread): Flushing usage events
2022-01-24 10:15:33.234491 (MainThread): Running with dbt=0.21.1
2022-01-24 10:15:34.446522 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-24 10:15:34.447976 (MainThread): Tracking: tracking
2022-01-24 10:15:34.501153 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f445d79e8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4449453d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4449453ca0>]}
2022-01-24 10:15:34.515063 (MainThread): Partial parsing not enabled
2022-01-24 10:15:34.537119 (MainThread): Parsing macros/adapters.sql
2022-01-24 10:15:34.566129 (MainThread): Parsing macros/catalog.sql
2022-01-24 10:15:34.573638 (MainThread): Parsing macros/etc.sql
2022-01-24 10:15:34.576002 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-24 10:15:34.578698 (MainThread): Parsing macros/materializations/seed.sql
2022-01-24 10:15:34.581733 (MainThread): Parsing macros/materializations/copy.sql
2022-01-24 10:15:34.584964 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-24 10:15:34.604867 (MainThread): Parsing macros/materializations/view.sql
2022-01-24 10:15:34.608032 (MainThread): Parsing macros/materializations/table.sql
2022-01-24 10:15:34.619326 (MainThread): Parsing macros/core.sql
2022-01-24 10:15:34.624170 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-24 10:15:34.626768 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-24 10:15:34.628951 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-24 10:15:34.630572 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-24 10:15:34.632106 (MainThread): Parsing macros/etc/query.sql
2022-01-24 10:15:34.633259 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-24 10:15:34.635015 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-24 10:15:34.637265 (MainThread): Parsing macros/etc/datetime.sql
2022-01-24 10:15:34.648133 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-24 10:15:34.650969 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-24 10:15:34.653618 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-24 10:15:34.655497 (MainThread): Parsing macros/adapters/common.sql
2022-01-24 10:15:34.772103 (MainThread): Parsing macros/materializations/test.sql
2022-01-24 10:15:34.780501 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-24 10:15:34.792467 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-24 10:15:34.801316 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-24 10:15:34.803709 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-24 10:15:34.840610 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-24 10:15:34.861032 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-24 10:15:34.879963 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-24 10:15:34.882109 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-24 10:15:34.894503 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-24 10:15:34.918128 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-24 10:15:34.923104 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-24 10:15:34.931168 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-24 10:15:35.201654 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.Post_Type".
2022-01-24 10:15:35.216670 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-24 10:15:35.221762 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.dim_date".
2022-01-24 10:15:35.226461 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.Post_Owners".
2022-01-24 10:15:35.241576 (MainThread): Acquiring new bigquery connection "test.stackoverflow_post.assert_total_notlessthan_zero".
2022-01-24 10:15:35.245064 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-24 10:15:35.274823 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-24 10:15:35.277521 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-24 10:15:35.279921 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-24 10:15:35.282078 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-24 10:15:35.295062 (MainThread): [WARNING]: Test 'test.stackoverflow_post.assert_total_notlessthan_zero' (tests/assert_total_notlessthan_zero.sql) depends on a node named 'TopTags' which was not found
2022-01-24 10:15:35.313980 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34c7d182-6eb1-4af4-954f-4870008503e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f444937c190>]}
2022-01-24 10:15:35.321056 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-24 10:15:35.321958 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34c7d182-6eb1-4af4-954f-4870008503e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44493fd2b0>]}
2022-01-24 10:15:35.322526 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-01-24 10:15:35.324292 (MainThread): 
2022-01-24 10:15:35.324838 (MainThread): Acquiring new bigquery connection "master".
2022-01-24 10:15:35.326113 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-24 10:15:35.326487 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-24 10:15:36.076567 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-24 10:15:36.078725 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-24 10:15:36.100621 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-24 10:15:36.681307 (MainThread): 10:15:36 | Concurrency: 1 threads (target='dev')
2022-01-24 10:15:36.682488 (MainThread): 10:15:36 | 
2022-01-24 10:15:36.697786 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-24 10:15:36.699968 (Thread-1): 10:15:36 | 1 of 4 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-24 10:15:36.702312 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-24 10:15:36.704073 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-24 10:15:36.716670 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-24 10:15:36.718183 (Thread-1): finished collecting timing info
2022-01-24 10:15:36.760527 (Thread-1): Opening a new connection, currently in state closed
2022-01-24 10:15:36.766005 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-24 10:15:37.549567 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-24 10:15:37.550241 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         owner_display_name,
         owner_user_id,
         post_type_id,
         creation_date,
         date(creation_date) as tbl_dt,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-24 10:15:41.832226 (Thread-1): finished collecting timing info
2022-01-24 10:15:41.834441 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c7d182-6eb1-4af4-954f-4870008503e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4449341f40>]}
2022-01-24 10:15:41.836897 (Thread-1): 10:15:41 | 1 of 4 OK created table model dbt_stackoverflow.TrendingTopics....... [CREATE TABLE (4.3k rows, 2.6 GB processed) in 5.13s]
2022-01-24 10:15:41.838197 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-24 10:15:41.841598 (Thread-1): Began running node model.stackoverflow_post.Post_Owners
2022-01-24 10:15:41.845548 (Thread-1): 10:15:41 | 2 of 4 START table model dbt_stackoverflow.Post_Owners............... [RUN]
2022-01-24 10:15:41.848365 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.Post_Owners".
2022-01-24 10:15:41.849407 (Thread-1): Compiling model.stackoverflow_post.Post_Owners
2022-01-24 10:15:41.860373 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.Post_Owners"
2022-01-24 10:15:41.862088 (Thread-1): finished collecting timing info
2022-01-24 10:15:41.871529 (Thread-1): Opening a new connection, currently in state closed
2022-01-24 10:15:41.892316 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-24 10:15:42.523373 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.Post_Owners"
2022-01-24 10:15:42.526582 (Thread-1): On model.stackoverflow_post.Post_Owners: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Owners"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Owners`
  
  
  OPTIONS()
  as (
    SELECT
     distinct owner_display_name,
     owner_user_id,
     ROW_NUMBER() OVER() AS owner_tbl_key
FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  );
    
2022-01-24 10:15:45.893679 (Thread-1): finished collecting timing info
2022-01-24 10:15:45.894496 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c7d182-6eb1-4af4-954f-4870008503e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4448a4a250>]}
2022-01-24 10:15:45.895108 (Thread-1): 10:15:45 | 2 of 4 OK created table model dbt_stackoverflow.Post_Owners.......... [CREATE TABLE (4.3k rows, 34.1 KB processed) in 4.05s]
2022-01-24 10:15:45.895484 (Thread-1): Finished running node model.stackoverflow_post.Post_Owners
2022-01-24 10:15:45.895876 (Thread-1): Began running node model.stackoverflow_post.Post_Type
2022-01-24 10:15:45.896398 (Thread-1): 10:15:45 | 3 of 4 START table model dbt_stackoverflow.Post_Type................. [RUN]
2022-01-24 10:15:45.897028 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.Post_Type".
2022-01-24 10:15:45.897301 (Thread-1): Compiling model.stackoverflow_post.Post_Type
2022-01-24 10:15:45.900713 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.Post_Type"
2022-01-24 10:15:45.901492 (Thread-1): finished collecting timing info
2022-01-24 10:15:45.904609 (Thread-1): Opening a new connection, currently in state closed
2022-01-24 10:15:45.911145 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-24 10:15:46.508512 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.Post_Type"
2022-01-24 10:15:46.509266 (Thread-1): On model.stackoverflow_post.Post_Type: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Type"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Type`
  
  
  OPTIONS()
  as (
    SELECT 
    ROW_NUMBER() OVER() AS post_tbl_key,
    post_type_id
FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  );
    
2022-01-24 10:15:49.889799 (Thread-1): finished collecting timing info
2022-01-24 10:15:49.891644 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c7d182-6eb1-4af4-954f-4870008503e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4448a8d760>]}
2022-01-24 10:15:49.893894 (Thread-1): 10:15:49 | 3 of 4 OK created table model dbt_stackoverflow.Post_Type............ [CREATE TABLE (4.3k rows, 33.3 KB processed) in 3.99s]
2022-01-24 10:15:49.894946 (Thread-1): Finished running node model.stackoverflow_post.Post_Type
2022-01-24 10:15:49.895917 (Thread-1): Began running node model.stackoverflow_post.dim_date
2022-01-24 10:15:49.897352 (Thread-1): 10:15:49 | 4 of 4 START table model dbt_stackoverflow.dim_date.................. [RUN]
2022-01-24 10:15:49.898873 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.dim_date".
2022-01-24 10:15:49.899701 (Thread-1): Compiling model.stackoverflow_post.dim_date
2022-01-24 10:15:49.904590 (Thread-1): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 9620, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2022-01-24 10:15:49.905632 (Thread-1): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 28494, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2022-01-24 10:15:49.906902 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 9622, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2022-01-24 10:15:49.908222 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 28496, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2022-01-24 10:15:49.909335 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 9624, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2022-01-24 10:15:49.910371 (Thread-1): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 28498, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2022-01-24 10:15:49.911042 (Thread-1): unclosed <ssl.SSLSocket fd=14, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 9628, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2022-01-24 10:15:49.911590 (Thread-1): unclosed <ssl.SSLSocket fd=15, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 28500, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2022-01-24 10:15:49.912209 (Thread-1): unclosed <ssl.SSLSocket fd=16, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 9630, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2022-01-24 10:15:49.912714 (Thread-1): unclosed <ssl.SSLSocket fd=17, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 28502, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2022-01-24 10:15:49.917307 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.dim_date"
2022-01-24 10:15:49.917966 (Thread-1): finished collecting timing info
2022-01-24 10:15:49.921788 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.dim_date"
2022-01-24 10:15:49.922514 (Thread-1): Opening a new connection, currently in state closed
2022-01-24 10:15:49.928919 (Thread-1): On model.stackoverflow_post.dim_date: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.dim_date"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`dim_date`
  
  
  OPTIONS()
  as (
    with temp as (SELECT
   EXTRACT(month 
FROM
   tbl_dt) month,
   EXTRACT(quarter 
FROM
   tbl_dt)quarter,
   EXTRACT(year 
FROM
   tbl_dt) year 
FROM
    `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`)

select distinct month,quarter,year from temp
  );
    
2022-01-24 10:15:53.781223 (Thread-1): finished collecting timing info
2022-01-24 10:15:53.783505 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c7d182-6eb1-4af4-954f-4870008503e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4448a4a250>]}
2022-01-24 10:15:53.785383 (Thread-1): 10:15:53 | 4 of 4 OK created table model dbt_stackoverflow.dim_date............. [CREATE TABLE (91.0 rows, 33.3 KB processed) in 3.88s]
2022-01-24 10:15:53.786400 (Thread-1): Finished running node model.stackoverflow_post.dim_date
2022-01-24 10:15:53.789633 (MainThread): Acquiring new bigquery connection "master".
2022-01-24 10:15:53.791035 (MainThread): 10:15:53 | 
2022-01-24 10:15:53.792127 (MainThread): 10:15:53 | Finished running 4 table models in 18.47s.
2022-01-24 10:15:53.793056 (MainThread): Connection 'master' was properly closed.
2022-01-24 10:15:53.793687 (MainThread): Connection 'model.stackoverflow_post.dim_date' was properly closed.
2022-01-24 10:15:53.796685 (MainThread): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 9632, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2022-01-24 10:15:53.797582 (MainThread): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 28504, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2022-01-24 10:15:53.815530 (MainThread): 
2022-01-24 10:15:53.816934 (MainThread): Completed successfully
2022-01-24 10:15:53.817906 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2022-01-24 10:15:53.818853 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44494a77c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44494a74c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44493a62e0>]}
2022-01-24 10:15:53.819538 (MainThread): Flushing usage events
2022-01-24 10:18:24.515601 (MainThread): Running with dbt=0.21.1
2022-01-24 10:18:25.142248 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-24 10:18:25.143386 (MainThread): Tracking: tracking
2022-01-24 10:18:25.175734 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ae2a18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84c25e5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ae2c3040>]}
2022-01-24 10:18:25.189466 (MainThread): Partial parsing not enabled
2022-01-24 10:18:25.199047 (MainThread): Parsing macros/adapters.sql
2022-01-24 10:18:25.226720 (MainThread): Parsing macros/catalog.sql
2022-01-24 10:18:25.233136 (MainThread): Parsing macros/etc.sql
2022-01-24 10:18:25.235276 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-24 10:18:25.237227 (MainThread): Parsing macros/materializations/seed.sql
2022-01-24 10:18:25.240247 (MainThread): Parsing macros/materializations/copy.sql
2022-01-24 10:18:25.243303 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-24 10:18:25.259430 (MainThread): Parsing macros/materializations/view.sql
2022-01-24 10:18:25.262383 (MainThread): Parsing macros/materializations/table.sql
2022-01-24 10:18:25.272884 (MainThread): Parsing macros/core.sql
2022-01-24 10:18:25.277076 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-24 10:18:25.279686 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-24 10:18:25.281803 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-24 10:18:25.283744 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-24 10:18:25.286868 (MainThread): Parsing macros/etc/query.sql
2022-01-24 10:18:25.288795 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-24 10:18:25.292425 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-24 10:18:25.294659 (MainThread): Parsing macros/etc/datetime.sql
2022-01-24 10:18:25.305955 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-24 10:18:25.309051 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-24 10:18:25.311461 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-24 10:18:25.313355 (MainThread): Parsing macros/adapters/common.sql
2022-01-24 10:18:25.427796 (MainThread): Parsing macros/materializations/test.sql
2022-01-24 10:18:25.435766 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-24 10:18:25.447523 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-24 10:18:25.456443 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-24 10:18:25.459057 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-24 10:18:25.495872 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-24 10:18:25.515898 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-24 10:18:25.532406 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-24 10:18:25.534435 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-24 10:18:25.546263 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-24 10:18:25.570020 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-24 10:18:25.575143 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-24 10:18:25.583300 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-24 10:18:25.846635 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.Post_Type".
2022-01-24 10:18:25.860907 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-24 10:18:25.865961 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.dim_date".
2022-01-24 10:18:25.870591 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.Post_Owners".
2022-01-24 10:18:25.884497 (MainThread): Acquiring new bigquery connection "test.stackoverflow_post.assert_total_notlessthan_zero".
2022-01-24 10:18:25.887542 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-24 10:18:25.916103 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-24 10:18:25.918322 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-24 10:18:25.920549 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-24 10:18:25.922794 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-24 10:18:25.932229 (MainThread): [WARNING]: Test 'test.stackoverflow_post.assert_total_notlessthan_zero' (tests/assert_total_notlessthan_zero.sql) depends on a node named 'TopTags' which was not found
2022-01-24 10:18:25.949435 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a6ad588-0caa-4bfa-8b8e-de51c4323cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ae1bc460>]}
2022-01-24 10:18:25.956168 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-24 10:18:25.956763 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a6ad588-0caa-4bfa-8b8e-de51c4323cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ae2ed0d0>]}
2022-01-24 10:18:25.957188 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-01-24 10:18:25.959064 (MainThread): 
2022-01-24 10:18:25.959809 (MainThread): Acquiring new bigquery connection "master".
2022-01-24 10:18:25.961287 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-24 10:18:25.961777 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-24 10:18:26.666970 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-24 10:18:26.668163 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-24 10:18:26.684523 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-24 10:18:27.243487 (MainThread): 10:18:27 | Concurrency: 1 threads (target='dev')
2022-01-24 10:18:27.244410 (MainThread): 10:18:27 | 
2022-01-24 10:18:27.248472 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-24 10:18:27.248921 (Thread-1): 10:18:27 | 1 of 4 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-24 10:18:27.249435 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-24 10:18:27.249690 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-24 10:18:27.253258 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-24 10:18:27.253739 (Thread-1): finished collecting timing info
2022-01-24 10:18:27.278936 (Thread-1): Opening a new connection, currently in state closed
2022-01-24 10:18:27.284044 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-24 10:18:27.916899 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-24 10:18:27.917482 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         owner_display_name,
         owner_user_id,
         post_type_id,
         creation_date,
         date(creation_date) as tbl_dt,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-24 10:18:31.698253 (Thread-1): finished collecting timing info
2022-01-24 10:18:31.699699 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a6ad588-0caa-4bfa-8b8e-de51c4323cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ae1ff490>]}
2022-01-24 10:18:31.700909 (Thread-1): 10:18:31 | 1 of 4 OK created table model dbt_stackoverflow.TrendingTopics....... [CREATE TABLE (4.3k rows, 2.6 GB processed) in 4.45s]
2022-01-24 10:18:31.701623 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-24 10:18:31.703571 (Thread-1): Began running node model.stackoverflow_post.Post_Owners
2022-01-24 10:18:31.704306 (Thread-1): 10:18:31 | 2 of 4 START table model dbt_stackoverflow.Post_Owners............... [RUN]
2022-01-24 10:18:31.705086 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.Post_Owners".
2022-01-24 10:18:31.705530 (Thread-1): Compiling model.stackoverflow_post.Post_Owners
2022-01-24 10:18:31.710090 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.Post_Owners"
2022-01-24 10:18:31.710913 (Thread-1): finished collecting timing info
2022-01-24 10:18:31.715314 (Thread-1): Opening a new connection, currently in state closed
2022-01-24 10:18:31.726399 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-24 10:18:32.299749 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.Post_Owners"
2022-01-24 10:18:32.301596 (Thread-1): On model.stackoverflow_post.Post_Owners: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Owners"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Owners`
  
  
  OPTIONS()
  as (
    SELECT
     distinct owner_display_name,
     owner_user_id,
     ROW_NUMBER() OVER() AS owner_tbl_key
FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  );
    
2022-01-24 10:18:35.341241 (Thread-1): finished collecting timing info
2022-01-24 10:18:35.343139 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a6ad588-0caa-4bfa-8b8e-de51c4323cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ad88d400>]}
2022-01-24 10:18:35.344822 (Thread-1): 10:18:35 | 2 of 4 OK created table model dbt_stackoverflow.Post_Owners.......... [CREATE TABLE (4.3k rows, 34.1 KB processed) in 3.64s]
2022-01-24 10:18:35.345878 (Thread-1): Finished running node model.stackoverflow_post.Post_Owners
2022-01-24 10:18:35.346926 (Thread-1): Began running node model.stackoverflow_post.Post_Type
2022-01-24 10:18:35.348500 (Thread-1): 10:18:35 | 3 of 4 START table model dbt_stackoverflow.Post_Type................. [RUN]
2022-01-24 10:18:35.350002 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.Post_Type".
2022-01-24 10:18:35.350530 (Thread-1): Compiling model.stackoverflow_post.Post_Type
2022-01-24 10:18:35.356377 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.Post_Type"
2022-01-24 10:18:35.357425 (Thread-1): finished collecting timing info
2022-01-24 10:18:35.361291 (Thread-1): Opening a new connection, currently in state closed
2022-01-24 10:18:35.368321 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-24 10:18:35.986399 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.Post_Type"
2022-01-24 10:18:35.986954 (Thread-1): On model.stackoverflow_post.Post_Type: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Type"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Type`
  
  
  OPTIONS()
  as (
    SELECT 
    ROW_NUMBER() OVER() AS post_tbl_key,
    post_type_id
FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  );
    
2022-01-24 10:18:38.960378 (Thread-1): finished collecting timing info
2022-01-24 10:18:38.961181 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a6ad588-0caa-4bfa-8b8e-de51c4323cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ae185ee0>]}
2022-01-24 10:18:38.961841 (Thread-1): 10:18:38 | 3 of 4 OK created table model dbt_stackoverflow.Post_Type............ [CREATE TABLE (4.3k rows, 33.3 KB processed) in 3.61s]
2022-01-24 10:18:38.962233 (Thread-1): Finished running node model.stackoverflow_post.Post_Type
2022-01-24 10:18:38.962592 (Thread-1): Began running node model.stackoverflow_post.dim_date
2022-01-24 10:18:38.963131 (Thread-1): 10:18:38 | 4 of 4 START table model dbt_stackoverflow.dim_date.................. [RUN]
2022-01-24 10:18:38.963707 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.dim_date".
2022-01-24 10:18:38.964011 (Thread-1): Compiling model.stackoverflow_post.dim_date
2022-01-24 10:18:38.965836 (Thread-1): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 9634, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2022-01-24 10:18:38.966211 (Thread-1): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 28506, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2022-01-24 10:18:38.966519 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 9636, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2022-01-24 10:18:38.966825 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 28508, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2022-01-24 10:18:38.967149 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 9638, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2022-01-24 10:18:38.967438 (Thread-1): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 28510, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2022-01-24 10:18:38.967765 (Thread-1): unclosed <ssl.SSLSocket fd=14, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 9640, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2022-01-24 10:18:38.968063 (Thread-1): unclosed <ssl.SSLSocket fd=15, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 28512, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2022-01-24 10:18:38.968367 (Thread-1): unclosed <ssl.SSLSocket fd=16, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 9642, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2022-01-24 10:18:38.968637 (Thread-1): unclosed <ssl.SSLSocket fd=17, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 28514, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2022-01-24 10:18:38.971307 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.dim_date"
2022-01-24 10:18:38.971808 (Thread-1): finished collecting timing info
2022-01-24 10:18:38.974298 (Thread-1): Opening a new connection, currently in state closed
2022-01-24 10:18:38.982186 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-24 10:18:39.567724 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.dim_date"
2022-01-24 10:18:39.568789 (Thread-1): On model.stackoverflow_post.dim_date: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.dim_date"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`dim_date`
  
  
  OPTIONS()
  as (
    with temp as (SELECT
   tbl_dt,
   EXTRACT(month 
FROM
   tbl_dt) month,
   EXTRACT(quarter 
FROM
   tbl_dt)quarter,
   EXTRACT(year 
FROM
   tbl_dt) year 
FROM
    `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`)

select distinct month,quarter,year from temp
  );
    
2022-01-24 10:18:42.640273 (Thread-1): finished collecting timing info
2022-01-24 10:18:42.642066 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a6ad588-0caa-4bfa-8b8e-de51c4323cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ad8d58b0>]}
2022-01-24 10:18:42.643650 (Thread-1): 10:18:42 | 4 of 4 OK created table model dbt_stackoverflow.dim_date............. [CREATE TABLE (91.0 rows, 33.3 KB processed) in 3.68s]
2022-01-24 10:18:42.644626 (Thread-1): Finished running node model.stackoverflow_post.dim_date
2022-01-24 10:18:42.648255 (MainThread): Acquiring new bigquery connection "master".
2022-01-24 10:18:42.649752 (MainThread): 10:18:42 | 
2022-01-24 10:18:42.650633 (MainThread): 10:18:42 | Finished running 4 table models in 16.69s.
2022-01-24 10:18:42.651473 (MainThread): Connection 'master' was properly closed.
2022-01-24 10:18:42.652111 (MainThread): Connection 'model.stackoverflow_post.dim_date' was properly closed.
2022-01-24 10:18:42.672259 (MainThread): 
2022-01-24 10:18:42.673538 (MainThread): Completed successfully
2022-01-24 10:18:42.674719 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2022-01-24 10:18:42.675737 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ae2a1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ae2b9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ae252670>]}
2022-01-24 10:18:42.676454 (MainThread): Flushing usage events
2022-01-24 10:20:28.829318 (MainThread): Running with dbt=0.21.1
2022-01-24 10:20:29.466035 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-24 10:20:29.467262 (MainThread): Tracking: tracking
2022-01-24 10:20:29.498547 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e17a1eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f5a65d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e17c4040>]}
2022-01-24 10:20:29.512012 (MainThread): Partial parsing not enabled
2022-01-24 10:20:29.521564 (MainThread): Parsing macros/adapters.sql
2022-01-24 10:20:29.549574 (MainThread): Parsing macros/catalog.sql
2022-01-24 10:20:29.556533 (MainThread): Parsing macros/etc.sql
2022-01-24 10:20:29.558653 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-24 10:20:29.560635 (MainThread): Parsing macros/materializations/seed.sql
2022-01-24 10:20:29.563494 (MainThread): Parsing macros/materializations/copy.sql
2022-01-24 10:20:29.566567 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-24 10:20:29.583189 (MainThread): Parsing macros/materializations/view.sql
2022-01-24 10:20:29.586222 (MainThread): Parsing macros/materializations/table.sql
2022-01-24 10:20:29.597894 (MainThread): Parsing macros/core.sql
2022-01-24 10:20:29.602262 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-24 10:20:29.604935 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-24 10:20:29.606853 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-24 10:20:29.608512 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-24 10:20:29.609915 (MainThread): Parsing macros/etc/query.sql
2022-01-24 10:20:29.611057 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-24 10:20:29.612886 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-24 10:20:29.614769 (MainThread): Parsing macros/etc/datetime.sql
2022-01-24 10:20:29.625125 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-24 10:20:29.628017 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-24 10:20:29.630115 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-24 10:20:29.631930 (MainThread): Parsing macros/adapters/common.sql
2022-01-24 10:20:29.745459 (MainThread): Parsing macros/materializations/test.sql
2022-01-24 10:20:29.753415 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-24 10:20:29.764516 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-24 10:20:29.773360 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-24 10:20:29.775477 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-24 10:20:29.811160 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-24 10:20:29.830632 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-24 10:20:29.846256 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-24 10:20:29.848402 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-24 10:20:29.860654 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-24 10:20:29.882359 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-24 10:20:29.886726 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-24 10:20:29.894797 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-24 10:20:30.158965 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.Post_Type".
2022-01-24 10:20:30.173393 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-24 10:20:30.177963 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.dim_date".
2022-01-24 10:20:30.182617 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.Post_Owners".
2022-01-24 10:20:30.212990 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-24 10:20:30.215260 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-24 10:20:30.241236 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1f22559-5456-482c-82b1-68450b73a363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e16538b0>]}
2022-01-24 10:20:30.246755 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-24 10:20:30.247430 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1f22559-5456-482c-82b1-68450b73a363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e1772490>]}
2022-01-24 10:20:30.247923 (MainThread): Found 4 models, 2 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-01-24 10:20:30.249302 (MainThread): 
2022-01-24 10:20:30.249743 (MainThread): Acquiring new bigquery connection "master".
2022-01-24 10:20:30.250808 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-24 10:20:30.251235 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-24 10:20:30.879178 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-24 10:20:30.880215 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-24 10:20:30.888487 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-24 10:20:31.491129 (MainThread): 10:20:31 | Concurrency: 1 threads (target='dev')
2022-01-24 10:20:31.491749 (MainThread): 10:20:31 | 
2022-01-24 10:20:31.495977 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-24 10:20:31.496924 (Thread-1): 10:20:31 | 1 of 4 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-24 10:20:31.498010 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-24 10:20:31.498614 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-24 10:20:31.508634 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-24 10:20:31.509849 (Thread-1): finished collecting timing info
2022-01-24 10:20:31.527840 (Thread-1): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 61880, 0, 0), raddr=('2a00:1450:4009:818::200a', 443, 0, 0)>
2022-01-24 10:20:31.528482 (Thread-1): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 28520, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2022-01-24 10:20:31.529052 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 61882, 0, 0), raddr=('2a00:1450:4009:818::200a', 443, 0, 0)>
2022-01-24 10:20:31.529439 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 28524, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2022-01-24 10:20:31.548326 (Thread-1): Opening a new connection, currently in state closed
2022-01-24 10:20:31.553141 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-24 10:20:32.231534 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-24 10:20:32.239903 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         owner_display_name,
         owner_user_id,
         post_type_id,
         creation_date,
         date(creation_date) as tbl_dt,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-24 10:20:35.568419 (Thread-1): finished collecting timing info
2022-01-24 10:20:35.569817 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1f22559-5456-482c-82b1-68450b73a363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e0cea970>]}
2022-01-24 10:20:35.571051 (Thread-1): 10:20:35 | 1 of 4 OK created table model dbt_stackoverflow.TrendingTopics....... [CREATE TABLE (4.3k rows, 2.6 GB processed) in 4.07s]
2022-01-24 10:20:35.571806 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-24 10:20:35.573826 (Thread-1): Began running node model.stackoverflow_post.Post_Owners
2022-01-24 10:20:35.574765 (Thread-1): 10:20:35 | 2 of 4 START table model dbt_stackoverflow.Post_Owners............... [RUN]
2022-01-24 10:20:35.575886 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.Post_Owners".
2022-01-24 10:20:35.576517 (Thread-1): Compiling model.stackoverflow_post.Post_Owners
2022-01-24 10:20:35.582947 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.Post_Owners"
2022-01-24 10:20:35.583773 (Thread-1): finished collecting timing info
2022-01-24 10:20:35.587588 (Thread-1): Opening a new connection, currently in state closed
2022-01-24 10:20:35.595485 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-24 10:20:36.202424 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.Post_Owners"
2022-01-24 10:20:36.202977 (Thread-1): On model.stackoverflow_post.Post_Owners: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Owners"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Owners`
  
  
  OPTIONS()
  as (
    SELECT
     distinct owner_display_name,
     owner_user_id,
     ROW_NUMBER() OVER() AS owner_tbl_key
FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  );
    
2022-01-24 10:20:39.294885 (Thread-1): finished collecting timing info
2022-01-24 10:20:39.297346 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1f22559-5456-482c-82b1-68450b73a363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e0cb1d30>]}
2022-01-24 10:20:39.298799 (Thread-1): 10:20:39 | 2 of 4 OK created table model dbt_stackoverflow.Post_Owners.......... [CREATE TABLE (4.3k rows, 34.1 KB processed) in 3.72s]
2022-01-24 10:20:39.299896 (Thread-1): Finished running node model.stackoverflow_post.Post_Owners
2022-01-24 10:20:39.300896 (Thread-1): Began running node model.stackoverflow_post.Post_Type
2022-01-24 10:20:39.302347 (Thread-1): 10:20:39 | 3 of 4 START table model dbt_stackoverflow.Post_Type................. [RUN]
2022-01-24 10:20:39.304064 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.Post_Type".
2022-01-24 10:20:39.305108 (Thread-1): Compiling model.stackoverflow_post.Post_Type
2022-01-24 10:20:39.313167 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.Post_Type"
2022-01-24 10:20:39.314335 (Thread-1): finished collecting timing info
2022-01-24 10:20:39.318569 (Thread-1): Opening a new connection, currently in state closed
2022-01-24 10:20:39.326440 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-24 10:20:39.826541 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.Post_Type"
2022-01-24 10:20:39.827938 (Thread-1): On model.stackoverflow_post.Post_Type: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Type"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Type`
  
  
  OPTIONS()
  as (
    SELECT 
    ROW_NUMBER() OVER() AS post_tbl_key,
    post_type_id
FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  );
    
2022-01-24 10:20:42.859194 (Thread-1): finished collecting timing info
2022-01-24 10:20:42.861478 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1f22559-5456-482c-82b1-68450b73a363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e174e9d0>]}
2022-01-24 10:20:42.863234 (Thread-1): 10:20:42 | 3 of 4 OK created table model dbt_stackoverflow.Post_Type............ [CREATE TABLE (4.3k rows, 33.3 KB processed) in 3.56s]
2022-01-24 10:20:42.864350 (Thread-1): Finished running node model.stackoverflow_post.Post_Type
2022-01-24 10:20:42.865409 (Thread-1): Began running node model.stackoverflow_post.dim_date
2022-01-24 10:20:42.866564 (Thread-1): 10:20:42 | 4 of 4 START table model dbt_stackoverflow.dim_date.................. [RUN]
2022-01-24 10:20:42.867960 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.dim_date".
2022-01-24 10:20:42.868747 (Thread-1): Compiling model.stackoverflow_post.dim_date
2022-01-24 10:20:42.877972 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.dim_date"
2022-01-24 10:20:42.879730 (Thread-1): finished collecting timing info
2022-01-24 10:20:42.885849 (Thread-1): Opening a new connection, currently in state closed
2022-01-24 10:20:42.896645 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-24 10:20:43.476170 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.dim_date"
2022-01-24 10:20:43.478164 (Thread-1): On model.stackoverflow_post.dim_date: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.dim_date"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`dim_date`
  
  
  OPTIONS()
  as (
    with temp as (SELECT
   tbl_dt,
   EXTRACT(month 
FROM
   tbl_dt) month,
   EXTRACT(quarter 
FROM
   tbl_dt)quarter,
   EXTRACT(year 
FROM
   tbl_dt) year 
FROM
    `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`)

select distinct tbl_dt,month,quarter,year from temp
  );
    
2022-01-24 10:20:46.338811 (Thread-1): finished collecting timing info
2022-01-24 10:20:46.340123 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1f22559-5456-482c-82b1-68450b73a363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e16b2e50>]}
2022-01-24 10:20:46.341219 (Thread-1): 10:20:46 | 4 of 4 OK created table model dbt_stackoverflow.dim_date............. [CREATE TABLE (1.8k rows, 33.3 KB processed) in 3.47s]
2022-01-24 10:20:46.342151 (Thread-1): Finished running node model.stackoverflow_post.dim_date
2022-01-24 10:20:46.345934 (MainThread): Acquiring new bigquery connection "master".
2022-01-24 10:20:46.347279 (MainThread): 10:20:46 | 
2022-01-24 10:20:46.348147 (MainThread): 10:20:46 | Finished running 4 table models in 16.10s.
2022-01-24 10:20:46.348888 (MainThread): Connection 'master' was properly closed.
2022-01-24 10:20:46.349543 (MainThread): Connection 'model.stackoverflow_post.dim_date' was properly closed.
2022-01-24 10:20:46.367066 (MainThread): 
2022-01-24 10:20:46.367688 (MainThread): Completed successfully
2022-01-24 10:20:46.368275 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2022-01-24 10:20:46.369213 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e17bd3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f5a65d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e176bee0>]}
2022-01-24 10:20:46.370230 (MainThread): Flushing usage events
2022-01-24 10:20:58.679536 (MainThread): Running with dbt=0.21.1
2022-01-24 10:20:59.317271 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=None, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2022-01-24 10:20:59.318443 (MainThread): Tracking: tracking
2022-01-24 10:20:59.350815 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc19fc2ad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc18b8ea880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc18b8ead00>]}
2022-01-24 10:20:59.364489 (MainThread): Partial parsing not enabled
2022-01-24 10:20:59.374745 (MainThread): Parsing macros/adapters.sql
2022-01-24 10:20:59.404778 (MainThread): Parsing macros/catalog.sql
2022-01-24 10:20:59.412203 (MainThread): Parsing macros/etc.sql
2022-01-24 10:20:59.414280 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-24 10:20:59.416186 (MainThread): Parsing macros/materializations/seed.sql
2022-01-24 10:20:59.419083 (MainThread): Parsing macros/materializations/copy.sql
2022-01-24 10:20:59.422158 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-24 10:20:59.438762 (MainThread): Parsing macros/materializations/view.sql
2022-01-24 10:20:59.441996 (MainThread): Parsing macros/materializations/table.sql
2022-01-24 10:20:59.452615 (MainThread): Parsing macros/core.sql
2022-01-24 10:20:59.457386 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-24 10:20:59.460479 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-24 10:20:59.462738 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-24 10:20:59.464573 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-24 10:20:59.465928 (MainThread): Parsing macros/etc/query.sql
2022-01-24 10:20:59.467163 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-24 10:20:59.469148 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-24 10:20:59.471127 (MainThread): Parsing macros/etc/datetime.sql
2022-01-24 10:20:59.481566 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-24 10:20:59.484821 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-24 10:20:59.487296 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-24 10:20:59.489219 (MainThread): Parsing macros/adapters/common.sql
2022-01-24 10:20:59.604125 (MainThread): Parsing macros/materializations/test.sql
2022-01-24 10:20:59.612073 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-24 10:20:59.622870 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-24 10:20:59.631540 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-24 10:20:59.633519 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-24 10:20:59.669151 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-24 10:20:59.689777 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-24 10:20:59.706243 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-24 10:20:59.708727 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-24 10:20:59.720451 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-24 10:20:59.742477 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-24 10:20:59.747198 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-24 10:20:59.754968 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-24 10:21:00.013568 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.Post_Type".
2022-01-24 10:21:00.027843 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-24 10:21:00.032632 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.dim_date".
2022-01-24 10:21:00.037552 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.Post_Owners".
2022-01-24 10:21:00.070172 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-24 10:21:00.072457 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-24 10:21:00.098099 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71e60750-51ec-4734-bc79-1e1591280ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc18b914fd0>]}
2022-01-24 10:21:00.103824 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-24 10:21:00.104412 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71e60750-51ec-4734-bc79-1e1591280ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc18b88cfa0>]}
2022-01-24 10:21:00.104911 (MainThread): Found 4 models, 2 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-01-24 10:21:00.106238 (MainThread): 
2022-01-24 10:21:00.106722 (MainThread): Acquiring new bigquery connection "master".
2022-01-24 10:21:00.107876 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-24 10:21:00.108146 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-01-24 10:21:00.113688 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-24 10:21:00.676995 (MainThread): 10:21:00 | Concurrency: 1 threads (target='dev')
2022-01-24 10:21:00.677891 (MainThread): 10:21:00 | 
2022-01-24 10:21:00.684297 (Thread-1): Began running node test.stackoverflow_post.not_null_dim_date_tbl_dt.c11ec0ac7e
2022-01-24 10:21:00.685220 (Thread-1): 10:21:00 | 1 of 2 START test not_null_dim_date_tbl_dt........................... [RUN]
2022-01-24 10:21:00.686490 (Thread-1): Acquiring new bigquery connection "test.stackoverflow_post.not_null_dim_date_tbl_dt.c11ec0ac7e".
2022-01-24 10:21:00.687221 (Thread-1): Compiling test.stackoverflow_post.not_null_dim_date_tbl_dt.c11ec0ac7e
2022-01-24 10:21:00.718523 (Thread-1): Writing injected SQL for node "test.stackoverflow_post.not_null_dim_date_tbl_dt.c11ec0ac7e"
2022-01-24 10:21:00.719059 (Thread-1): finished collecting timing info
2022-01-24 10:21:00.726359 (Thread-1): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 61892, 0, 0), raddr=('2a00:1450:4009:818::200a', 443, 0, 0)>
2022-01-24 10:21:00.726721 (Thread-1): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 40248, 0, 0), raddr=('2a00:1450:4009:820::200a', 443, 0, 0)>
2022-01-24 10:21:00.744431 (Thread-1): Writing runtime SQL for node "test.stackoverflow_post.not_null_dim_date_tbl_dt.c11ec0ac7e"
2022-01-24 10:21:00.744992 (Thread-1): Opening a new connection, currently in state closed
2022-01-24 10:21:00.749506 (Thread-1): On test.stackoverflow_post.not_null_dim_date_tbl_dt.c11ec0ac7e: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "test.stackoverflow_post.not_null_dim_date_tbl_dt.c11ec0ac7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `future-enigma-338718`.`dbt_stackoverflow`.`dim_date`
where tbl_dt is null



      
    ) dbt_internal_test
2022-01-24 10:21:02.524958 (Thread-1): finished collecting timing info
2022-01-24 10:21:02.526443 (Thread-1): 10:21:02 | 1 of 2 PASS not_null_dim_date_tbl_dt................................. [PASS in 1.84s]
2022-01-24 10:21:02.527286 (Thread-1): Finished running node test.stackoverflow_post.not_null_dim_date_tbl_dt.c11ec0ac7e
2022-01-24 10:21:02.528138 (Thread-1): Began running node test.stackoverflow_post.unique_dim_date_tbl_dt.2f20f2ae06
2022-01-24 10:21:02.528923 (Thread-1): 10:21:02 | 2 of 2 START test unique_dim_date_tbl_dt............................. [RUN]
2022-01-24 10:21:02.530455 (Thread-1): Acquiring new bigquery connection "test.stackoverflow_post.unique_dim_date_tbl_dt.2f20f2ae06".
2022-01-24 10:21:02.531190 (Thread-1): Compiling test.stackoverflow_post.unique_dim_date_tbl_dt.2f20f2ae06
2022-01-24 10:21:02.552763 (Thread-1): Writing injected SQL for node "test.stackoverflow_post.unique_dim_date_tbl_dt.2f20f2ae06"
2022-01-24 10:21:02.553432 (Thread-1): finished collecting timing info
2022-01-24 10:21:02.556718 (Thread-1): Writing runtime SQL for node "test.stackoverflow_post.unique_dim_date_tbl_dt.2f20f2ae06"
2022-01-24 10:21:02.557410 (Thread-1): Opening a new connection, currently in state closed
2022-01-24 10:21:02.564021 (Thread-1): On test.stackoverflow_post.unique_dim_date_tbl_dt.2f20f2ae06: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "test.stackoverflow_post.unique_dim_date_tbl_dt.2f20f2ae06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    tbl_dt as unique_field,
    count(*) as n_records

from `future-enigma-338718`.`dbt_stackoverflow`.`dim_date`
where tbl_dt is not null
group by tbl_dt
having count(*) > 1



      
    ) dbt_internal_test
2022-01-24 10:21:04.671939 (Thread-1): finished collecting timing info
2022-01-24 10:21:04.672511 (Thread-1): 10:21:04 | 2 of 2 PASS unique_dim_date_tbl_dt................................... [PASS in 2.14s]
2022-01-24 10:21:04.672803 (Thread-1): Finished running node test.stackoverflow_post.unique_dim_date_tbl_dt.2f20f2ae06
2022-01-24 10:21:04.674279 (MainThread): Acquiring new bigquery connection "master".
2022-01-24 10:21:04.674735 (MainThread): 10:21:04 | 
2022-01-24 10:21:04.674985 (MainThread): 10:21:04 | Finished running 2 tests in 4.57s.
2022-01-24 10:21:04.675220 (MainThread): Connection 'master' was properly closed.
2022-01-24 10:21:04.675425 (MainThread): Connection 'test.stackoverflow_post.unique_dim_date_tbl_dt.2f20f2ae06' was properly closed.
2022-01-24 10:21:04.676648 (MainThread): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 61896, 0, 0), raddr=('2a00:1450:4009:818::200a', 443, 0, 0)>
2022-01-24 10:21:04.676960 (MainThread): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 40252, 0, 0), raddr=('2a00:1450:4009:820::200a', 443, 0, 0)>
2022-01-24 10:21:04.681905 (MainThread): 
2022-01-24 10:21:04.682262 (MainThread): Completed successfully
2022-01-24 10:21:04.682627 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-01-24 10:21:04.683018 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc18b8171c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc19fc2ad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc18b891f10>]}
2022-01-24 10:21:04.683631 (MainThread): Flushing usage events
2022-01-24 10:49:04.024395 (MainThread): Running with dbt=0.21.1
2022-01-24 10:49:04.655321 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/kp/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-24 10:49:04.656588 (MainThread): Tracking: tracking
2022-01-24 10:49:04.688456 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd10a55dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd24da3940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd10a81070>]}
2022-01-24 10:49:04.702338 (MainThread): Partial parsing not enabled
2022-01-24 10:49:04.711448 (MainThread): Parsing macros/adapters.sql
2022-01-24 10:49:04.740126 (MainThread): Parsing macros/catalog.sql
2022-01-24 10:49:04.746476 (MainThread): Parsing macros/etc.sql
2022-01-24 10:49:04.748705 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-24 10:49:04.750554 (MainThread): Parsing macros/materializations/seed.sql
2022-01-24 10:49:04.753537 (MainThread): Parsing macros/materializations/copy.sql
2022-01-24 10:49:04.756608 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-24 10:49:04.773458 (MainThread): Parsing macros/materializations/view.sql
2022-01-24 10:49:04.776383 (MainThread): Parsing macros/materializations/table.sql
2022-01-24 10:49:04.786851 (MainThread): Parsing macros/core.sql
2022-01-24 10:49:04.791086 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-24 10:49:04.793532 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-24 10:49:04.795347 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-24 10:49:04.796865 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-24 10:49:04.798286 (MainThread): Parsing macros/etc/query.sql
2022-01-24 10:49:04.799349 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-24 10:49:04.801126 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-24 10:49:04.802858 (MainThread): Parsing macros/etc/datetime.sql
2022-01-24 10:49:04.812963 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-24 10:49:04.815852 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-24 10:49:04.817862 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-24 10:49:04.819498 (MainThread): Parsing macros/adapters/common.sql
2022-01-24 10:49:04.929484 (MainThread): Parsing macros/materializations/test.sql
2022-01-24 10:49:04.937133 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-24 10:49:04.947548 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-24 10:49:04.957136 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-24 10:49:04.959216 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-24 10:49:04.995088 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-24 10:49:05.015851 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-24 10:49:05.031056 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-24 10:49:05.033039 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-24 10:49:05.044021 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-24 10:49:05.065066 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-24 10:49:05.069833 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-24 10:49:05.077807 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-24 10:49:05.336484 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.Post_Type".
2022-01-24 10:49:05.352586 (MainThread): 1699: statically parsed stack_models/TrendingTopics.sql
2022-01-24 10:49:05.359554 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-24 10:49:05.363227 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'd633e065-c40a-432b-85e7-b7821d7f126e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd109dbaf0>]}
2022-01-24 10:49:05.364874 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.dim_date".
2022-01-24 10:49:05.369556 (MainThread): Acquiring new bigquery connection "model.stackoverflow_post.Post_Owners".
2022-01-24 10:49:05.402026 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-24 10:49:05.404151 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-24 10:49:05.428052 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd633e065-c40a-432b-85e7-b7821d7f126e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd1090afd0>]}
2022-01-24 10:49:05.433328 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-24 10:49:05.433757 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd633e065-c40a-432b-85e7-b7821d7f126e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd1090af70>]}
2022-01-24 10:49:05.434076 (MainThread): Found 4 models, 2 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-01-24 10:49:05.435443 (MainThread): 
2022-01-24 10:49:05.436025 (MainThread): Acquiring new bigquery connection "master".
2022-01-24 10:49:05.437040 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_future-enigma-338718".
2022-01-24 10:49:05.437458 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-24 10:49:06.079293 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_future-enigma-338718_dbt_stackoverflow".
2022-01-24 10:49:06.080408 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-24 10:49:06.096377 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-24 10:49:06.098760 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 9648, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2022-01-24 10:49:06.099524 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=7, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 23334, 0, 0), raddr=('2a00:1450:4009:817::200a', 443, 0, 0)>
2022-01-24 10:49:06.790719 (MainThread): 10:49:06 | Concurrency: 1 threads (target='dev')
2022-01-24 10:49:06.791598 (MainThread): 10:49:06 | 
2022-01-24 10:49:06.795906 (Thread-1): Began running node model.stackoverflow_post.TrendingTopics
2022-01-24 10:49:06.796602 (Thread-1): 10:49:06 | 1 of 4 START table model dbt_stackoverflow.TrendingTopics............ [RUN]
2022-01-24 10:49:06.797125 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.TrendingTopics".
2022-01-24 10:49:06.797404 (Thread-1): Compiling model.stackoverflow_post.TrendingTopics
2022-01-24 10:49:06.801158 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-24 10:49:06.801651 (Thread-1): finished collecting timing info
2022-01-24 10:49:06.829121 (Thread-1): Opening a new connection, currently in state closed
2022-01-24 10:49:06.834533 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-24 10:49:07.449537 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.TrendingTopics"
2022-01-24 10:49:07.450045 (Thread-1): On model.stackoverflow_post.TrendingTopics: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.TrendingTopics"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  
  
  OPTIONS()
  as (
    With temp as 
(SELECT   ROW_NUMBER() OVER() AS SurrogateKey,
        id,
         title,
         favorite_count,
         accepted_answer_id,
         answer_count,
         owner_display_name,
         owner_user_id,
         post_type_id,
         creation_date,
         date(creation_date) as tbl_dt,
         DATE_DIFF(last_activity_date,creation_date, DAY) AS days_diff,
         view_count,
         tags,
         score
FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`
WHERE    answer_count = 0
AND      accepted_answer_id IS NULL
AND view_count > (select avg(view_count)  FROM     `bigquery-public-data`.`stackoverflow`.`stackoverflow_posts`)
ORDER BY view_count DESC)

SELECT * FROM temp WHERE  days_diff >= 60
  );
    
2022-01-24 10:49:11.159987 (Thread-1): finished collecting timing info
2022-01-24 10:49:11.161605 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd633e065-c40a-432b-85e7-b7821d7f126e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd1006d040>]}
2022-01-24 10:49:11.163079 (Thread-1): 10:49:11 | 1 of 4 OK created table model dbt_stackoverflow.TrendingTopics....... [CREATE TABLE (4.3k rows, 2.6 GB processed) in 4.36s]
2022-01-24 10:49:11.164091 (Thread-1): Finished running node model.stackoverflow_post.TrendingTopics
2022-01-24 10:49:11.166048 (Thread-1): Began running node model.stackoverflow_post.Post_Owners
2022-01-24 10:49:11.166775 (Thread-1): 10:49:11 | 2 of 4 START table model dbt_stackoverflow.Post_Owners............... [RUN]
2022-01-24 10:49:11.167671 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.Post_Owners".
2022-01-24 10:49:11.168153 (Thread-1): Compiling model.stackoverflow_post.Post_Owners
2022-01-24 10:49:11.172671 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.Post_Owners"
2022-01-24 10:49:11.173310 (Thread-1): finished collecting timing info
2022-01-24 10:49:11.176403 (Thread-1): Opening a new connection, currently in state closed
2022-01-24 10:49:11.182895 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-24 10:49:12.015310 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.Post_Owners"
2022-01-24 10:49:12.017503 (Thread-1): On model.stackoverflow_post.Post_Owners: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Owners"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Owners`
  
  
  OPTIONS()
  as (
    SELECT
     distinct owner_display_name,
     owner_user_id,
     ROW_NUMBER() OVER() AS owner_tbl_key
FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  );
    
2022-01-24 10:49:14.948769 (Thread-1): finished collecting timing info
2022-01-24 10:49:14.951225 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd633e065-c40a-432b-85e7-b7821d7f126e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd0a5bda30>]}
2022-01-24 10:49:14.953011 (Thread-1): 10:49:14 | 2 of 4 OK created table model dbt_stackoverflow.Post_Owners.......... [CREATE TABLE (4.3k rows, 34.1 KB processed) in 3.78s]
2022-01-24 10:49:14.954015 (Thread-1): Finished running node model.stackoverflow_post.Post_Owners
2022-01-24 10:49:14.955042 (Thread-1): Began running node model.stackoverflow_post.Post_Type
2022-01-24 10:49:14.957125 (Thread-1): 10:49:14 | 3 of 4 START table model dbt_stackoverflow.Post_Type................. [RUN]
2022-01-24 10:49:14.958865 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.Post_Type".
2022-01-24 10:49:14.959912 (Thread-1): Compiling model.stackoverflow_post.Post_Type
2022-01-24 10:49:14.971567 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.Post_Type"
2022-01-24 10:49:14.973444 (Thread-1): finished collecting timing info
2022-01-24 10:49:14.981711 (Thread-1): Opening a new connection, currently in state closed
2022-01-24 10:49:15.000590 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-24 10:49:15.662430 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.Post_Type"
2022-01-24 10:49:15.663428 (Thread-1): On model.stackoverflow_post.Post_Type: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.Post_Type"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`Post_Type`
  
  
  OPTIONS()
  as (
    SELECT 
    ROW_NUMBER() OVER() AS post_tbl_key,
    post_type_id
FROM `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`
  );
    
2022-01-24 10:49:18.670160 (Thread-1): finished collecting timing info
2022-01-24 10:49:18.670646 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd633e065-c40a-432b-85e7-b7821d7f126e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd0a5bdbe0>]}
2022-01-24 10:49:18.671027 (Thread-1): 10:49:18 | 3 of 4 OK created table model dbt_stackoverflow.Post_Type............ [CREATE TABLE (4.3k rows, 33.3 KB processed) in 3.71s]
2022-01-24 10:49:18.671265 (Thread-1): Finished running node model.stackoverflow_post.Post_Type
2022-01-24 10:49:18.671515 (Thread-1): Began running node model.stackoverflow_post.dim_date
2022-01-24 10:49:18.671961 (Thread-1): 10:49:18 | 4 of 4 START table model dbt_stackoverflow.dim_date.................. [RUN]
2022-01-24 10:49:18.672348 (Thread-1): Acquiring new bigquery connection "model.stackoverflow_post.dim_date".
2022-01-24 10:49:18.672531 (Thread-1): Compiling model.stackoverflow_post.dim_date
2022-01-24 10:49:18.674908 (Thread-1): Writing injected SQL for node "model.stackoverflow_post.dim_date"
2022-01-24 10:49:18.675266 (Thread-1): finished collecting timing info
2022-01-24 10:49:18.676812 (Thread-1): Opening a new connection, currently in state closed
2022-01-24 10:49:18.682134 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-01-24 10:49:19.481868 (Thread-1): Writing runtime SQL for node "model.stackoverflow_post.dim_date"
2022-01-24 10:49:19.484976 (Thread-1): On model.stackoverflow_post.dim_date: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "stackoverflow_post", "target_name": "dev", "node_id": "model.stackoverflow_post.dim_date"} */


  create or replace table `future-enigma-338718`.`dbt_stackoverflow`.`dim_date`
  
  
  OPTIONS()
  as (
    with temp as (SELECT
   tbl_dt,
   EXTRACT(month 
FROM
   tbl_dt) month,
   EXTRACT(quarter 
FROM
   tbl_dt)quarter,
   EXTRACT(year 
FROM
   tbl_dt) year 
FROM
    `future-enigma-338718`.`dbt_stackoverflow`.`TrendingTopics`)

select distinct tbl_dt,month,quarter,year from temp
  );
    
2022-01-24 10:49:22.225363 (Thread-1): finished collecting timing info
2022-01-24 10:49:22.226728 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd633e065-c40a-432b-85e7-b7821d7f126e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd0a5d13d0>]}
2022-01-24 10:49:22.228221 (Thread-1): 10:49:22 | 4 of 4 OK created table model dbt_stackoverflow.dim_date............. [CREATE TABLE (1.8k rows, 33.3 KB processed) in 3.55s]
2022-01-24 10:49:22.229017 (Thread-1): Finished running node model.stackoverflow_post.dim_date
2022-01-24 10:49:22.232280 (MainThread): Acquiring new bigquery connection "master".
2022-01-24 10:49:22.233542 (MainThread): 10:49:22 | 
2022-01-24 10:49:22.234283 (MainThread): 10:49:22 | Finished running 4 table models in 16.80s.
2022-01-24 10:49:22.234936 (MainThread): Connection 'master' was properly closed.
2022-01-24 10:49:22.235464 (MainThread): Connection 'model.stackoverflow_post.dim_date' was properly closed.
2022-01-24 10:49:22.240987 (MainThread): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 9652, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2022-01-24 10:49:22.242241 (MainThread): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 23338, 0, 0), raddr=('2a00:1450:4009:817::200a', 443, 0, 0)>
2022-01-24 10:49:22.243537 (MainThread): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 9654, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2022-01-24 10:49:22.244491 (MainThread): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 23340, 0, 0), raddr=('2a00:1450:4009:817::200a', 443, 0, 0)>
2022-01-24 10:49:22.245699 (MainThread): unclosed <ssl.SSLSocket fd=14, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 9656, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2022-01-24 10:49:22.246870 (MainThread): unclosed <ssl.SSLSocket fd=15, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7d:1a80:2d00:308:ec4e:1980:d0d1', 23342, 0, 0), raddr=('2a00:1450:4009:817::200a', 443, 0, 0)>
2022-01-24 10:49:22.261816 (MainThread): 
2022-01-24 10:49:22.262610 (MainThread): Completed successfully
2022-01-24 10:49:22.263298 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2022-01-24 10:49:22.264125 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd24da3940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd109bd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd0a5bda30>]}
2022-01-24 10:49:22.264972 (MainThread): Flushing usage events
